### **문제 분석 및 모델 설정**

*   **반응 변수 (Y)**: 낙태 합법화 법률에 대한 의견 (1 = 찬성, 0 = 반대)
*   **설명 변수**:
    *   **성별 (h)**: $h=1$ (여성), $h=2$ (남성)
    *   **종교 (i)**: $i=1$ (개신교), $i=2$ (천주교), $i=3$ (유대교)
    *   **정당 (j)**: $j=1$ (민주당), $j=2$ (공화당), $j=3$ (무소속)

이들은 모두 범주형 변수입니다. 모델은 다음과 같이 설정되었습니다.

$$ \text{logit}[P(Y=1)] = \alpha + \beta_h^H + \beta_i^R + \beta_j^P $$

이 모델은 세 예측 변수의 **주효과(main effect)**만 고려하고 **상호작용(interaction)은 없다고** 가정합니다. 즉, 한 변수의 효과는 다른 변수의 수준에 관계없이 일정합니다.

소프트웨어는 각 범주에 대한 효과 추정치를 보고했으며, 이는 특정 **코딩 방식(coding scheme)**을 사용한 결과입니다. 어떤 코딩 방식인지 명시되지 않았지만, 각 질문에 답하는 데는 문제가 없습니다.

**주어진 추정치:**
*   $\hat{\alpha} = 0.62$
*   성별 효과: $\hat{\beta}_1^H=0.08$ (여성), $\hat{\beta}_2^H=-0.08$ (남성)
*   종교 효과: $\hat{\beta}_1^R=-0.16$ (개신교), $\hat{\beta}_2^R=-0.25$ (천주교), $\hat{\beta}_3^R=0.41$ (유대교)
*   정당 효과: $\hat{\beta}_1^P=0.87$ (민주당), $\hat{\beta}_2^P=-1.27$ (공화당), $\hat{\beta}_3^P=0.40$ (무소속)

### **a. 종교에 따라 찬성 오즈(odds)가 어떻게 달라지는지 해석하여라.**

#### **식 (Formulation)**

두 그룹 간의 오즈비(Odds Ratio)는 로짓(logit) 값의 차이에 지수(exp)를 취하여 구합니다. 여기서는 종교의 효과를 비교하는 것이므로, 다른 변수인 성별과 정당은 동일한 수준으로 고정되어 있다고 가정합니다.

예를 들어, 유대교($i=3$)와 개신교($i=1$)의 찬성 오지비를 비교해 봅시다.
*   **유대교의 로그-오즈**: $\text{logit}(\pi_{\text{유대교}}) = \alpha + \beta_h^H + \beta_3^R + \beta_j^P$
*   **개신교의 로그-오즈**: $\text{logit}(\pi_{\text{개신교}}) = \alpha + \beta_h^H + \beta_1^R + \beta_j^P$

두 로짓의 차이는 다음과 같습니다.

$$ \log(\text{OR}) = \text{logit}(\pi_{\text{유대교}}) - \text{logit}(\pi_{\text{개신교}}) = \beta_3^R - \beta_1^R $$

따라서, 오즈비는 다음과 같습니다.

$$ \text{OR}_{\text{유대교 vs. 개신교}} = \exp(\beta_3^R - \beta_1^R) $$

다른 종교 쌍에 대해서도 동일한 방식으로 오즈비를 계산할 수 있습니다.

#### **R 코드 (R Code)**

```R
# 1. 주어진 추정치 입력
beta_R_protestant <- -0.16
beta_R_catholic <- -0.25
beta_R_jewish <- 0.41

# 2. 기준 범주 대비 오즈비 계산 (어떤 종교가 기준인지 알 수 없으므로, 쌍대 비교를 수행)

# 유대교 vs. 개신교
or_jewish_vs_prot <- exp(beta_R_jewish - beta_R_protestant)

# 유대교 vs. 천주교
or_jewish_vs_cath <- exp(beta_R_jewish - beta_R_catholic)

# 개신교 vs. 천주교
or_prot_vs_cath <- exp(beta_R_protestant - beta_R_catholic)

# 3. 결과 출력
results_a <- data.frame(
  Comparison = c("유대교 vs. 개신교", "유대교 vs. 천주교", "개신교 vs. 천주교"),
  Odds_Ratio = c(or_jewish_vs_prot, or_jewish_vs_cath, or_prot_vs_cath)
)

print("a. 종교 간 찬성 오즈비")
print(results_a)
```

### **b. 찬성 확률이 가장 높은 집단과 가장 낮은 집단의 찬성확률을 추정하여라.**

#### **식 (Formulation)**

찬성 확률 $\pi$가 가장 높은/낮은 집단을 찾으려면, 각 변수에서 $\beta$ 계수가 가장 큰/작은 범주를 조합하면 됩니다.

$$ \text{logit}(\pi) = \alpha + \beta_h^H + \beta_i^R + \beta_j^P $$

이 로짓 값을 최대로/최소로 만드는 조합을 찾습니다.

*   **가장 높은 확률(Highest Probability) 집단**:
    *   성별: $\beta _1^H=0.08$ (여성)
    *   종교: $\beta _3^R=0.41$ (유대교)
    *   정당: $\beta _1^P=0.87$ (민주당)
    *   최대 로짓 값: $\text{logit} _{\max} = \hat{\alpha} + \hat{\beta} _1^H + \hat{\beta} _3^R + \hat{\beta} _1^P$
    *   최대 확률: $\pi_{\max} = \frac{\exp(\text{logit} _{\max})}{1 + \exp(\text{logit} _{\max})}$

*   **가장 낮은 확률(Lowest Probability) 집단**:
    *   성별: $\beta_2^H=-0.08$ (남성)
    *   종교: $\beta_2^R=-0.25$ (천주교)
    *   정당: $\beta_2^P=-1.27$ (공화당)
    *   최소 로짓 값: $\text{logit}_{\min} = \hat{\alpha} + \hat{\beta}_2^H + \hat{\beta}_2^R + \hat{\beta}_2^P$
    *   최소 확률: $\pi_{\min} = \frac{\exp(\text{logit}_{\min})}{1 + \exp(\text{logit}_{\min})}$

#### **R 코드 (R Code)**

```R
# 1. 주어진 추정치 입력
alpha_hat <- 0.62

beta_H_female <- 0.08
beta_H_male <- -0.08

beta_R_protestant <- -0.16
beta_R_catholic <- -0.25
beta_R_jewish <- 0.41

beta_P_democrat <- 0.87
beta_P_republican <- -1.27
beta_P_independent <- 0.40

# 2. 가장 높은 확률 집단 계산
logit_max <- alpha_hat + beta_H_female + beta_R_jewish + beta_P_democrat
prob_max <- plogis(logit_max) # plogis(x)는 exp(x)/(1+exp(x))와 같음

# 3. 가장 낮은 확률 집단 계산
logit_min <- alpha_hat + beta_H_male + beta_R_catholic + beta_P_republican
prob_min <- plogis(logit_min)

# 4. 결과 출력
results_b <- data.frame(
  Group = c("가장 높은 집단 (여성, 유대교, 민주당)", "가장 낮은 집단 (남성, 천주교, 공화당)"),
  Logit = c(logit_max, logit_min),
  Probability = c(prob_max, prob_min)
)

print("b. 찬성 확률이 가장 높은/낮은 집단의 확률 추정")
print(results_b)
```

### **c. 만약 제약조건 $\beta_1^G = \beta_1^R = \beta_1^P = 0$을 사용한다면, 새로운 추정치는 어떻게 되는가?**

#### **식 (Formulation)**

제약조건 $\beta_{\text{기준}}=0$을 사용한다는 것은 특정 범주를 **기준 범주(reference category)**로 설정하는 것을 의미합니다. 이 경우, 새로운 추정치($\tilde{\alpha}, \tilde{\beta}$)들은 원래 추정치($\hat{\alpha}, \hat{\beta}$)들과 다음과 같은 관계를 갖습니다.

*   **새로운 절편 ($\tilde{\alpha}$)**: 원래 절편에, 새로운 기준 범주들의 효과를 더한 값입니다.

$$ \tilde{\alpha} = \hat{\alpha} + \hat{\beta}_{\text{기준(성별)}} + \hat{\beta}_{\text{기준(종교)}} + \hat{\beta}_{\text{기준(정당)}} $$

*   **새로운 효과 ($\tilde{\beta}$)**: 각 범주의 원래 효과에서, 해당 변수의 기준 범주의 원래 효과를 뺀 값입니다.

$$ \tilde{\beta}_{\text{범주 } k} = \hat{\beta}_{\text{범주 } k} - \hat{\beta}_{\text{기준 범주}} $$

주어진 문제에서 기준 범주는 여성($h=1$), 개신교($i=1$), 민주당($j=1$)입니다.

#### **R 코드 (R Code)**

```R
# 1. 주어진 추정치들 (b에서 사용한 것과 동일)
# 기준 범주 효과
beta_H_ref <- beta_H_female
beta_R_ref <- beta_R_protestant
beta_P_ref <- beta_P_democrat

# 2. 새로운 절편 계산
alpha_new <- alpha_hat + beta_H_ref + beta_R_ref + beta_P_ref

# 3. 새로운 효과 계수 계산
# 성별
beta_H_female_new <- beta_H_female - beta_H_ref
beta_H_male_new <- beta_H_male - beta_H_ref

# 종교
beta_R_protestant_new <- beta_R_protestant - beta_R_ref
beta_R_catholic_new <- beta_R_catholic - beta_R_ref
beta_R_jewish_new <- beta_R_jewish - beta_R_ref

# 정당
beta_P_democrat_new <- beta_P_democrat - beta_P_ref
beta_P_republican_new <- beta_P_republican - beta_P_ref
beta_P_independent_new <- beta_P_independent - beta_P_ref

# 4. 결과 출력
results_c <- list(
  alpha_new = alpha_new,
  beta_H_new = c(female = beta_H_female_new, male = beta_H_male_new),
  beta_R_new = c(protestant = beta_R_protestant_new, catholic = beta_R_catholic_new, jewish = beta_R_jewish_new),
  beta_P_new = c(democrat = beta_P_democrat_new, republican = beta_P_republican_new, independent = beta_P_independent_new)
)

print("c. 새로운 제약조건 하에서의 추정치")
print(results_c)

# 검증: b에서 계산한 최대/최소 로짓값이 새로운 추정치로도 동일하게 계산되는지 확인
logit_max_check <- alpha_new + beta_H_female_new + beta_R_jewish_new + beta_P_democrat_new
logit_min_check <- alpha_new + beta_H_male_new + beta_R_catholic_new + beta_P_republican_new
print("--- 검증 ---")
print(paste("최대 로짓 값 (원래):", logit_max))
print(paste("최대 로짓 값 (새로운):", logit_max_check))
print(paste("최소 로짓 값 (원래):", logit_min))
print(paste("최소 로짓 값 (새로운):", logit_min_check))
```
