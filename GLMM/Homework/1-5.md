### **문제 분석 및 데이터**

이 문제는 수입(Income)과 행복도(Happiness)라는 두 순서형 변수 간의 관계를 분석하는 것입니다. 표에는 각 셀의 **관측도수(Observed)**, **기대도수(Expected)**, 그리고 **표준화 잔차(Standardized Residual)**가 주어져 있습니다.

**주어진 데이터 (관측도수):**
| 수입(Income) | **불행** | **행복** | **매우 행복** |
| :--- | :--- | :--- | :--- |
| **평균 이상** | 21 | 159 | 110 |
| **평균** | 53 | 372 | 221 |
| **평균 이하** | 94 | 249 | 83 |

### **a. 첫 번째 칸의 기대도수인 35.8을 구하는 방법을 보여라.**

#### **식 (Formulation)**

독립성($H_0$)을 가정할 때, 특정 셀($i$행, $j$열)의 기대도수($\hat{\mu}_{ij}$)는 다음 공식으로 계산됩니다.

$$ \hat{\mu}_{ij} = \frac{(i\text{번째 행의 합계}) \times (j\text{번째 열의 합계})}{\text{전체 합계}} $$

첫 번째 칸은 (수입=평균 이상, 행복도=불행)에 해당합니다.
1.  **해당 행의 합계 계산**: (수입=평균 이상) 행의 합계

$$ n_{1+} = 21 + 159 + 110 $$

2.  **해당 열의 합계 계산**: (행복도=불행) 열의 합계

$$ n_{+1} = 21 + 53 + 94 $$

3.  **전체 합계 계산**: 표의 모든 관측도수를 더합니다.

$$ n = (21+159+110) + (53+372+221) + (94+249+83) $$

4.  **기대도수 계산**:

$$ \hat{\mu}_{11} = \frac{n_{1+} \times n_{+1}}{n} $$

#### **R 코드 (R Code)**

```R
# 1. 관측도수 데이터로 행렬 생성
observed_counts <- matrix(c(21, 53, 94, 159, 372, 249, 110, 221, 83), 
                          nrow = 3, 
                          byrow = FALSE)

# 행과 열 이름 설정
dimnames(observed_counts) <- list(
  Income = c("평균 이상", "평균", "평균 이하"),
  Happiness = c("불행", "행복", "매우 행복")
)

print("--- 관측도수 표 ---")
print(observed_counts)

# 2. 주변 합계 및 전체 합계 계산
row_totals <- rowSums(observed_counts)
col_totals <- colSums(observed_counts)
grand_total <- sum(observed_counts)

# 3. 첫 번째 칸(1,1)의 기대도수 계산
expected_count_11 <- (row_totals[1] * col_totals[1]) / grand_total

# 4. 결과 출력
print("a. 첫 번째 칸의 기대도수 계산")
print(expected_count_11)
```

### **b. 독립성 검정에서 $X^2 = 73.4$이다. 자유도와 P-값을 구하고 결과를 해석하라.**

#### **식 (Formulation)**

1.  **자유도 (Degrees of Freedom, df)**:
    $I \times J$ 분할표에서 독립성 검정의 자유도는 다음과 같이 계산됩니다.

$$ \text{df} = (I-1) \times (J-1) $$

    여기서 $I$는 행의 개수, $J$는 열의 개수입니다.

2.  **P-값 (P-value)**:
    주어진 검정 통계량 $X^2$에 대한 P-값은, 귀무가설(독립성)이 참일 때, 해당 자유도를 갖는 카이제곱($\chi^2$) 분포에서 관측된 $X^2$ 값보다 크거나 같은 값이 나올 확률입니다.

$$ \text{P-값} = P(\chi^2_{\text{df}} \ge X^2_{\text{obs}}) $$

#### **R 코드 (R Code)**

```R
# 1. 행과 열의 개수 확인
I <- nrow(observed_counts)
J <- ncol(observed_counts)

# 2. 자유도 계산
df_b <- (I - 1) * (J - 1)

# 3. 주어진 X^2 값
X_squared <- 73.4

# 4. P-값 계산
p_value_b <- pchisq(X_squared, df = df_b, lower.tail = FALSE)

# 5. 결과 출력
print("b. 독립성 검정 결과")
print(paste("자유도(df):", df_b))
print(paste("P-값:", p_value_b))
```

### **c. 분할표의 관측도수 21과 83에 해당하는 칸의 표준화잔차의 의미를 해석하라.**

### **d. 분할표의 관측도수 110과 94에 해당하는 칸의 표준화잔차의 의미를 해석하라.**

#### **식 (Formulation)**

**표준화 잔차(Standardized Residual)**는 각 셀이 독립성 가정에서 얼마나 벗어났는지를 나타내는 척도입니다.

$$ r_{ij} = \frac{n_{ij} - \hat{\mu}_{ij}}{\text{SE}(n_{ij} - \hat{\mu}_{ij})} = \frac{n_{ij} - \hat{\mu}_{ij}}{\sqrt{\hat{\mu}_{ij}(1 - p_{i+})(1 - p_{+j})}} $$

여기서 $p_{i+}$와 $p_{+j}$는 각각 행과 열의 주변 비율입니다. 이 값들은 근사적으로 표준정규분포 $N(0,1)$을 따릅니다.

문제에서는 이미 표준화 잔차 값이 주어져 있습니다.

*   **c. (관측도수 21)**: 셀(평균 이상, 불행), 표준화 잔차 = -2.973
*   **c. (관측도수 83)**: 셀(평균 이하, 매우 행복), 표준화 잔차 = -5.907
*   **d. (관측도수 110)**: 셀(평균 이상, 매우 행복), 표준화 잔차 = 3.144
*   **d. (관측도수 94)**: 셀(평균 이하, 불행), 표준화 잔차 = 7.368

**해석 원리**:
*   **부호**:
    *   **양수(+)**: 관측도수가 기대도수보다 많다. (예상보다 사람이 더 몰렸다.)
    *   **음수(-)**: 관측도수가 기대도수보다 적다. (예상보다 사람이 더 적었다.)
*   **크기(절댓값)**:
    *   절댓값이 2 또는 3보다 크면, 그 차이는 "우연으로 보기에는 드문" 유의미한 차이로 간주합니다.

#### **R 코드 (R Code)**
이 문제는 주어진 값의 의미를 서술하는 것이므로, 직접적인 계산 코드는 필요하지 않습니다. 다만, 주어진 값들을 확인하기 위해 `chisq.test` 함수의 결과물을 활용할 수 있습니다.

```R
# 카이제곱 검정 수행 (표준화 잔차를 보기 위함)
chi_test_result <- chisq.test(observed_counts)

print("--- chisq.test() 결과 확인용 ---")
print(chi_test_result)
print("관측도수:")
print(chi_test_result$observed)
print("기대도수:")
print(chi_test_result$expected)
print("표준화 잔차:")
print(chi_test_result$stdres)
```
