### **문제 분석 및 모델 설정**

*   **반응 변수**: 올스타 선정 여부 (확률 $\pi$)
*   **설명 변수**: 드래프트 순위 ($d = 1, 2, 3, \dots$)

선수의 드래프트 순위($d$)가 올스타로 선정될 확률($\pi$)에 미치는 영향을 평가하기 위해 다음 모델이 사용되었습니다.

$$ \text{logit}(\pi) = \alpha + \beta \log(d) $$

이 모델은 순위($d$) 자체가 아니라, **순위의 로그값($\log d$)**에 따라 로그 오즈가 선형적으로 변한다고 가정합니다.

### **a. 다음을 보여라.**

$$ \frac{\pi}{1-\pi} = e^\alpha d^\beta $$

#### **식 (Formulation)**

이 식은 로지스틱 회귀 모델의 정의와 로그의 기본 성질을 이용하여 유도할 수 있습니다.

1.  **모델 정의**:

$$ \text{logit}(\pi) = \log\left(\frac{\pi}{1-\pi}\right) = \alpha + \beta \log(d) $$

    여기서 좌변은 '오즈(odds)'의 로그 값입니다.

2.  **지수 변환**: 양변에 지수 함수($e^x$)를 취하여 로그를 제거합니다.

$$ \exp\left[\log\left(\frac{\pi}{1-\pi}\right)\right] = \exp[\alpha + \beta \log(d)] $$

$$ \frac{\pi}{1-\pi} = \exp[\alpha + \beta \log(d)] $$

3.  **지수 법칙 적용**: 지수 법칙 $e^{A+B} = e^A e^B$를 우변에 적용합니다.

$$ \frac{\pi}{1-\pi} = e^\alpha \cdot e^{\beta \log(d)} $$

4.  **로그와 지수 관계 적용**: 로그의 성질 $k \log(x) = \log(x^k)$와 지수-로그의 역함수 관계 $e^{\log(x)} = x$를 이용합니다.

$$ e^{\beta \log(d)} = e^{\log(d^\beta)} = d^\beta $$

5.  **최종 결합**: 3단계와 4단계의 결과를 결합하면 목표로 하는 식이 유도됩니다.

$$ \frac{\pi}{1-\pi} = e^\alpha d^\beta $$

이 식은 올스타가 될 **오즈(odds)**가 드래프트 순위($d$)의 **멱함수(power function)** 형태를 따른다는 것을 보여줍니다.

#### **R 코드 (R Code)**
이 문제는 수학적 증명이므로, 특정 값을 계산하는 R 코드는 필요하지 않습니다. 위 전개 과정이 증명 자체입니다.

### **b. 농구와 야구의 결과를 비교하고 설명하여라.**

#### **식 (Formulation)**

**주어진 추정치**:
*   **농구**: $\hat{\alpha} = 2.3, \hat{\beta} = -1.1$
*   **야구**: $\hat{\alpha} = 0.7, \hat{\beta} = -0.6$

**설명**:
결과가 "농구에서 드래프트 순위가 높을수록(즉, $d$가 커질수록) 올스타가 될 확률이 상대적으로 낮음을 시사한다"는 것을 설명해야 합니다.

1.  **$\beta$의 부호와 의미**:
    *   두 스포츠 모두 $\beta$의 추정치가 **음수**입니다($-1.1, -0.6$).
    *   a에서 유도한 식 $\text{Odds} = e^\alpha d^\beta$ 에서, $\beta$가 음수이면 $d^\beta = 1/d^{|\beta|}$ 가 됩니다.
    *   따라서 $d$가 커질수록(순위가 낮아질수록), $d^{|\beta|}$는 커지고, $1/d^{|\beta|}$는 작아집니다.
    *   결론적으로, 오즈(Odds)는 감소하게 되고, 오즈가 감소하면 확률 $\pi$도 감소합니다. 이는 두 스포츠 모두에서 드래프트 순위가 낮아질수록 올스타가 될 확률이 낮아진다는 것을 의미합니다.

2.  **두 스포츠 간의 $\beta$ 크기 비교**:
    *   농구의 $|\hat{\beta}_{\text{농구}}| = 1.1$
    *   야구의 $|\hat{\beta}_{\text{야구}}| = 0.6$
    *   $|\beta|$는 $d$가 변할 때 오즈가 변하는 "감소율"의 크기를 나타냅니다.
    *   농구의 $|\beta|$가 야구보다 훨씬 큽니다 ($1.1 > 0.6$).
    *   이는 드래프트 순위($d$)가 1 증가할 때, 농구에서의 오즈 감소율이 야구에서보다 더 가파르다는 것을 의미합니다. 즉, 농구에서는 상위 순위(작은 $d$)를 받는 것이 야구에서보다 올스타가 되는 데 훨씬 더 결정적이며, 순위가 조금만 밀려나도 확률이 급격하게 떨어진다는 것을 시사합니다.

#### **R 코드 (R Code)**

이 설명을 시각적으로 뒷받침하기 위해, 두 스포츠에 대한 드래프트 순위별 올스타 선정 확률 곡선을 그려볼 수 있습니다.

```R
# 1. 주어진 추정치 입력
alpha_bask <- 2.3
beta_bask <- -1.1

alpha_base <- 0.7
beta_base <- -0.6

# 2. 확률 계산 함수 정의
calculate_prob <- function(d, alpha, beta) {
  # logit = a + b*log(d)
  # prob = exp(logit) / (1 + exp(logit))
  logit_val <- alpha + beta * log(d)
  prob <- plogis(logit_val)
  return(prob)
}

# 3. 드래프트 순위 범위 설정 (예: 1위부터 100위까지)
d_range <- 1:100

# 4. 각 스포츠에 대한 확률 계산
prob_bask <- calculate_prob(d_range, alpha_bask, beta_bask)
prob_base <- calculate_prob(d_range, alpha_base, beta_base)

# 5. 데이터 프레임 생성
plot_data <- data.frame(
  Draft_Pick = d_range,
  Basketball_Prob = prob_bask,
  Baseball_Prob = prob_base
)

# 6. 시각화 (ggplot2 사용)
# install.packages("ggplot2") # 필요 시 설치
# install.packages("tidyr")   # 필요 시 설치
library(ggplot2)
library(tidyr)

# 데이터를 long format으로 변환
plot_data_long <- pivot_longer(plot_data, 
                               cols = c("Basketball_Prob", "Baseball_Prob"), 
                               names_to = "Sport", 
                               values_to = "Probability")

# 그래프 그리기
p <- ggplot(plot_data_long, aes(x = Draft_Pick, y = Probability, color = Sport)) +
  geom_line(size = 1.2) +
  labs(
    title = "드래프트 순위에 따른 올스타 선정 확률 비교",
    x = "드래프트 순위 (d)",
    y = "올스타 선정 확률 (π)"
  ) +
  scale_color_manual(values = c("Basketball_Prob" = "blue", "Baseball_Prob" = "red"),
                     labels = c("농구 (β=-1.1)", "야구 (β=-0.6)")) +
  theme_minimal() +
  scale_x_continuous(breaks = seq(0, 100, by = 10)) # x축 눈금 조절

print(p)
```
