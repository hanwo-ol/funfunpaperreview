### **문제 분석 및 데이터**

이 문제는 폐암과 흡연의 연관성을 조사한 **환자-대조군 연구(Case-Control Study)** 데이터를 분석하는 것입니다.

*   **환자군 (Cases)**: 폐암 환자 (총 709명)
    *   흡연자: 688명
    *   비흡연자: 21명
*   **대조군 (Controls)**: 폐암이 아닌 환자 (총 709명)
    *   흡연자: 650명
    *   비흡연자: 59명

이를 $2 \times 2$ 분할표로 나타내면 다음과 같습니다.

| 흡연 여부 | **폐암 (환자군)** | **정상 (대조군)** | 합계 |
| :--- | :--- | :--- | :--- |
| **흡연 (Yes)** | 688 | 650 | 1338 |
| **비흡연 (No)** | 21 | 59 | 80 |
| **합계** | 709 | 709 | 1418 |

### **a. 반응변수와 설명변수를 정의하라.**

#### **논리 전개 (Formulation)**

일반적인 연구(전향적 연구) 관점에서, 우리는 '원인'이 '결과'에 미치는 영향을 봅니다.
*   **원인 (설명 변수, Explanatory Variable)**: 흡연 여부 (Smoker: Yes/No)
*   **결과 (반응 변수, Response Variable)**: 폐암 발병 여부 (Lung Cancer: Yes/No)

### **b. 이 연구는 어떤 종류의 연구에 속하는지 밝혀라.**

#### **논리 전개 (Formulation)**

연구 설계 방식을 파악합니다.
1.  연구는 **결과(폐암 발병 여부)**가 이미 알려진 집단, 즉 환자군과 대조군에서 시작했습니다.
2.  그 후, **과거의 원인(흡연 습관)**을 조사했습니다.
3.  이러한 "결과에서 원인으로 거슬러 올라가는" 연구 설계를 **후향적 연구(Retrospective Study)**라고 하며, 의학 연구에서는 특히 **환자-대조군 연구(Case-Control Study)**라고 부릅니다.

### **c. 흡연자와 비흡연자에서 폐암으로 고통 받는 비율을 비교하는데 이 자료를 사용할 수 있는가? 이유를 설명하여라.**

#### **논리 전개 (Formulation)**

"흡연자에서 폐암 발병 비율"은 $P(\text{폐암}|\text{흡연})$ 이고, "비흡연자에서 폐암 발병 비율"은 $P(\text{폐암}|\text{비흡연})$ 입니다.

1.  이 연구는 환자군 709명과 대조군 709명을 **의도적으로** 선정했습니다. 표본 내 폐암 환자의 비율($709/1418 = 50\%$)은 실제 인구 집단의 폐암 유병률(prevalence)을 전혀 반영하지 않습니다. 실제 유병률은 이보다 훨씬 낮습니다.
2.  따라서, 이 데이터로부터 흡연자 전체($1338$명) 중 폐암 환자($688$명)의 비율인 $688/1338$을 계산하더라도, 이 값은 실제 모집단의 $P(\text{폐암}|\text{흡연})$를 대표하지 않습니다.
3.  결론적으로, 환자-대조군 연구 설계의 특성상, **상대위험도(Relative Risk)**나 **비율의 차이(Difference of Proportions)**와 같이 $P(\text{폐암}|\text{흡연})$를 직접 필요로 하는 연관성 측도는 이 자료로 **추정할 수 없습니다.**

### **d. 연관성을 요약하고 결과를 어떻게 해석할 수 있는지 설명하라.**

#### **식 (Formulation)**

환자-대조군 연구에서 추정할 수 있는 유일하고 가장 중요한 연관성 측도는 **오즈비(Odds Ratio, OR)** 입니다. 오즈비는 연구 설계 방향(전향적/후향적)에 관계없이 값이 불변하는 속성이 있기 때문입니다.

1.  **표본 오즈비($\hat{\theta}$) 계산**:
    분할표의 교차곱(cross-product)을 이용하여 계산합니다.

$$ \hat{\theta} = \frac{n_{11} n_{22}}{n_{12} n_{21}} $$

*   $n_{11}$: 흡연 & 폐암 (688)
    *   $n_{22}$: 비흡연 & 정상 (59)
    *   $n_{12}$: 흡연 & 정상 (650)
    *   $n_{21}$: 비흡연 & 폐암 (21)

2.  **해석**:
    비록 데이터가 후향적으로 수집되었지만, 오즈비의 불변성 덕분에 우리는 마치 전향적 연구를 한 것처럼 해석할 수 있습니다.

$$ \theta = \frac{P(\text{폐암}|\text{흡연})/P(\text{정상}|\text{흡연})}{P(\text{폐암}|\text{비흡연})/P(\text{정상}|\text{비흡연})} $$

추정된 오즈비 $\hat{\theta}$는 "비흡연자에 비해 흡연자의 폐암 발병 **오즈(odds)**가 몇 배 더 높은가"를 나타냅니다.

#### **R 코드 (R Code)**

```R
# 1. 분할표 데이터 생성 (행: 흡연여부, 열: 폐암여부)
contingency_table <- matrix(c(688, 21, 650, 59), 
                            nrow = 2, 
                            byrow = FALSE) # 열 기준으로 데이터 입력

# 행과 열 이름 설정
dimnames(contingency_table) <- list(
  Smoker = c("Yes", "No"),
  Lung_Cancer = c("Cases", "Controls")
)

print("--- 2x2 분할표 ---")
print(contingency_table)

# 2. 오즈비 계산 (d)
# 교차곱 공식 사용
n11 <- contingency_table["Yes", "Cases"]
n22 <- contingency_table["No", "Controls"]
n12 <- contingency_table["Yes", "Controls"]
n21 <- contingency_table["No", "Cases"]

odds_ratio_d <- (n11 * n22) / (n12 * n21)

# 또는 fisher.test 함수를 사용하여 오즈비와 신뢰구간을 한 번에 계산할 수 있음
# 이는 연관성을 더 완전하게 요약해 줌
fisher_result <- fisher.test(contingency_table)

# 3. 결과 출력
print("d. 연관성 요약 (오즈비)")
print(paste("계산된 오즈비:", odds_ratio_d))
print("--- fisher.test() 함수 결과 ---")
print(fisher_result)

# c에 대한 답변을 위한 계산 (주의: 이 값은 잘못된 추정치임)
# 흡연자 중 폐암 비율 (표본 내)
prob_cancer_given_smoker_sample <- n11 / (n11 + n12)
# 비흡연자 중 폐암 비율 (표본 내)
prob_cancer_given_nonsmoker_sample <- n21 / (n21 + n22)

print("c. (참고) 표본 내에서의 잘못된 비율 계산")
print(paste("표본 내 흡연자의 폐암 비율:", prob_cancer_given_smoker_sample))
print(paste("표본 내 비흡연자의 폐암 비율:", prob_cancer_given_nonsmoker_sample))
```
