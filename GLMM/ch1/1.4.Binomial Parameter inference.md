### **1.4 이항 모수에 대한 통계적 추론 (STATISTICAL INFERENCE FOR BINOMIAL PARAMETERS)**

이 절에서는 이항 모수(binomial parameter) $\pi$에 대한 검정과 신뢰구간을 제시함으로써 범주형 데이터의 추론 방법을 설명합니다. $n$번의 독립적인 시행에서 $y$번의 성공이 있었을 때, $\pi$의 최대우도(ML) 추정량은 $\hat{\pi} = y/n$이며, 이 추정량의 기댓값은 $E(\hat{\pi}) = \pi$이고 분산은 $\text{var}(\hat{\pi}) = \pi(1-\pi)/n$임을 상기합시다.

#### **1.4.1 이항 모수에 대한 검정 (Tests About a Binomial Parameter)**

$H_0: \pi = \pi_0$를 고려해 봅시다. $H_0$는 단일 모수를 가지므로, 우리는 왈드 및 스코어 검정 통계량으로 카이제곱 형태 대신 정규분포 형태를 사용합니다. 이를 통해 단측 및 양측 대립가설에 대한 검정을 할 수 있습니다.

$H_0: \pi = \pi_0$를 검정하기 위한 **왈드(Wald) 통계량**은 다음과 같습니다.
$$ z_W = \frac{\hat{\pi} - \pi_0}{\text{SE}} = \frac{\hat{\pi} - \pi_0}{\sqrt{\hat{\pi}(1-\hat{\pi})/n}} \quad (1.10) $$
스코어 통계량을 찾기 위해, 이항 스코어(1.8)와 정보량(1.9)을 $\pi_0$에서 계산합니다. 그러면 다음과 같습니다.
$$ u(\pi_0) = \frac{y}{\pi_0} - \frac{n-y}{1-\pi_0}, \quad ι(\pi_0) = \frac{n}{\pi_0(1-\pi_0)} $$
정규분포 형태의 **스코어(score) 통계량**은 다음과 같이 간단해집니다.
$$ z_S = \frac{u(\pi_0)}{[ι(\pi_0)]^{1/2}} = \frac{y - n\pi_0}{\sqrt{n\pi_0(1-\pi_0)}} = \frac{\hat{\pi} - \pi_0}{\sqrt{\pi_0(1-\pi_0)/n}} \quad (1.11) $$
왈드 통계량 $z_W$가 표준오차를 $\hat{\pi}$에서 계산하여 사용하는 반면, 스코어 통계량 $z_S$는 표준오차를 $\pi_0$에서 계산하여 사용합니다. 스코어 통계량은 추정값이 아닌 실제 귀무가설 하의 표준오차(SE)를 사용하므로 더 선호됩니다. 스코어 통계량의 귀무 표집분포는 왈드 통계량의 분포보다 표준정규분포에 더 가깝습니다.

이항 로그우도 함수 (1.7)는 $H_0$ 하에서는 $L_0 = y \log \pi_0 + (n-y)\log(1-\pi_0)$이고, 일반적인 경우에는 $L_1 = y \log \hat{\pi} + (n-y)\log(1-\hat{\pi})$입니다. **우도비(likelihood-ratio) 검정** 통계량은 다음과 같이 간단해집니다.
$$ -2(L_0 - L_1) = 2\left[y \log\frac{\hat{\pi}}{\pi_0} + (n-y)\log\frac{1-\hat{\pi}}{1-\pi_0}\right] $$
다음과 같이 표현하면,
$$ -2(L_0 - L_1) = 2\left[y \log\frac{y}{n\pi_0} + (n-y)\log\frac{n-y}{n(1-\pi_0)}\right] $$
이는 관측된 성공 및 실패 빈도를 $H_0$ 하에서의 적합 빈도와 비교하는 것이며, 다음과 같은 형태로 나타낼 수 있습니다.
$$ 2 \sum \text{관측값} \left[ \log \left( \frac{\text{관측값}}{\text{적합값}} \right) \right] \quad (1.12) $$
우리는 이 공식이 푸아송 및 다항 모수에 대한 검정에서도 성립함을 보게 될 것입니다. $H_0$ 하에서는 미지의 모수가 없고 $H_a$ 하에서는 한 개가 있으므로, (1.12)에 대한 점근적 카이제곱 분포의 자유도는 df = 1 - 0 = 1입니다.

---

#### **1.4.2 이항 모수에 대한 신뢰구간 (Confidence Intervals for a Binomial Parameter)**

왈드 검정 통계량을 역산하면 $|z_W| < z_{\alpha/2}$를 만족하는 $\pi_0$ 값들의 구간을 얻게 됩니다.

$$ \hat{\pi} \pm z_{\alpha/2} \sqrt{\frac{\hat{\pi}(1-\hat{\pi})}{n}} \quad (1.13) $$

역사적으로, 이것은 어떤 모수에 대해서든 사용된 최초의 신뢰구간 중 하나입니다 (Laplace 1812, p. 283). 불행히도, 이 구간은 $n$이 매우 크지 않으면 성능이 좋지 않으며(예: Brown et al. 2001), 실제 포함 확률(coverage probability)이 명목 신뢰수준보다 보통 낮고, $\pi$가 0 또는 1에 가까울 때는 훨씬 더 낮아지는 경향이 있습니다.

우도비에 기반한 신뢰구간은 계산적으로 더 복잡하지만 원리는 간단합니다. 이 구간은 우도비 검정의 P-값이 $\alpha$를 초과하는 $\pi_0$ 값들의 집합입니다. 
이와 동등하게, 이는 ML 추정값 $\hat{\pi}=y/n$에서의 값보다 로그우도가 $\chi^2_1(\alpha)$의 절반 미만으로 떨어지는 $\pi_0$ 값들의 집합입니다. 
예를 들어, 95% 신뢰구간의 양 끝점은 다음을 만족하는 $\pi_0$ 값을 수치적인 방법을 통해 반복적으로 풀어 찾을 수 있습니다.

$$ 2\left[y \log\frac{\hat{\pi}}{\pi_0} + (n-y)\log\frac{1-\hat{\pi}}{1-\pi_0}\right] = \chi^2_1(0.05) = 3.84 $$

스코어 신뢰구간은 $|z_S| < z_{\alpha/2}$를 만족하는 $\pi_0$ 값들을 포함합니다. 그 양 끝점은 다음 방정식의 해입니다.

$$ (\hat{\pi} - \pi_0) / \sqrt{\pi_0(1-\pi_0)/n} = \pm z_{\alpha/2} $$

이 방정식은 $\pi_0$에 대한 이차방정식입니다. Wilson (1927)에 의해 처음 논의된 이 구간은 다음과 같습니다.

$$ \left(\hat{\pi}\frac{n}{n+z^2_{\alpha/2}} + \frac{1}{2}\frac{z^2_{\alpha/2}}{n+z^2_{\alpha/2}}\right) \pm \frac{z_{\alpha/2}}{n+z^2_{\alpha/2}}\sqrt{\hat{\pi}(1-\hat{\pi})n + \frac{z^2_{\alpha/2}}{4}} 
\quad (1.14) $$

이 구간의 중간점은 $\hat{\pi}$와 1/2의 가중평균이며, $\hat{\pi}$에 주어진 가중치 $n/(n+z^2_{\alpha/2})$는 $n$이 증가함에 따라 커집니다. 항들을 결합하면, 이 중간점은 $\tilde{\pi} = (y+z^2_{\alpha/2}/2)/(n+z^2_{\alpha/2})$와 같습니다. 이는 각 유형별로 $z^2_{\alpha/2}/2$개의 관측값을 추가한 조정된 표본에 대한 표본 비율입니다. 예를 들어, 95% 신뢰구간의 경우 각 유형별로 $z^2_{0.025}/2 = 1.96^2/2 \approx 2$개의 관측값을 추가합니다.

95% 신뢰구간에 대해, 스코어 구간은 왈드 구간의 간단한 조정으로 근사할 수 있습니다(연습문제 1.25 참조). 이 방법은 왈드 공식(1.13)을 사용하기 전에 표본에 각 유형별로 2개의 관측값을 추가합니다. 이 구간과 일반적인 스코어 구간은 실제 포함 확률이 왈드 구간보다 명목 수준에 훨씬 더 가까운 경향이 있습니다 (Agresti and Coull 1998, Agresti and Caffo 2000).

---

#### **1.4.3 예제: 채식주의자 비율 추정 (Example: Estimating the Proportion of Vegetarians)**

입문 통계학 강좌에서 개념을 설명하기 위한 데이터를 수집하기 위해, 종종 학생들에게 설문지를 나눠주곤 합니다. 어느 해에 플로리다 대학교의 우등반 학생 각자에게 채식주의자인지를 물었습니다. $n=25$명의 학생 중 $y=0$명이 "예"라고 답했습니다. 이들은 특정 모집단의 무작위 표본은 아니었지만, 이 데이터를 이항 모수 $\pi$에 대한 95% 신뢰구간을 설명하는 데 사용하겠습니다.

$y=0$이므로, ML 추정값은 $\hat{\pi} = 0/25 = 0$입니다. 왈드 방법을 사용하면 95% 신뢰구간은 다음과 같습니다.

$$ \hat{\pi} \pm 1.96 \sqrt{\hat{\pi}(1-\hat{\pi})/n}, \quad \text{즉 } \quad 0 \pm 1.96 \sqrt{(0.0 \times 1.0)/25}, \quad \text{또는 } (0, 0) $$

모수가 표본 공간의 경계 근처에 있을 때, 종종 표준오차의 표본 추정치는 성능이 좋지 않으며 왈드 방법은 합리적인 답을 제공하지 못합니다.

반면에, 95% 스코어 구간은 (0.0, 0.133)입니다. 즉, $\hat{\pi}=0.0$이고 $n=25$일 때, $|\hat{\pi} - \pi_0| = 1.96 \sqrt{\pi_0(1-\pi_0)/n}$ 방정식을 만족하는 두 개의 근 $\pi_0$는 0.0과 0.133입니다. 이 구간은 더 믿을 만한 추론을 제공합니다. 이 구간은 유의수준(제1종 오류 확률) 0.05의 해당 스코어 검정에서 기각되지 않는 값들을 포함합니다. 예를 들어, $H_0: \pi=0.20$에 대해 스코어 검정 통계량은 $z_S = (0-0.20)/\sqrt{(0.20 \times 0.80)/25} = -2.50$이며, 양측 P-값은 0.012 < 0.05이므로 0.20은 구간에 속하지 않습니다. 반면, $H_0: \pi=0.10$에 대해서는 $z_S = (0-0.10)/\sqrt{(0.10 \times 0.90)/25} = -1.67$이며, P-값은 0.096 > 0.05이므로 0.10은 구간에 속합니다.

$y=0$이고 $n=25$일 때, 우도 함수의 커널은 $l(\pi) = \pi^0(1-\pi)^{25} = (1-\pi)^{25}$입니다. 로그우도 함수 (1.7)는 $L(\pi) = 25 \log(1-\pi)$입니다. $L(\hat{\pi}) = L(0) = 0$임을 주목하십시오. 95% 우도비 신뢰구간은 다음을 만족하는 $\pi_0$의 집합입니다.

$$ -2(L_0 - L_1) = -2[L(\pi_0) - L(\hat{\pi})] = -50 \log(1-\pi_0) < \chi^2_1(0.05) = 3.84 $$

상한은 $1 - \exp(-3.84/50) = 0.074$이며, 신뢰구간은 (0.0, 0.074)입니다. 그림 1.2는 우도 및 로그우도 함수와 그에 해당하는 $\pi$에 대한 신뢰 영역을 보여줍니다.

세 가지 대푯본 방법은 상당히 다른 결과를 내놓습니다. $\pi$가 0에 가까울 때, 작은 $n$에 대해 $\hat{\pi}$의 표집분포는 오른쪽으로 매우 치우쳐 있습니다. 수치적 평가에 따르면, 우리는 스코어 검정을 역산하여 얻은 구간을 선호합니다.

---

### **핵심 개념 해설**

이 섹션은 이항 비율($\pi$)이라는 가장 기본적인 범주형 데이터 모수에 대해 앞서 배운 세 가지 추론 방법(왈드, 우도비, 스코어)을 구체적으로 적용하는 방법을 보여줍니다.

#### **1.4.1: 세 가지 검정 방법의 비교**
*   **왈드 검정 ($z_W$)**: 표준오차(분모)를 계산할 때 **데이터로부터 얻은 추정치 $\hat{\pi}$**를 사용합니다. 계산은 가장 간단하지만, $\hat{\pi}$가 0 또는 1에 가까울 때 분모가 0이 되어 통계량이 무한대가 되는 등 불안정한 모습을 보입니다.
*   **스코어 검정 ($z_S$)**: 표준오차(분모)를 계산할 때 **귀무가설 값인 $\pi_0$**를 사용합니다. 이는 귀무가설이 참이라는 가정 하에 가장 정확한 표준오차이므로, 통계적으로 더 안정적이고 우수한 성능을 보입니다.
*   **우도비 검정 (LR Test)**: 관측 빈도와 귀무가설 하에서의 기대 빈도 사이의 정보량 차이를 측정합니다. 직관적으로는 가장 복잡해 보이지만, 이론적으로 매우 강력합니다.

#### **1.4.2: 신뢰구간의 성능 문제**
*   **왈드 신뢰구간 (공식 1.13)**: **절대 사용하지 말아야 할 방법**으로 널리 알려져 있습니다. 계산은 간단하지만, 특히 표본이 작거나 비율이 0 또는 1에 가까울 때 명목 신뢰수준(예: 95%)을 전혀 만족시키지 못하는 심각한 문제가 있습니다. (예제 1.4.3에서 보듯이, 성공이 0번이면 구간의 폭이 0이 되는 비상식적인 결과를 낳습니다.)
*   **스코어 신뢰구간 (윌슨 구간, Wilson Interval)**: 왈드 구간의 문제를 해결하는 훌륭한 대안입니다. 계산은 복잡하지만, 실제 포함 확률이 명목 신뢰수준에 매우 가깝습니다. 특히 $y=0$이나 $y=n$인 경우에도 합리적인 구간을 제공합니다.
*   **아그레스티-쿨 구간 (Agresti-Coull Interval)**: 스코어 구간의 간단한 근사법으로, **성공 횟수에 2, 실패 횟수에 2를 더한 뒤 (총 4개 추가)** 간단한 왈드 공식을 적용하는 방법입니다. 성능이 스코어 구간과 거의 동일하면서 계산이 매우 쉬워 교육 및 실제 분석에서 널리 추천됩니다.
*   **우도비 신뢰구간**: 성능은 우수하지만, 방정식을 풀어야 하므로 계산이 가장 복잡합니다.

#### **1.4.3: $y=0$인 극단적 사례**
이 예제는 각 신뢰구간 방법의 장단점을 극명하게 보여줍니다.
*   **왈드**: (0, 0)이라는 비상식적인 구간을 제공합니다. 표본에서 채식주의자가 없었다고 해서 모집단 비율이 정확히 0이라고 100% 확신할 수는 없습니다.
*   **스코어**: (0.0, 0.133)이라는 합리적인 구간을 제공합니다. "모집단 비율이 0일 수도 있지만, 13.3%까지 높을 수도 있다"고 해석할 수 있습니다.
*   **우도비**: (0.0, 0.074)라는, 스코어 구간과 유사하지만 약간 더 좁은 구간을 제공합니다.

**결론**: 이항 비율을 다룰 때, 특히 표본 크기가 작거나 비율이 극단적인 경우, **왈드 방법은 피하고 스코어 방법(또는 아그레스티-쿨 근사법)이나 우도비 방법을 사용해야 합니다.** 이는 범주형 데이터 분석에서 매우 중요한 실용적인 지침입니다.
