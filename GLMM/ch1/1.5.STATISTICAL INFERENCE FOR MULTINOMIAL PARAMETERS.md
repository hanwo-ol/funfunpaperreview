1.5절 '다항 모수에 대한 통계적 추론' 

---

### **1.5 다항 모수에 대한 통계적 추론 (STATISTICAL INFERENCE FOR MULTINOMIAL PARAMETERS)**

다음으로 다항 모수 $\{\pi_j\}$에 대한 추론을 살펴보겠습니다. $c$개의 범주에 대한 $n$개의 관측치에서, 범주 $j$에는 $n_j$개의 관측치가 발생한다고 합시다 ($j=1, \dots, c$).

#### **1.5.1 다항 모수의 추정 (Estimation of Multinomial Parameters)**

먼저 $\{\pi_j\}$의 최대우도(ML) 추정치를 구합니다. $\{\pi_j\}$의 함수로서, 다항 확률 질량 함수 (1.2)는 다음과 같은 커널에 비례합니다.

$$ \prod_j \pi_j^{n_j}, \quad \text{여기서 모든 } \pi_j \ge 0 \text{ 이고 } \sum_j \pi_j = 1 \quad (1.15) $$

ML 추정치는 (1.15)를 최대로 만드는 $\{\pi_j\}$입니다. 다항 로그우도 함수는 다음과 같습니다.

$$ L(\boldsymbol{\pi}) = \sum_j n_j \log \pi_j $$

중복성을 제거하기 위해, $L$을 $(\pi_1, \dots, \pi_{c-1})$의 함수로 다룹니다 ($\pi_c = 1 - (\pi_1 + \dots + \pi_{c-1})$ 이므로). 미분을 통해 ML 추정치는 $\hat{\pi}_j = n_j/n$ 임을 보일 수 있습니다. (자세한 과정은 18페이지에 제시됨) 따라서, $\{\pi_j\}$에 대한 ML 추정치는 **표본 비율(sample proportions)**입니다.


#### **1.5.2 특정 다항 분포에 대한 피어슨 카이제곱 검정 (Pearson Chi-Squared Test of a Specified Multinomial)**

1900년에 저명한 영국 통계학자 칼 피어슨(Karl Pearson)은 최초의 추론 방법 중 하나인 가설 검정을 도입했습니다. 이는 범주형 데이터 분석에 혁명적인 영향을 미쳤습니다. 피어슨의 검정은 다항 모수가 특정 값과 같은지를 평가합니다.

$H_0: \pi_j = \pi_{j0}, j=1, \dots, c$를 고려합시다 (단, $\sum_j \pi_{j0} = 1$). $H_0$가 참일 때, $\{n_j\}$의 기댓값, 즉 **기대 빈도(expected frequencies)**는 $\mu_j = n\pi_{j0}$입니다. 피어슨은 다음의 검정 통계량을 제안했습니다.

$$ X^2 = \sum_j \frac{(n_j - \mu_j)^2}{\mu_j} \quad (1.16) $$

$|n_j - \mu_j|$의 차이가 클수록 $X^2$ 값은 커집니다. 관측된 $X^2$ 값을 $X^2_{obs}$라고 합시다. P-값은 귀무가설 하에서 $P(X^2 \ge X^2_{obs})$ 입니다.

표본이 클 때, $X^2$은 근사적으로 자유도(df)가 $c-1$인 카이제곱 분포를 따릅니다. P-값은 $P(\chi^2_{c-1} \ge X^2_{obs})$로 근사됩니다. 통계량 (1.16)은 **피어슨 카이제곱 통계량(Pearson chi-squared statistic)**이라고 불립니다.

#### **1.5.3 특정 다항 분포에 대한 우도비 카이제곱 검정 (Likelihood-Ratio Chi-Squared Test of a Specified Multinomial)**

다항 모수에 대한 대안적인 검정은 우도비 검정을 사용합니다. 다항 우도의 커널은 (1.15)입니다. $H_0$ 하에서 우도는 $\hat{\pi}_j = \pi_{j0}$일 때 최대화됩니다. 일반적인 경우, 우도는 $\hat{\pi}_j = n_j/n$일 때 최대화됩니다. 우도들의 비율은 다음과 같습니다.

$$ \Lambda = \frac{\prod_j (\pi_{j0})^{n_j}}{\prod_j (n_j/n)^{n_j}} $$

따라서, $G^2$으로 표기되는 우도비 통계량은 다음과 같습니다.

$$ G^2 = -2 \log \Lambda = 2 \sum_j n_j \log\left(\frac{n_j}{n\pi_{j0}}\right) \quad (1.17) $$

형태 (1.12)를 가지는 이 통계량은 **우도비 카이제곱 통계량(likelihood-ratio chi-squared statistic)**이라고 불립니다. $G^2$의 값이 클수록 $H_0$에 대한 반대 증거가 커집니다.

일반적인 경우, 모수 공간은 $\sum_j \pi_j=1$을 만족하는 $\{\pi_j\}$로 구성되므로, 차원은 $c-1$입니다. $H_0$ 하에서는 $\{\pi_j\}$가 완전히 명시되므로 차원은 0입니다. 이 차원들의 차이는 $c-1$입니다. 표본 크기 $n$이 클 때, $G^2$은 자유도 df = $c-1$인 카이제곱 귀무분포를 가집니다.

$H_0$가 성립할 때, 피어슨 $X^2$과 우도비 $G^2$은 모두 대푯본에서 df = $c-1$인 카이제곱 분포를 따릅니다. 사실, 그 경우 둘은 점근적으로 동등합니다. $H_0$가 거짓일 때는 둘 다 $n$에 비례하여 기댓값이 증가하지만, 매우 큰 $n$에서도 비슷한 값을 가질 필요는 없습니다.

고정된 $c$에 대해 $n$이 증가할 때, $X^2$의 분포가 $G^2$의 분포보다 보통 더 빨리 카이제곱 분포로 수렴합니다. 카이제곱 근사는 $n/c < 5$일 때 $G^2$에 대해 종종 좋지 않습니다.

#### **1.5.4 예제: 멘델의 이론 검정 (Example: Testing Mendel’s Theories)**

피어슨의 검정은 유전학에서 멘델의 유전 이론을 검정하는 데 사용되었습니다. 멘델은 순종의 노란색 완두콩과 순종의 녹색 완두콩을 교배했습니다. 그는 2세대 잡종 씨앗이 75%는 노란색, 25%는 녹색일 것이라고 예측했습니다(노란색이 우성). 한 실험에서 $n=8023$개의 씨앗이 생산되었고, 그 중 $n_1 = 6022$개는 노란색, $n_2=2001$개는 녹색이었습니다. $H_0: \pi_{10}=0.75, \pi_{20}=0.25$에 대한 기대 빈도는 $\mu_1 = 8023(0.75)=6017.25$ 이고 $\mu_2=2005.75$입니다.

피어슨 통계량 $X^2=0.015$이고 우도비 통계량 $G^2=0.015$ (df=1)이며, P-값은 0.90입니다. 이 결과들은 멘델의 가설과 모순되지 않습니다.

#### **1.5.5 추정된 기대 빈도를 이용한 검정 (Testing with Estimated Expected Frequencies)**

카이제곱 통계량 (1.16)과 (1.17)은 표본 분포를 가상의 분포 $\{\pi_{j0}\}$와 비교합니다. 일부 적용 사례에서는, $\{\pi_{j0} = \pi_{j0}(\boldsymbol{\theta})\}$가 더 작은 미지의 모수 집합 $\boldsymbol{\theta}$의 함수입니다. $\boldsymbol{\theta}$의 ML 추정치 $\hat{\boldsymbol{\theta}}$는 $\{\pi_{j0}(\hat{\boldsymbol{\theta}})\}$의 ML 추정치를 결정하고, 결과적으로 기대 빈도의 ML 추정치 $\{\hat{\mu}_j = n\pi_{j0}(\hat{\boldsymbol{\theta}})\}$를 결정합니다.

$\{\mu_j\}$를 추정치 $\{\hat{\mu}_j\}$로 대체하는 것은 $X^2$과 $G^2$의 분포에 영향을 줍니다. 만약 $\dim(\boldsymbol{\theta})=p$ 라면, 실제 자유도는 df = $(c-1)-p$가 됩니다.

#### **1.5.6 예제: 송아지의 폐렴 감염 (Example: Pneumonia Infections in Calves)**

추정된 기대 빈도를 사용한 적합도 검정을 보여드리겠습니다. 플로리다 오키초비 카운티에서 태어난 156마리의 젖소 송아지 표본을 생후 60일 이내에 폐렴에 걸렸는지 여부로 분류했습니다. 폐렴에 걸린 송아지는 1차 감염이 사라진 후 2주 이내에 2차 감염이 발생했는지에 따라서도 분류되었습니다. [표 1.1]은 데이터를 보여줍니다. 1차 감염에 걸리지 않은 송아지는 2차 감염에 걸릴 수 없으므로, 관측치는 해당 범주에 속할 수 없습니다. 이 조합을 **구조적 영점(structural zero)**이라고 합니다.

이 연구의 목표 중 하나는 1차 감염 확률이, 송아지가 1차 감염에 걸렸다는 조건 하에서의 2차 감염 조건부 확률과 동일한지 검정하는 것이었습니다. 수식으로 표현하면, 귀무가설은 $H_0: \pi_{11}+\pi_{12} = \pi_{11}/(\pi_{11}+\pi_{12})$ 입니다.

$\pi = \pi_{11}+\pi_{12}$를 1차 감염 확률이라고 합시다. 귀무가설은 확률들이 [표 1.2]의 구조를 만족함을 의미합니다. 즉, 세 범주(yes-yes, yes-no, no-no)에 대한 삼항 확률이 각각 $[\pi^2, \pi(1-\pi), 1-\pi]$가 됩니다.

ML 추정치 $\hat{\pi}$는 0.494입니다. $n=156$이므로, 추정된 기대 빈도는 $\hat{\mu}_{11}=n\hat{\pi}^2=38.1$, $\hat{\mu}_{12}=n\hat{\pi}(1-\hat{\pi})=39.0$, $\hat{\mu}_{22}=n(1-\hat{\pi})=78.9$ 입니다. 피어슨 통계량은 $X^2=19.7$입니다. 가능한 반응은 $c=3$개이고 기대 빈도를 결정하는 모수($\pi$)는 $p=1$개이므로, 자유도는 df = $(3-1)-1=1$입니다. $H_0$에 대한 강력한 반대 증거가 있습니다 ($P=0.00001$). [표 1.1]을 살펴보면, 1차 감염에 걸렸지만 2차 감염은 겪지 않은 송아지가 $H_0$가 예측하는 것보다 훨씬 많음을 알 수 있습니다. 연구자들은 1차 감염이 2차 감염의 가능성을 줄이는 면역 효과를 가졌다고 결론 내렸습니다.

#### **1.5.7 카이제곱의 이론적 정당화 (Chi-Squared Theoretical Justification)**

이제 왜 피어슨 통계량이 극한에서 카이제곱 분포를 따르는지 간략히 설명하겠습니다. 다항 표본 $(n_1, \dots, n_c)$에서, 각 $n_j$의 주변 분포는 이항 분포 $\text{bin}(n, \pi_j)$입니다. $n$이 크면, 중심극한정리에 의해 표본 비율 벡터 $\hat{\boldsymbol{\pi}} = (n_1/n, \dots, n_{c-1}/n)^T$는 근사적으로 다변량 정규분포를 따릅니다. $H_0$ 하에서, $\sqrt{n}(\hat{\boldsymbol{\pi}} - \boldsymbol{\pi_0})$는 평균이 $\mathbf{0}$이고 공분산 행렬이 $\mathbf{\Sigma_0}$인 정규분포로 수렴합니다. 따라서 이차 형식 $n(\hat{\boldsymbol{\pi}}-\boldsymbol{\pi_0})^T \mathbf{\Sigma_0}^{-1} (\hat{\boldsymbol{\pi}}-\boldsymbol{\pi_0})$는 자유도가 $c-1$인 카이제곱 분포로 수렴합니다. 이 식이 $X^2$으로 단순화됨을 보일 수 있습니다.

---

### **핵심 개념 해설**

이 섹션은 이항 분포(범주 2개)의 추론을 다항 분포(범주 3개 이상)로 확장합니다.

*   **1.5.1**: 이항 비율의 ML 추정치가 표본 비율이듯이, 다항 확률의 ML 추정치도 각 범주의 **표본 비율**($\hat{\pi}_j = n_j/n$)입니다. 매우 직관적인 결과입니다.
*   **1.5.2 (피어슨 $X^2$ 검정)**: "좋은 가설이라면, 그 가설로부터 계산된 **기대 빈도($\mu_j$)**와 실제 데이터의 **관측 빈도($n_j$)**는 비슷해야 한다"는 아이디어에 기반합니다.
    *   통계량 $X^2 = \sum \frac{(\text{관측} - \text{기대})^2}{\text{기대}}$ 는 이 차이를 종합적으로 측정합니다.
    *   이는 범주형 데이터 분석에서 가장 기본적이고 널리 알려진 **적합도 검정(goodness-of-fit test)**입니다.
*   **1.5.3 ($G^2$ 검정)**: 우도비 원리를 다항 분포에 적용한 것입니다. $G^2 = 2 \sum \text{관측} \log(\frac{\text{관측}}{\text{기대}})$ 형태로, $X^2$과 점근적으로 동일한 결과를 주지만 계산 방식이 다릅니다.
*   **1.5.5 & 1.5.6 (추정된 기대 빈도)**: 이 부분이 매우 중요합니다. 많은 실제 문제에서는 귀무가설이 확률을 완전히 지정하지 않고, "확률들이 어떤 **수학적 패턴(모델)**을 따른다"고만 가정합니다.
    *   송아지 예제에서 $H_0$는 $\pi_1, \pi_2, \pi_3$가 특정 숫자라고 말하지 않고, 미지의 모수 $\pi$를 이용해 $[\pi^2, \pi(1-\pi), 1-\pi]$라는 패턴을 따른다고 주장합니다.
    *   이 경우, 우리는 먼저 데이터로부터 모델의 모수($\pi$)를 **추정($\hat{\pi}=0.494$)**하고, 그 추정치를 이용해 기대 빈도를 **계산($\hat{\mu}_j$)**합니다.
    *   이렇게 데이터를 사용하여 모델의 모수를 추정하는 과정은 자유도를 소모합니다. 따라서 자유도는 **(범주 개수 - 1)에서 추가로 (추정한 모수의 개수, $p$)만큼 빼주어야** 합니다. 이것이 `df = (c-1)-p` 공식의 의미입니다.
