
### **1.5.7 카이제곱의 이론적 정당화 (Chi-Squared Theoretical Justification)**

**[원문 번역]**

이제 우리는 왜 특정 다항 분포에 대한 피어슨의 통계량이 극한에서 카이제곱 분포를 갖는지 그 개요를 설명하겠습니다. 우도비 통계량과 추정된 기대 빈도가 있는 경우에 대한 유도는 16.3절에서 제공됩니다.

크기 $n$인 다항 표본 $(n_1, \dots, n_c)$에서, $n_j$의 주변 분포는 이항 분포 $\text{bin}(n, \pi_j)$입니다. $n$이 클 때, 이항 분포의 정규 근사에 의해, $n_j$ (그리고 $\hat{\pi}_j = n_j/n$)는 근사적으로 정규분포를 갖습니다. 더 일반적으로, 중심극한정리에 의해, 표본 비율 벡터 $\hat{\boldsymbol{\pi}} = (n_1/n, \dots, n_{c-1}/n)^T$는 근사적으로 다변량 정규분포를 갖습니다 (16.1.4절). $\mathbf{\Sigma_0}$를 $\sqrt{n}\hat{\boldsymbol{\pi}}$의 귀무 공분산 행렬이라고 하고, $\boldsymbol{\pi_0} = (\pi_{10}, \dots, \pi_{c-1,0})^T$라고 합시다. 귀무가설($H_0$) 하에서, $\sqrt{n}(\hat{\boldsymbol{\pi}} - \boldsymbol{\pi_0})$는 평균이 $\mathbf{0}$이고 공분산 행렬이 $\mathbf{\Sigma_0}$인 다변량 정규분포로 수렴하므로, 이차 형식(quadratic form)

$$ n(\hat{\boldsymbol{\pi}}-\boldsymbol{\pi_0})^T \mathbf{\Sigma_0}^{-1} (\hat{\boldsymbol{\pi}}-\boldsymbol{\pi_0}) \quad (1.18) $$

은 자유도가 $c-1$인 카이제곱 분포로 수렴하는 분포를 가집니다.

16.1.4절에서 우리는 $\sqrt{n}\hat{\boldsymbol{\pi}}$의 공분산 행렬의 원소가 $\sigma_{jk} = -\pi_j\pi_k$ ($j \neq k$일 때) 와 $\sigma_{jj} = \pi_j(1-\pi_j)$ 임을 보입니다. 행렬 $\mathbf{\Sigma_0}^{-1}$은 $(j,k)$번째 원소가 $1/\pi_{c0}$ ($j \neq k$일 때) 이고 $1/\pi_{j0} + 1/\pi_{c0}$ ($j=k$일 때) 입니다. 이 대입을 통해 적절한 항들을 결합하여 직접 계산하면 (1.18)이 $X^2$으로 단순화됨을 보일 수 있습니다. 16.3절에서는 더 일반적인 환경에서 형식적인 증명을 제공합니다.

이 논증은 1900년 피어슨의 논증과 유사합니다. R. A. Fisher(1922)는 더 간단한 정당화를 제시했는데, 그 요지는 다음과 같습니다: $(n_1, \dots, n_c)$가 평균이 $(\mu_1, \dots, \mu_c)$인 서로 독립인 푸아송(Poisson) 확률변수라고 가정합시다. $\{\mu_j\}$가 클 때, 표준화된 값 $\{z_j = (n_j - \mu_j)/\sqrt{\mu_j}\}$는 근사적으로 표준정규분포를 갖습니다. 따라서, $\sum_j z_j^2 = X^2$은 근사적으로 자유도 $c$인 카이제곱 분포를 갖습니다. 여기에 $\sum_j(n_j - \mu_j) = 0$이라는 단일 선형 제약을 추가하여 (이로써 푸아송 분포가 다항 분포로 전환됨), 우리는 자유도 하나를 잃게 됩니다.

---

### **핵심 논리 해설**

이 섹션은 약간의 선형대수와 확률 이론 지식이 필요하지만, 그 근본 아이디어는 두 가지 접근법으로 요약될 수 있습니다.

#### **접근법 1: 다변량 중심극한정리 (피어슨의 원래 접근법과 유사)**

이것이 본문의 주된 설명 방식입니다. 논리의 흐름은 다음과 같습니다.

1.  **시작점: 표본 비율은 정규분포를 따른다.**
    *   표본 크기 $n$이 충분히 크면, **중심극한정리(Central Limit Theorem)**에 의해 표본 비율 벡터 $\hat{\boldsymbol{\pi}} = (\hat{\pi}_1, \dots, \hat{\pi}_{c-1})$는 **다변량 정규분포(Multivariate Normal Distribution)**를 근사적으로 따릅니다.
    *   이 정규분포의 평균은 실제 확률 벡터 $\boldsymbol{\pi_0}$이고, 어떤 공분산 행렬 $\mathbf{\Sigma}$를 가집니다.

2.  **표준화된 정규분포 변수 만들기.**
    *   단일 변수 $X$가 정규분포 $N(\mu, \sigma^2)$를 따를 때, $Z = (X-\mu)/\sigma$는 표준정규분포 $N(0,1)$을 따릅니다.
    *   다변량에서도 유사한 작업을 할 수 있습니다. 벡터 $(\hat{\boldsymbol{\pi}} - \boldsymbol{\pi_0})$를 그것의 공분산 행렬을 이용하여 "표준화"하면, 평균이 $\mathbf{0}$이고 공분산 행렬이 **단위행렬(Identity Matrix)**인 다변량 정규분포를 따르는 벡터를 만들 수 있습니다.

3.  **카이제곱 분포의 정의 활용.**
    *   통계학의 기본 정의 중 하나는 **"서로 독립인 표준정규분포 확률변수 $k$개를 각각 제곱하여 더하면, 그 합은 자유도 $k$인 카이제곱 분포를 따른다"**는 것입니다.
        *   $Z_1, \dots, Z_k \sim_{\text{i.i.d.}} N(0,1) \implies \sum_{i=1}^k Z_i^2 \sim \chi^2_k$
    *   2단계에서 만든 "표준화된" 정규분포 벡터의 각 원소를 제곱하여 더한 것과 동등한 행렬 연산이 바로 본문의 **이차 형식(quadratic form) (1.18)**입니다.

$$ n(\hat{\boldsymbol{\pi}}-\boldsymbol{\pi_0})^T \mathbf{\Sigma_0}^{-1} (\hat{\boldsymbol{\pi}}-\boldsymbol{\pi_0}) $$

이 복잡해 보이는 식이 바로 "표준화된 벡터의 제곱합"에 해당합니다.

4.  **수학적 정리.**
    *   놀랍게도, 이 이차 형식 (1.18)을 실제 다항 분포의 공분산 행렬을 대입하여 전개하고 정리하면, 그 결과는 정확히 피어슨의 카이제곱 통계량 공식과 일치하게 됩니다.

$$ n(\hat{\boldsymbol{\pi}}-\boldsymbol{\pi_0})^T \mathbf{\Sigma_0}^{-1} (\hat{\boldsymbol{\pi}}-\boldsymbol{\pi_0}) = \sum_{j=1}^{c} \frac{(n_j - \mu_j)^2}{\mu_j} = X^2 $$

**요약**: 표본 비율은 (다변량) 정규분포를 따르고, 정규분포 변수를 제곱해서 더하면 카이제곱 분포가 됩니다. 피어슨의 $X^2$ 통계량은 이 과정을 수학적으로 표현한 것과 정확히 일치합니다.

#### **접근법 2: 푸아송 분포로부터의 유도 (피셔의 더 간단한 접근법)**

이것은 더 직관적이고 우아한 설명입니다.

1.  **가정**: 각 범주의 관측 빈도 $n_j$가 서로 독립이고, 평균이 $\mu_j$인 **푸아송(Poisson) 분포**를 따른다고 상상해 봅시다. (실제로는 다항 분포에서 $n_j$들은 총합이 $n$으로 고정되어 있어 독립이 아닙니다.)
2.  **푸아송 분포의 정규 근사**: 푸아송 분포는 평균 $\mu_j$가 충분히 크면 (보통 5 이상), 평균이 $\mu_j$이고 분산도 $\mu_j$인 정규분포로 근사할 수 있습니다.
3.  **표준화**: 따라서, 각 범주에 대해 $z_j = \frac{n_j - \mu_j}{\sqrt{\mu_j}}$ 는 근사적으로 표준정규분포 $N(0,1)$을 따릅니다.
4.  **카이제곱 합산**: 이 $z_j$들은 서로 독립이라고 가정했으므로, 이들을 제곱해서 모두 더하면,

$$ \sum_{j=1}^{c} z_j^2 = \sum_{j=1}^{c} \frac{(n_j - \mu_j)^2}{\mu_j} = X^2 $$

는 **자유도 $c$인 카이제곱 분포**를 따르게 됩니다.
5.  **제약 조건 추가 (자유도 감소)**: 이제 현실로 돌아옵니다. 다항 분포에서는 사실 총합이 $n$으로 고정되어 있다는 제약($\sum n_j = n$)이 있습니다. 이는 곧 $\sum (n_j - \mu_j) = \sum n_j - \sum \mu_j = n - n = 0$ 이라는 **선형 제약(linear constraint)**이 하나 존재함을 의미합니다.
    *   통계 이론에서, 카이제곱 변수에 선형 제약이 하나 추가될 때마다 **자유도가 1씩 감소**합니다.
    *   따라서, 푸아송 분포에서 유도된 자유도 $c$에서 제약 조건으로 인해 1을 빼주면, 최종 자유도는 **$c-1$**이 됩니다.

**요약**: 독립적인 푸아송 변수들의 합으로 생각하면 $X^2$이 자유도 $c$인 카이제곱 분포를 따르는 것은 쉽게 이해할 수 있습니다. 여기에 다항 분포의 "총합이 일정하다"는 제약 조건이 자유도를 하나 감소시켜 최종적으로 $c-1$이 됩니다. 이 피셔의 설명은 더 직관적이고 기억하기 쉽습니다.
