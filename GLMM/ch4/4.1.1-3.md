### **4.1.1 일반화 선형 모델의 구성 요소 (Components of Generalized Linear Models)**

**[원문 번역]**

GLM의 **확률 성분(random component)**은 자연 지수족(natural exponential family)에 속하는 분포로부터 나온 독립적인 관측치 $(y_1, \dots, y_N)$을 갖는 반응 변수 Y로 구성된다. 이 족은 다음과 같은 형태의 확률밀도함수 또는 확률질량함수를 갖는다.

$$ f(y_i; \theta_i) = a(\theta_i)b(y_i)\exp[y_i Q(\theta_i)]. \quad (4.1) $$

푸아송 분포와 이항 분포를 포함한 몇몇 중요한 분포들이 특별한 경우에 해당한다. 모수 $\theta_i$의 값은 설명 변수들의 값의 함수로서 $i=1, \dots, N$에 대해 변한다. 모수 $Q(\theta)$는 **자연 모수(natural parameter)**라고 불린다. 4.4절에서 우리는 분산 모수(dispersion parameter)도 허용하는 $f$에 대한 더 일반적인 공식 (4.17)을 제시하지만, 이 책의 주된 초점인 이산 데이터 모델에 대해서는 (4.1)로 충분하다.

GLM의 **시스템 성분(systematic component)**은 벡터 $(\eta_1, \dots, \eta_N)$을 선형 모델을 통해 설명 변수들과 관련시킨다. 대상 $i$에 대한 설명 변수 $j$ ($j=0, 1, 2, \dots$)의 값을 $x_{ij}$라고 하자. 그러면,

$$ \eta_i = \sum_j \beta_j x_{ij}, \quad i=1, \dots, N. $$

이 설명 변수들의 선형 결합은 **선형 예측자(linear predictor)**라고 불린다. 보통, 모든 $i$에 대해 $x_{i0}=1$이며, 이는 모델에서 절편항 $\beta_0$ (종종 $\alpha$로 표기됨)의 계수를 나타낸다.

GLM의 세 번째 구성 요소는 확률 성분과 시스템 성분을 연결하는 **연결 함수(link function)**이다. $\mu_i = E(Y_i)$, $i=1, \dots, N$이라고 하자. 모델은 $\eta_i = g(\mu_i)$에 의해 $\mu_i$를 $\eta_i$에 연결하며, 여기서 연결 함수 $g$는 단조적이고 미분 가능한 함수이다. 따라서, $g$는 다음 공식을 통해 $\mu_i$를 설명 변수들과 연결한다.

$$ g(\mu_i) = \sum_j \beta_j x_{ij}, \quad i=1, \dots, N. \quad (4.2) $$

**항등 연결(identity link)**이라고 불리는 연결 함수 $g(\mu)=\mu$는 $\eta_i=\mu_i$를 갖는다. 이는 평균 그 자체에 대한 선형 모델을 지정한다. 이것은 정규분포를 따르는 Y를 갖는 일반적인 회귀분석의 연결 함수이다. 평균을 자연 모수로 변환하는 연결 함수는 **정준 연결(canonical link)**이라고 불린다. 그 경우, $g(\mu_i)=Q(\theta_i)$이고, $Q(\theta_i) = \sum_j \beta_j x_{ij}$가 된다. 4.1.2절과 4.1.3절에서 예시를 보여준다.

요약하면, GLM은 자연 지수족에 속하는 분포를 갖는 반응 변수의 변환된 평균에 대한 선형 모델이다. 이제 우리는 이산형 반응 변수에 대한 핵심 GLM들을 소개함으로써 세 가지 구성 요소를 설명한다.

### **4.1.2 이항 데이터를 위한 이항 로짓 모델 (Binomial Logit Models for Binary Data)**

**[원문 번역]**

많은 반응 변수들은 이항(binary)이다. 우리는 "성공"과 "실패" 결과를 1과 0으로 나타낸다. 베르누이 시행은 $P(Y=1)=\pi$와 $P(Y=0)=1-\pi$라는 확률을 갖는데, 여기서 $E(Y)=\pi$이다. 이것은 $n=1$인 이항 분포 (1.1)의 특별한 경우이다. 우리는 확률 질량 함수를 다음과 같이 표현할 수 있다.

$$ f(y; \pi) = \pi^y (1-\pi)^{1-y} = (1-\pi)[\pi/(1-\pi)]^y $$

$$ = (1-\pi)\exp\left[y \left(\log\frac{\pi}{1-\pi}\right)\right] \quad (4.3) $$

$y=0, 1$에 대해. 이것은 $\theta$를 $\pi$로, $a(\pi)=1-\pi$, $b(y)=1$, 그리고 $Q(\pi)=\log[\pi/(1-\pi)]$로 식별하면 자연 지수족 (4.1)에 속한다. 자연 모수 $\log[\pi/(1-\pi)]$는 반응 결과 1의 로그 오즈, 즉 $\pi$의 **로짓(logit)**이다. 이것이 정준 연결 함수이다. 로짓 연결을 사용하는 GLM들은 4.2.3절에서 더 소개된다. 그들은 **로지스틱 회귀 모델(logistic regression models)** 또는 때때로 간단히 **로짓 모델(logit models)**이라고 불린다.

### **4.1.3 카운트 데이터를 위한 푸아송 로그선형 모델 (Poisson Loglinear Models for Count Data)**

**[원문 번역]**

일부 반응 변수들은 가능한 결과로서 카운트(counts)를 갖는다. 건강 조사에서, 각 관측치는 대상이 의사를 방문했던 지난 해의 질병 횟수일 수 있다. 카운트는 또한 분할표의 항목으로서 발생한다.

카운트 데이터에 대한 가장 간단한 분포는 푸아송 분포이다. 카운트 Y에 대한 푸아송 확률 질량 함수 (1.4)는 다음과 같다.

$$ f(y; \mu) = \frac{e^{-\mu}\mu^y}{y!} = \exp(-\mu)\left(\frac{1}{y!}\right)\exp[y(\log\mu)], \quad y=0, 1, 2, \dots $$

이것은 $\theta=\mu$, $a(\mu)=\exp(-\mu)$, $b(y)=1/y!$, 그리고 $Q(\mu)=\log\mu$를 갖는 자연 지수족 형태 (4.1)를 갖는다. 자연 모수는 $\log\mu$이므로, 정준 연결 함수는 **로그 연결(log link)**, $\eta=\log\mu$이다. 이 연결 함수를 사용하는 모델은

$$ \log \mu_i = \sum_j \beta_j x_{ij}, \quad i=1, \dots, N. \quad (4.4) $$

이다. 4.3.1절에서 더 소개될 이 모델은 **푸아송 로그선형 모델(Poisson loglinear model)**이라고 불린다.

---

### **핵심 내용 해설: 회귀분석의 위대한 확장**

일반화 선형 모델(GLM)은 전통적인 선형 회귀분석(Ordinary Least Squares, OLS)을 엄청나게 확장시킨 강력한 통합 프레임워크입니다. OLS가 "반응 변수는 정규분포를 따르고, 평균은 설명 변수의 선형 결합이다"라는 엄격한 가정에 묶여있었다면, GLM은 이를 세 가지 유연한 구성 요소로 분리하여 다양한 데이터에 적용할 수 있게 만들었습니다.

#### **GLM의 3대 구성 요소**

1.  **확률 성분 (Random Component)**: **데이터(Y)가 어떤 확률 분포를 따르는가?**
    *   OLS: 오직 **정규분포**만 허용.
    *   GLM: **지수족(Exponential Family)**에 속하는 다양한 분포를 허용.
        *   **이항 분포**: 성공/실패, 찬성/반대와 같은 이항 데이터.
        *   **푸아송 분포**: 사건 발생 횟수와 같은 카운트 데이터.
        *   정규분포, 감마분포 등도 포함.
    *   이 성분은 데이터의 내재적 변동성을 정의합니다.

2.  **시스템 성분 (Systematic Component)**: **설명 변수(X)를 어떻게 결합할 것인가?**
    *   OLS와 GLM 모두 동일: 설명 변수들을 **선형 결합(linear combination)**하여 **선형 예측자($\eta$)**를 만듭니다.

$$ \eta = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \dots $$

*   이는 모델의 예측 부분을 구성하며, 각 설명 변수의 효과($\beta$)를 나타냅니다.

3.  **연결 함수 (Link Function, $g(\cdot)$)**: **확률 성분과 시스템 성분을 어떻게 연결할 것인가?**
    *   이것이 GLM의 가장 혁신적인 부분입니다.
    *   OLS: **평균 그 자체($\mu$)**가 선형 예측자와 같다고 가정. $\mu = \eta$. 이를 **항등 연결(identity link)**이라고 합니다.
    *   GLM: **평균의 변환값($g(\mu)$)**이 선형 예측자와 같다고 가정.

$$ g(\mu) = \eta = \beta_0 + \beta_1 x_1 + \dots $$

*   **역할**: 연결 함수는 확률 성분의 평균($\mu$)이 가질 수 있는 값의 범위와 시스템 성분($\eta$)이 가질 수 있는 값의 범위를 맞춰주는 "다리" 역할을 합니다.
*   예: 확률($\mu$)은 [0, 1] 사이의 값을 갖지만, 선형 예측자($\eta$)는 $(-\infty, \infty)$의 값을 가질 수 있습니다. 이 둘을 직접 연결하면($\mu=\eta$), 예측된 확률이 0보다 작거나 1보다 커지는 문제가 발생합니다. 연결 함수는 이를 방지합니다.

#### **대표적인 GLM 예시**

**1. 이항 로짓 모델 (로지스틱 회귀)**
*   **확률 성분**: **이항 분포** (성공 확률 $\pi$, 즉 평균 $\mu=\pi$)
*   **시스템 성분**: $\eta = \beta_0 + \beta_1 x_1 + \dots$
*   **연결 함수**: **로짓(Logit) 연결**
    *   $g(\mu) = g(\pi) = \log\left(\frac{\pi}{1-\pi}\right)$
    *   **모델**: $\log\left(\frac{\pi}{1-\pi}\right) = \beta_0 + \beta_1 x_1 + \dots$
    *   **의미**: "성공의 **로그 오즈**가 설명 변수들의 선형 함수이다."
    *   **정준 연결**: 로짓 함수는 이항 분포의 **자연 모수**이므로, 정준 연결(canonical link)입니다. 정준 연결을 사용하면 모델이 좋은 통계적, 수학적 속성을 가집니다.

**2. 푸아송 로그선형 모델**
*   **확률 성분**: **푸아송 분포** (평균 발생 횟수 $\mu$)
*   **시스템 성분**: $\eta = \beta_0 + \beta_1 x_1 + \dots$
*   **연결 함수**: **로그(Log) 연결**
    *   $g(\mu) = \log(\mu)$
    *   **모델**: $\log(\mu) = \beta_0 + \beta_1 x_1 + \dots$
    *   **의미**: "**평균 발생 횟수의 로그값**이 설명 변수들의 선형 함수이다."
    *   **정준 연결**: 로그 함수는 푸아송 분포의 **자연 모수**이므로, 정준 연결입니다.

**요약**: GLM은 **(1) 데이터의 분포(확률 성분)를 유연하게 선택**하고, **(2) 그 분포의 평균을 적절히 변환하는 연결 함수를 선택**하여, **(3) 설명 변수들의 선형 결합(시스템 성분)으로 모델링**하는 매우 강력하고 통일된 프레임워크입니다. 로지스틱 회귀와 푸아송 회귀는 GLM 프레임워크 안에 완벽하게 들어맞는 가장 대표적인 모델들입니다.
