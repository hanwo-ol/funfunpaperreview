### **4.3.4 음이항 GLM (Negative Binomial GLMs)**

**[원문 번역]**

**음이항 분포(negative binomial distribution)**는 다음과 같은 확률 질량 함수를 갖는다.

$$ f(y; k, \mu) = \frac{\Gamma(y+k)}{\Gamma(k)\Gamma(y+1)} \left(\frac{k}{\mu+k}\right)^k \left(1-\frac{k}{\mu+k}\right)^y, \quad y=0,1,2,\dots \quad (4.13) $$

여기서 $k>0$과 $\mu>0$는 모수이다. 이 분포는, 평균이 주어졌을 때 Y가 푸아송 분포를 따르지만, 그 평균 자체가 형태 모수 $k$를 갖는 감마 분포에 따라 변할 때 발생한다 (14.4절).

표기상, 우리는 음이항 분포를 $\mu$와 $\gamma=1/k$의 항으로 모수화하는 것이 더 간단함을 알게 될 것이다. 그러면, Y는 다음을 갖는다.

$$ E(Y) = \mu, \quad \text{var}(Y) = \mu + \gamma\mu^2 $$

지수 $\gamma > 0$는 분산 모수의 한 종류이다. $\gamma \to 0$이 되면, $\text{var}(Y) \to \mu$가 되고 음이항 분포는 푸아송 분포로 수렴한다. 보통 $\gamma$는 알려져 있지 않다. 그것을 추정하는 것은 과대산포의 정도를 요약하는 데 도움이 된다. $k=1/\gamma$가 고정되었을 때, 우리는 (4.13)을 자연 지수족 형태 (4.1)로 표현할 수 있다. 그러면, 음이항 확률 성분을 갖는 모델은 GLM이다. 단순화를 위해, 그러한 모델들은 $\gamma$가 모든 관측치에 대해 동일한 상수라고 두지만, 미지의 값으로 취급한다.

14.4절에서 우리는 음이항 GLM에 대해 더 자세히 제시한다. 우리는 여기서 푸아송 GLM으로 위에서 분석된 투구게 데이터에 대한 모델을 설명한다. 항등 연결과 너비를 예측 변수로 사용할 때, 푸아송 GLM은 $\hat{\mu} = -11.53 + 0.55x$ ( $\hat{\beta}$에 대한 SE=0.06)를 갖는다. 음이항 GLM에 대해서는, 가장 낮은 관측 너비 값인 21cm에서 반복적인 적합 과정 동안 약간 음수인 예측 반응이 발생하여 수렴 문제가 야기된다. 그 관측치를 제외하면, ML 적합 결과는 $\hat{\mu}=-11.47+0.55x$ (SE=0.12)이다. 더구나, $\hat{\gamma}=1.07$이므로, 예측된 $\hat{\mu}$에서, 추정된 $\text{var}(Y)$는 푸아송 GLM의 $\hat{\mu}$와 비교하여 대략 $\hat{\mu}+\hat{\mu}^2$이다. (이 적합은 $\gamma=1.0$인 음이항 분포의 특별한 경우인 기하 분포의 그것과 유사하다.) 비록 적합치는 푸아송 GLM과 유사하지만, 음이항 모델에서의 더 큰 $\hat{\beta}$에 대한 SE와 더 큰 추정된 $\text{var}(Y)$는 푸아송 GLM으로 포착되지 않은 과대산포를 반영한다.

### **4.3.5 오프셋을 이용한 비율에 대한 푸아송 회귀 (Poisson Regression for Rates Using Offsets)**

**[원문 번역]**

종종 반응 카운트 $Y_i$는 그 기댓값이 $t_i$에 비례하는 지수(index) $t_i$를 갖는다. 예를 들어, 이 지수는 카운트가 측정된 시간의 양이나 공간적 영역일 수 있다. 그러면, 표본 비율은 $y_i/t_i$이고, 기대 비율은 $\mu_i/t_i$이다. 설명 변수 $\mathbf{x}$가 있을 때, 기대 비율에 대한 로그선형 모델은 다음과 같은 형태를 갖는다.

$$ \log(\mu_i/t_i) = \alpha + \beta_1 x_{i1} + \dots + \beta_p x_{ip}. \quad (4.14) $$

이 모델은 다음과 같은 동등한 표현을 갖는다.

$$ \log\mu_i - \log t_i = \alpha + \beta_1 x_{i1} + \dots + \beta_p x_{ip}. $$

평균의 로그 연결에 대한 조정 항, $-\log t_i$는 **오프셋(offset)**이라고 불린다. 이 적합은 $\log t_i$를 우변의 예측 변수로 사용하고 그 계수를 1.0과 같도록 강제하는 것과 일치한다. 모델 (4.14)에 대해, 기대 반응 카운트는 다음을 만족한다.

$$ \mu_i = t_i \exp(\alpha + \beta_1 x_{i1} + \dots + \beta_p x_{ip}). $$

평균은 $\mathbf{x}_i$의 값에 따라 비례 상수를 갖는다. 항등 연결 또한 때때로 유용하다. 그러면 모델은

$$ \mu_i/t_i = \alpha + \beta_1 x_{i1} + \dots + \beta_p x_{ip}, \quad \text{또는} \quad \mu_i = \alpha t_i + \beta_1 x_{i1}t_i + \dots + \beta_p x_{ip}t_i. $$

이다. 이것은 오프셋을 요구하지 않는다. 그것은 절편 없이, 그리고 설명 변수 $t_i, x_{i1}t_i, \dots, x_{ip}t_i$를 사용하여 항등 연결을 갖는 일반적인 푸아송 GLM에 해당한다. 그것은 곱셈적이 아닌 덧셈적인 예측 변수 효과를 제공한다. 여러 예측 변수와 함께 사용될 때 덜 유용한데, 반복 과정의 어떤 단계에서 $x_i$에 대해 음수인 적합 카운트 때문에 적합 과정이 실패할 수 있기 때문이다.

---

### **핵심 내용 해설**

#### **4.3.4: 과대산포에 대한 최고의 처방, 음이항 모델**

*   **문제**: 푸아송 모델은 **평균=분산**을 가정하지만, 실제 카운트 데이터는 종종 **분산 > 평균**인 과대산포를 보인다.
*   **음이항 모델의 철학**: 과대산포가 발생하는 이유 중 하나는 "관찰되지 않은 이질성" 때문이다. 음이항 분포는 이를 수학적으로 모델링한다.
    *   **가정**: 각 개체는 푸아송 분포를 따르지만, 모든 개체가 동일한 평균($\mu$)을 갖는 것이 아니라, 각자의 평균이 모집단 내에서 **감마 분포(Gamma distribution)**를 따라 무작위로 변한다.
    *   **결과**: 이렇게 두 확률분포(푸아송, 감마)를 섞으면, 그 결과로 나오는 분포가 바로 **음이항 분포**이다.
*   **새로운 분산 형태**:

$$ \text{Var}(Y) = \mu + \gamma \mu^2 $$

*   식 설명
    *   **$\mu$**: 푸아송 분포 자체에서 오는 변동성 ("무작위성")
    *   **$\gamma \mu^2$**: 개체들 간의 평균($\mu$)이 달라서 생기는 추가적인 변동성 ("과대산포")
    *   **분산 모수 $\gamma$**: 이 값이 바로 **과대산포의 정도**를 나타낸다. $\gamma=0$이면 음이항 모델은 푸아송 모델과 같아진다. $\gamma>0$이면 과대산포가 존재한다.
*   **GLM으로서의 음이항 모델**: $\gamma$ 값을 안다고 가정하면(또는 추정하여 고정하면), 음이항 모델도 GLM 프레임워크에 포함시킬 수 있다.
*   **투구게 예제**:
    *   푸아송 모델: $\hat{\beta}$의 SE = 0.06
    *   음이항 모델: $\hat{\beta}$의 SE = 0.12, $\hat{\gamma}=1.07$
    *   **해석**: 음이항 모델은 과대산포($\hat{\gamma}=1.07 > 0$)를 감지했다. 그 결과, $\beta$ 추정치의 불확실성이 더 크다는 것을 반영하여 **표준오차(SE)를 2배로 부풀려 주었다**. 이는 과대산포를 무시했을 때 우리가 얼마나 추정치를 과신하게 되는지를 보여주는 좋은 예이다.

**결론**: 과대산포가 의심될 때, 푸아송 모델의 대안으로 **음이항 모델을 사용하는 것이 가장 표준적이고 바람직한 접근법**이다.

#### **4.3.5: 카운트를 비율로, 오프셋(Offset)의 마법**

*   **문제**: 때로는 단순 카운트($Y_i$)가 아니라, **비율(rate)**을 모델링하고 싶을 때가 있다.
    *   예: 병원 A에서 1000명의 환자 중 20명이 감염되었고, 병원 B에서 100명의 환자 중 5명이 감염되었다. 단순 카운트(20 vs 5)를 비교하는 것은 의미가 없다. 우리는 **감염률($20/1000$ vs $5/100$)**을 비교해야 한다.
*   **아이디어**: 푸아송 모델은 카운트($\mu_i$)를 모델링한다. 우리는 **비율($\mu_i / t_i$)**을 모델링하고 싶다.
    *   $Y_i$: 사건의 카운트 (예: 감염자 수)
    *   $t_i$: 노출량 (exposure), 즉 카운트가 발생한 "기회"의 크기 (예: 전체 환자 수, 관찰 시간, 면적).
*   **오프셋(Offset)을 이용한 모델링**:
    1.  **모델**: 우리는 '비율'의 로그가 예측 변수의 선형 함수라고 모델링한다.

$$ \log(\mu_i / t_i) = \alpha + \beta x_i $$

    2.  **수학적 변형**: 로그의 성질을 이용하여 식을 변형한다.

$$ \log(\mu_i) - \log(t_i) = \alpha + \beta x_i $$

$$ \log(\mu_i) = \alpha + \beta x_i + \log(t_i) $$

    3.  **오프셋의 정의**: 이 마지막 항, $\log(t_i)$가 바로 **오프셋**이다.
*   **오프셋의 실체**: 오프셋은 모델의 우변에 포함되는 특별한 예측 변수이다.
    *   **차이점**: 일반 예측 변수($x_i$)는 그 계수($\beta$)를 데이터로부터 추정하지만, 오프셋 변수($\log t_i$)는 그 **계수를 1로 강제로 고정**한다.
*   **결과**: 이 방법을 사용하면, 우리는 여전히 푸아송 GLM을 사용하여 카운트 데이터($Y_i$)를 직접 모델링하면서도, 그 결과는 사실상 **비율**에 대한 모델이 된다. 이는 다양한 분야(역학, 보험, 생태학 등)에서 비율 데이터를 분석하는 매우 강력하고 표준적인 방법이다.

**결론**: '오프셋'은 푸아송 회귀 모델을 단순 카운트 모델에서 **비율 모델**로 확장시켜주는 핵심적인 기법이다. 이는 서로 다른 노출량($t_i$)을 가진 관측치들을 공평하게 비교할 수 있게 해준다.
