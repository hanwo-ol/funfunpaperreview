### **4.1.4 연속형 반응을 위한 일반화 선형 모델 (Generalized Linear Models for Continuous Responses)**

**[원문 번역]**

GLM의 종류에는 연속형 반응에 대한 모델들도 포함된다. 정규분포는 분산 모수를 포함하는 자연 지수족에 속한다. 그것의 자연 모수는 평균이다. 따라서, 일반적인 회귀 모델은 항등 연결(identity link)을 사용하는 GLM이다. 표 4.1은 이것과 정규 확률 성분을 갖는 다른 표준 모델들을 나열한다. 이 표는 또한 5-10장에서 제시될 이산형 반응에 대한 GLM들도 나열한다.

### **4.1.5 GLM의 이탈도 (Deviance of a GLM)**

**[원문 번역]**

관측치 $\mathbf{y}=(y_1, \dots, y_N)$를 갖는 특정 GLM에 대해, $L(\boldsymbol{\mu}; \mathbf{y})$를 평균 $\boldsymbol{\mu}=(\mu_1, \dots, \mu_N)$의 항으로 표현된 로그우도 함수라고 하자. $L(\hat{\boldsymbol{\mu}}; \mathbf{y})$를 그 모델에 대한 로그우도의 최댓값이라고 하자. 모든 가능한 모델들을 고려했을 때, 달성 가능한 최대 로그우도는 $L(\mathbf{y}; \mathbf{y})$이다. 이것은 가장 일반적인 모델, 즉 각 관측치에 대해 개별적인 모수를 갖고 완벽한 적합 $\hat{\boldsymbol{\mu}}=\mathbf{y}$를 갖는 모델에서 발생한다. 이러한 모델을 **포화 모델(saturated model)**이라고 부른다. 이 모델은 데이터를 요약(reduction)하지 않기 때문에 유용하지 않다. 하지만, 다른 모델 적합도와 비교하기 위한 기준선(baseline) 역할을 한다.

푸아송 또는 이항 GLM의 **이탈도(deviance)**는 다음과 같이 정의된다.

$$ -2[L(\hat{\boldsymbol{\mu}}; \mathbf{y}) - L(\mathbf{y}; \mathbf{y})] $$

이것은 현재 모델이 성립한다는 귀무가설을 일반적인 대안가설(즉, 포화 모델)에 대해 검정하는 우도비 통계량이다. 우리는 모델 검토와 모델들의 추론적 비교를 위해 책 전반에 걸쳐 이탈도를 사용한다. 이탈도를 분석하는 방법들은 정규 선형 모델의 분산 분석(ANOVA) 방법들을 일반화한다.

푸아송 및 이항 GLM을 사용하는 일부 적용 사례에서는, 관측치의 수 $N$이 고정되어 있고 개별 카운트가 상대적으로 크다. 그러면 이탈도는 근사적으로 카이제곱 귀무분포를 갖는다. 자유도 df = $N-p$이며, 여기서 $p$는 모델 모수의 수이다; 즉, df는 포화 모델의 모수 개수와 불포화 모델(unsaturated model)의 모수 개수 간의 차이와 같다. 그러면 이탈도는 모델의 적합도 검정(test of model fit)을 제공한다.

한 가지 그러한 예는 예측 변수의 $N$개 고정된 설정에서 독립적인 이항 카운트가 있고, 각 설정에서의 시행 횟수가 클 때이다. $Y_i$가 $\text{bin}(n_i, \pi_i)$, $i=1, \dots, N$이라고 하자. 동질성이라는 단순 모델, $\pi_i = \alpha$ (모든 i에 대해)를 고려하자. 이것은 $p=1$개의 모수를 갖는다. 포화 모델은 $\{\pi_i\}$에 대해 아무 가정도 하지 않고, 그들이 0과 1.0 사이의 어떤 $N$개의 값이든 되도록 허용한다. 이것은 $N$개의 모수를 갖는다. 동질성 모델에 대한 이탈도는 df = $N-1$을 갖는다. 사실, 이것은 이 표본들이 형성하는 $N \times 2$ 분할표에서 독립성을 검정하기 위한 $G^2$ 우도비 통계량 (3.11)과 같다. 독립성 하에서, 그 분포는 고정된 $N$에 대해 $\{n_i\}$가 증가함에 따라 카이제곱 분포로 수렴한다.

### **4.1.6 데이터 변환 대비 GLM의 장점 (Advantages of GLMs Versus Transforming the Data)**

**[원문 번역]**

데이터를 모델링하는 전통적인 방식은 Y를 변환하여 근사적으로 정규분포와 일정한 분산을 갖도록 만드는 것이다; 그러면, 일반적인 최소제곱 회귀분석이 적용 가능하다. 반면, GLM에서는 연결 함수의 선택이 확률 성분의 선택과 분리되어 있다. 만약 어떤 연결 함수가 예측 변수에 대한 선형 모델이 타당하다는 의미에서 유용하다면, 그 연결 함수가 분산을 안정화시키거나 정규성을 만들어낼 필요는 없다. 이는 적합 과정이 Y에 대해 선택된 분포에 대한 우도를 최대화하고, 그 선택이 정규분포에 국한되지 않기 때문이다.

$g$가 GLM 접근법에서의 연결 함수이거나 변환된 데이터 접근법에서의 변환 함수(예: 로그 함수)를 나타낸다고 하자. GLM 공식의 한 가지 장점은 모델 모수들이 변환된 데이터 접근법에서의 $E[g(Y)]$ 대신 $g[E(Y)]$를 기술한다는 것이다. GLM 접근법으로, 그 모수들은 또한 $g$의 역함수를 적용한 후 설명 변수들이 $E(Y)$에 미치는 효과를 기술한다. 그러한 효과들은 설명 변수들이 $E[g(Y)]$에 미치는 효과보다 더 관련성이 있다.

GLM은 연속형 및 이산형 변수에 대한 가장 중요한 모델들을 포괄하는 통일된 모델링 이론을 제공한다. 이 텍스트에서 연구되는 모델들은 이항 또는 푸아송 확률 성분을 갖는 GLM이거나, GLM의 다변량 확장이다. ML 모수 추정치는 4.6절에서 제시되는, 가중 최소제곱법의 반복적인 버전을 사용하는 알고리즘으로 계산된다. GLM을 Y에 대한 지수족 분포로 제한하는 한 가지 이유는, 어떤 연결 함수를 선택하든, 이 전체 족에 동일한 알고리즘이 적용되기 때문이다.

---

### **핵심 내용 해설**

#### **4.1.4: GLM, 모든 회귀분석의 어머니**

*   **핵심**: 우리가 흔히 아는 **일반 선형 회귀분석(OLS)**도 사실은 GLM의 **특별한 한 경우**에 불과하다.
*   **OLS를 GLM의 3요소로 분해하기**:
    1.  **확률 성분**: 반응 변수 Y는 **정규분포**를 따른다.
    2.  **시스템 성분**: $\eta = \beta_0 + \beta_1 x_1 + \dots$
    3.  **연결 함수**: **항등 연결(Identity link)**. $g(\mu)=\mu$. 즉, $\mu=\eta$.
*   **의미**: GLM이라는 거대한 프레임워크는 로지스틱 회귀나 푸아송 회귀 같은 새로운 모델뿐만 아니라, 가장 전통적인 회귀분석까지 모두 포괄하는 **통일된 이론**을 제공합니다. 이는 통계 모델링에 대한 우리의 이해를 한 차원 높여줍니다.

#### **4.1.5: 모델이 얼마나 좋은지 평가하는 잣대, "이탈도(Deviance)"**

*   **핵심 질문**: "내가 만든 모델이 데이터를 얼마나 잘 설명하는가? 완벽한 모델에 비해 얼마나 정보 손실이 있는가?"
*   **기준점: 포화 모델 (Saturated Model)**
    *   **정의**: 가장 복잡하고 완벽한 모델. 데이터의 모든 관측치를 정확하게 예측하기 위해 관측치 개수만큼의 모수를 사용합니다 ($\hat{\mu}_i = y_i$).
    *   **역할**: 이론적인 "최고 점수" 기준선. 이 모델의 로그우도 $L(\mathbf{y};\mathbf{y})$는 달성 가능한 최대 로그우도입니다.
    *   **한계**: 데이터를 전혀 요약하지 못하고(모수 개수=데이터 개수), 새로운 데이터에 대한 예측력이 없으므로 실제 분석에는 쓸모가 없습니다.
*   **이탈도 (Deviance)의 정의**:

$$ D = -2[L(\hat{\boldsymbol{\mu}}; \mathbf{y}) - L(\mathbf{y}; \mathbf{y})] = 2[L(\mathbf{y}; \mathbf{y}) - L(\hat{\boldsymbol{\mu}}; \mathbf{y})] $$

*   **해석**: (최고 점수 로그우도)와 (내 모델의 로그우도) 사이의 **거리**입니다.
    *   이탈도는 **우도비 검정 통계량** 그 자체입니다. 이는 "내 모델이 맞다"는 귀무가설을 "포화 모델이 맞다(즉, 내 모델은 틀렸다)"는 대립가설에 대해 검정하는 것입니다.

*   **이탈도의 용도**:
    1.  **적합도 검정 (Goodness-of-Fit Test)**: 이탈도 값 자체가 **모델이 데이터에 전반적으로 잘 맞는지를 평가**하는 지표가 됩니다.
        *   표본 크기가 크고 데이터가 그룹화되어 있을 때, 이탈도는 근사적으로 카이제곱 분포($\chi^2_{N-p}$)를 따릅니다.
        *   이탈도를 이용한 검정에서 P-값이 작으면, "내 모델은 데이터에 잘 맞지 않는다"고 결론 내립니다.
    2.  **모델 비교**: 두 모델(하위 모델 $M_0$, 상위 모델 $M_1$)의 **이탈도의 차이**는 두 모델 간의 우도비 검정 통계량과 같습니다. 이를 이용해 어떤 모델이 통계적으로 더 나은지를 판단합니다.

#### **4.1.6: 왜 굳이 GLM을 쓰는가? (데이터 변환의 문제점)**

과거에는 반응 변수 Y가 정규분포를 따르지 않으면(예: 비율, 카운트), Y에 **변환(transformation)**을 가하여(예: $\log(Y)$, $\sqrt{Y}$) 정규분포처럼 만든 후 OLS 회귀분석을 적용했습니다. GLM은 이보다 훨씬 우월한 접근법입니다.

| | **데이터 변환 접근법** | **GLM 접근법** |
| :--- | :--- | :--- |
| **목표** | $Y$ 자체의 분포를 정규분포로 만든다. | $Y$의 분포는 그대로 두고(예: 이항), 그 **평균($\mu$)**을 모델링한다. |
| **변환 대상** | **데이터 Y** 자체. $g(Y)$. | **평균 E(Y)=$\mu$**. $g(\mu)$. |
| **모델** | $E[g(Y)] = \beta_0 + \beta_1 x_1$ | $g[E(Y)] = \beta_0 + \beta_1 x_1$ |
| **핵심 장점** | | **연결 함수와 확률 분포의 분리**: 연결 함수 $g$는 "평균과 예측 변수의 관계"를 가장 잘 설명하는 함수로 선택하면 된다. 이 함수가 분산을 안정화시키거나 정규성을 만들어야 할 의무가 없다. |
| **해석** | 설명 변수가 **"Y의 변환값의 평균"**($E[g(Y)]$)에 미치는 효과를 설명. 해석이 어렵고 부자연스러움. | 설명 변수가 **"평균 Y의 변환값"**($g[E(Y)]$)에 미치는 효과를 설명. 역변환을 통해 **"평균 Y"**에 대한 효과로 쉽게 해석 가능. 훨씬 더 직관적이고 유용함. |

**예시**: 카운트 데이터(Y)를 분석할 때
*   **데이터 변환**: $\log(Y)$를 종속변수로 놓고 선형 회귀분석. $\implies$ "x가 1 증가할 때, **카운트의 로그값의 평균**이 $\beta$만큼 변한다."
*   **GLM (푸아송 로그선형 모델)**: $\log(E[Y]) = \beta_0 + \beta_1 x_1$. $\implies$ "x가 1 증가할 때, **평균 카운트**가 $e^\beta$ **배**만큼 변한다."

GLM의 해석이 훨씬 더 직접적이고 의미가 명확합니다. GLM은 데이터의 실제 분포를 존중하면서 평균과 예측 변수 간의 관계를 유연하게 모델링하는, 통계적으로 훨씬 더 정교하고 우월한 방법론입니다.
