### 4.3.6 예제: 심장 판막 수술의 사망률 모델링 (Example: Modeling Death Rates for Heart Valve Operations)

[원문 번역]

Laird와 Olivier(1981)는 심장 판막 교체 수술 후 환자 생존을 분석했다. 109명의 환자 표본이 심장 판막의 종류(대동맥, 승모판)와 연령(<55, ≥55)에 따라 분류되었다. 추적 관찰은 환자가 사망하거나 연구가 끝날 때까지 이루어졌다. 수술은 연구 기간 전반에 걸쳐 발생했으며, 추적 관찰은 3개월에서 97개월까지 다양한 기간을 포괄했다. 반응 변수는 피험자가 사망했는지 여부와 추적 관찰 시간이었다. 사망한 피험자에 대해, 이것은 수술 후 사망까지의 시간이다; 다른 사람들에 대해서는, 연구가 끝나거나 피험자가 연구에서 이탈할 때까지의 시간이다.

표 4.5는 추적 기간 동안의 사망자 수를 판막 종류와 연령별로 나열한다. 이 카운트들은 판막 종류, 연령, 사망 여부(예, 아니오)를 분류하는 삼원 분할표의 첫 번째 층이다. 표 4.5에 집계되지 않은 피험자들은 사망이 관찰되지 않았다. 그들은 중도절단(censored)되었는데, 왜냐하면 우리는 그들이 수술 후 얼마나 오래 살았는지에 대한 하한선만 알기 때문이다. 사망 확률에 대한 이항 GLM을 사용하여 그 $2 \times 2 \times 2$ 표를 분석하는 것은 부적절한데, 이는 피험자들이 서로 다른 위험 기간(times at risk)을 가졌기 때문이다; 3개월 동안 관찰될 수 있었던 피험자와 97개월 동안 관찰될 수 있었던 피험자를 동일한 확률을 갖는 동일한 시행으로 취급하는 것은 합리적이지 않다.

사망 빈도에 대한 모델에서 연령과 판막 종류를 예측 변수로 사용하기 위해, 적절한 기준선은 피험자의 수가 아니라 피험자들이 위험에 처해 있었던 총 시간이다. 따라서, 우리는 사망률(rate)을 모델링한다.

피험자의 위험 기간(time at risk)은 그들의 추적 관찰 시간이다. 주어진 연령과 판막 종류에 대해, 총 위험 기간은 그 셀에 있는 모든 피험자(사망자와 중도절단된 자 모두)의 위험 기간의 합이다. 표에 또한 나와 있는 표본 비율은 총 위험 기간(월 단위)으로 사망자 수를 나눈 것이다. 예를 들어, 대동맥 판막 교체를 받은 젊은 피험자들에게서 1259개월의 관찰 기간 동안 4명의 사망이 발생했으므로, 그들의 표본 비율은 4/1259 = 0.0032이다.

이제 우리는 비율에 대한 연령과 판막 종류의 효과를 모델링한다. $Y _{ij}$를 연령 $a _i$와 판막 종류 $v _j$에 대한 사망자 수, 총 위험 기간 $t _{ij}$에 대한 기대값을 $\mu _{ij}$라고 하자. $t _{ij}$가 주어졌을 때, 기대 비율은 $\mu _{ij}/t _{ij}$이다. $a$를 연령에 대한 지시 변수(indicator variable)로, 젊은 연령 그룹에 대해 $a _1=0$, 나이든 연령 그룹에 대해 $a _2=1$로 하자. $v$를 판막 종류에 대한 지시 변수로, 대동맥에 대해 $v _1=0$, 승모판에 대해 $v _2=1$로 하자. 모델

$$ \log(\mu _{ij}/t _{ij}) = \alpha + \beta _1 a _i + \beta _2 v _j \quad (4.15) $$

는 연령과 판막 종류 효과에 상호작용이 없다고 가정한다.

소프트웨어를 사용하여(텍스트 웹사이트에 나와 있듯이), 우리는 $\{Y _{ij}\}$를 $\{t _{ij}\}$가 주어진 조건 하에서 평균 $\{\mu _{ij}\}$를 갖는 독립적인 푸아송 변수로 취급한다. 표 4.6은 적합된 사망자 수와 추정된 비율을 제시한다. 추정된 효과는

$$ \hat{\beta} _1 = 1.221 (\text{SE}=0.514), \quad \hat{\beta} _2 = -0.330 (\text{SE}=0.438). $$

연령 효과의 증거가 있다. 판막 종류가 주어졌을 때, 나이든 연령 그룹의 추정된 사망률은 젊은 연령 그룹의 사망률의 $\exp(1.221)=3.39$배이다. 연구는 많은 중도절단 데이터를 포함한다. 109명의 환자 중, 연구 기간 동안 오직 21명만이 사망했으므로, 두 효과 추정치 모두 부정확하다. 하지만, 분석은 위험 기간에 대한 그들의 기여를 통해 109명 환자 모두를 사용한다는 점에 주목하라.

### 4.3.7 이원 분할표의 독립성에 대한 푸아송 GLM (Poisson GLM of Independence in Two-Way Contingency Tables)

[원문 번역]

푸아송 로그선형 모델은 또한 일반적인 분할표의 카운트를 모델링하는 데 사용된다. 우리는 평균 $\{\mu _{ij}\}$를 갖는 푸아송 분포를 따르는 독립적인 카운트 $\{Y _{ij}\}$를 갖는 이원 분할표에 대해 설명한다. $\{\mu _{ij}\}$가

$$ \mu _{ij} = \mu \alpha _i \beta _j $$

를 만족한다고 가정하자. 여기서 $\{\alpha _i\}$와 $\{\beta _j\}$는 $\sum _i \alpha _i = \sum _j \beta _j = 1$을 만족하는 양의 상수들이다. 이것은 곱셈 모델이지만, 로그 연결을 사용하면 GLM에 대한 선형 예측자가 나온다.

$$ \log \mu _{ij} = \lambda + \alpha _i^* + \beta _j^* \quad (4.16) $$

여기서 $\lambda = \log\mu, \alpha _i^* = \log\alpha _i, \beta _j^* = \log\beta _j$이다. 이 푸아송 로그선형 모델은 두 분류의 주효과(main effects)는 덧셈적이지만 상호작용은 없다.

$\{Y _{ij}\}$가 독립이므로, 전체 표본 크기 $\sum _i\sum _j Y _{ij}$는 평균 $\sum _i\sum _j \mu _{ij} = \mu$를 갖는 푸아송 분포를 따른다. $\sum _i\sum _j y _{ij} = n$이 주어졌을 때, 셀 빈도는 확률 $\{\pi _{ij} = \mu _{ij}/\mu = \alpha _i \beta _j = \pi _{i+}\pi _{+j}\}$를 갖는 다항 분포를 따른다. 이것은 두 범주형 변수 간의 독립성(independence)이다. 사실, 푸아송 형태에서, 독립성은 로그선형 모델 (4.16)이다. 3장에서 수행된 이원 분할표의 독립성에 대한 추론들은, $n$ 또는 행이나 열 총합을 고정하는 푸아송 로그선형 모델 또는 그에 상응하는 다항 모델인 GLM들과 관련된다.

---

### 핵심 내용 해설

#### 4.3.6: 오프셋의 실제 적용 - 생존 분석

이 예제는 4.3.5절에서 배운 오프셋(offset) 개념을 실제 생존 데이터 분석에 적용하는 과정을 보여줍니다.

*   문제: 환자마다 추적 관찰 기간(위험 기간, time at risk)이 다르다. 97개월 관찰된 환자와 3개월 관찰된 환자를 동일하게 취급하여 사망 '확률'을 비교하는 것은 부적절하다.
*   올바른 접근: 사망 '비율(rate)'을 비교해야 한다. (예: 1000 환자-개월 당 사망자 수)
*   모델링:
    1.  반응 변수 ($Y _{ij}$): 각 셀(연령 $i$, 판막 $j$)의 사망자 수. 이는 카운트 데이터이므로 푸아송 분포를 가정한다.
    2.  노출량 ($t _{ij}$): 각 셀의 총 위험 기간 (해당 그룹 환자들의 관찰 기간 총합).
    3.  오프셋을 이용한 푸아송 회귀: 우리는 사망률($\mu _{ij}/t _{ij}$)을 모델링하고 싶다.

$$ \log(\text{사망률}) = \log(\mu _{ij}/t _{ij}) = \alpha + \beta _1(\text{연령}) + \beta _2(\text{판막}) $$
 
이를 푸아송 GLM이 이해할 수 있는 형태로 바꾸면,

$$ \log(\mu _{ij}) = \alpha + \beta _1(\text{연령}) + \beta _2(\text{판막}) + \log(t _{ij}) $$

여기서 $\log(t _{ij})$가 바로 오프셋 항이다.

*   해석:
    *   $\hat{\beta} _1=1.221$. 이는 연령의 효과이다.
    *   곱셈적 해석: $e^{1.221} = 3.39$. "판막 종류가 같을 때, 나이든 그룹의 사망률은 젊은 그룹의 사망률보다 3.39배 높다."
*   중요한 점: 비록 109명 중 21명만 사망했지만, 중도절단된 나머지 88명의 데이터도 그들의 '위험 기간'($t _{ij}$)을 통해 분석에 모두 포함되었다. 이것이 생존 분석의 중요한 특징이다.

#### 4.3.7: 푸아송 모델로 독립성 다시 보기

이 섹션은 분할표 분석의 두 가지 다른 관점, 즉 다항 모델과 푸아송 모델이 어떻게 연결되는지를 보여줍니다.

*   관점 1 (3장): $n$개의 표본을 $I \times J$ 표로 분류한다. $\implies$ 다항 분포
    *   독립성 $H _0: \pi _{ij} = \pi _{i+}\pi _{+j}$
*   관점 2 (현재): 각 셀 빈도 $n _{ij}$가 평균 $\mu _{ij}$를 갖는 독립적인 푸아송 분포에서 나왔다고 가정한다.

두 관점의 연결:
1.  푸아송 독립성 모델: 각 셀의 평균 $\mu _{ij}$가 "전체 평균($\mu$) $\times$ 행 효과($\alpha _i$) $\times$ 열 효과($\beta _j$)" 라는 곱셈적 구조를 갖는다고 가정한다.

$$ \mu _{ij} = \mu \alpha _i \beta _j $$

2.  로그선형 모델로 변환: 이 곱셈 모델에 로그를 취하면, 덧셈 모델이 된다.

$$ \log \mu _{ij} = \log\mu + \log\alpha _i + \log\beta _j = \lambda + \alpha _i^* + \beta _j^* $$

이것이 바로 상호작용이 없는 주효과 모델이며, 푸아송 GLM의 한 형태이다.

3.  푸아송에서 다항으로: 만약 우리가 전체 카운트의 합($\sum\sum n _{ij} = n$)에 대해 조건을 부여하면, 독립적인 푸아송 셀 빈도에 대한 확률분포는, 셀 확률이 $\pi _{ij} = \mu _{ij}/\mu$ 인 다항분포가 된다.
4.  최종 연결:

$$ \pi _{ij} = \frac{\mu _{ij}}{\mu} = \frac{\mu \alpha _i \beta _j}{\mu} = \alpha _i \beta _j $$

여기서 $\alpha _i$는 $\pi _{i+}$와, $\beta _j$는 $\pi _{+j}$와 같다. 따라서, $\pi _{ij} = \pi _{i+}\pi _{+j}$ 가 된다.
    *   결론: 푸아송 셀 빈도에 대해 상호작용 없는 로그선형 모델을 가정하는 것은, 전체 합계를 고정시켰을 때의 다항 모델에서 독립성을 가정하는 것과 수학적으로 동등하다.

의미: 이는 우리가 3장에서 수행했던 독립성 검정($X^2, G^2$)이 사실은 푸아송 로그선형 모델이라는 더 큰 GLM 프레임워크의 특수한 경우로 이해될 수 있음을 의미한다. 이 모델 기반 접근법은 나중에 더 복잡한 다원 분할표 분석으로 자연스럽게 확장된다.
