### 4.5.4 이탈도를 이용한 우도비 모델 비교 (Likelihood-Ratio Model Comparison Using the Deviances)

[원문 번역]

$M$으로 표기되는 푸아송 또는 이항 모델에 대해, $\phi=1$이므로, 이탈도 (4.33)는 다음과 같다.

$$ D(\mathbf{y}; \hat{\boldsymbol{\mu}}) = -2[L(\hat{\boldsymbol{\mu}};\mathbf{y}) - L(\mathbf{y};\mathbf{y})] \quad (4.37) $$

적합치가 $\hat{\boldsymbol{\mu}} _0$인 모델 $M _0$와 적합치가 $\hat{\boldsymbol{\mu}} _1$인 모델 $M _1$을 고려하자. 단, $M _0$는 $M _1$의 특별한 경우이다. 모델 $M _0$는 $M _1$ 내에 포함(nested)된다고 말한다.

$M _0$가 $M _1$보다 더 단순하므로, $M _0$를 만족하는 더 작은 모수 값 집합이 $M _1$을 만족한다. 더 작은 공간에서 로그우도를 최대화하는 것은 더 큰 최댓값을 산출할 수 없다. 따라서, $L(\hat{\boldsymbol{\mu}} _0;\mathbf{y}) \le L(\hat{\boldsymbol{\mu}} _1;\mathbf{y})$이며, 각 모델에 대해 동일한 $L(\mathbf{y};\mathbf{y})$를 사용하는 (4.37)로부터 다음이 성립한다.

$$ D(\mathbf{y};\hat{\boldsymbol{\mu}} _1) \le D(\mathbf{y};\hat{\boldsymbol{\mu}} _0) $$

더 단순한 모델은 더 큰 이탈도를 갖는다. 모델 $M _1$이 성립한다고 가정할 때, $M _0$가 성립한다는 가설의 우도비 검정은 다음의 검정 통계량을 사용한다.

$$ -2[L(\hat{\boldsymbol{\mu}} _0;\mathbf{y}) - L(\hat{\boldsymbol{\mu}} _1;\mathbf{y})] $$

$$ = \{-2[L(\hat{\boldsymbol{\mu}} _0;\mathbf{y}) - L(\mathbf{y};\mathbf{y})]\} - \{-2[L(\hat{\boldsymbol{\mu}} _1;\mathbf{y}) - L(\mathbf{y};\mathbf{y})]\} $$

$$ = D(\mathbf{y};\hat{\boldsymbol{\mu}} _0) - D(\mathbf{y};\hat{\boldsymbol{\mu}} _1) $$

두 모델을 비교하는 우도비 통계량은 단순히 이탈도들의 차이(difference between the deviances)이다. 이 통계량은 $M _0$가 $M _1$에 비해 형편없이 적합될 때 크다.

사실, (4.33)에서 포화 모델과 관련된 부분이 상쇄되므로, 이탈도들의 차이,

$$ D(\mathbf{y};\hat{\boldsymbol{\mu}} _0) - D(\mathbf{y};\hat{\boldsymbol{\mu}} _1) = 2\sum _i \omega _i [y _i(\hat{\theta} _{1i}-\hat{\theta} _{0i}) - b(\hat{\theta} _{1i}) + b(\hat{\theta} _{0i})] $$

또한 이탈도의 형태를 갖는다. 정규성 조건 하에서, 이 차이는 두 모델의 모수 개수의 차이와 같은 자유도를 갖는 근사적인 카이제곱 귀무분포를 갖는다.

절편이 있는 이항 GLM과 푸아송 로그선형 GLM에 대해, 이탈도에 대한 표현식 (4.35)와 (4.36)으로부터, 이탈도들의 차이는 관측된 카운트와 두 벌의 적합치를 다음과 같은 형태로 사용한다.

$$ D(\mathbf{y};\hat{\boldsymbol{\mu}} _0) - D(\mathbf{y};\hat{\boldsymbol{\mu}} _1) = 2\sum _i y _i \log(\hat{\mu} _{1i}/\hat{\mu} _{0i}) $$

### 4.5.5 적합도 및 모델 비교를 위한 스코어 검정 (Score Tests for Goodness of Fit and for Model Comparison)

[원문 번역]

분산 함수 $\text{var}(Y _i)=v(\mu _i)$와 $\phi=1$을 갖는 일반적인 GLM에 대해, 모델 적합도를 검정하는 스코어 통계량은 일반화된 피어슨 형태를 갖는다 (Lovison 2005, Smyth 2003).

$$ X^2 = \sum _i \frac{(y _i - \hat{\mu} _i)^2}{v(\hat{\mu} _i)} \quad (4.39) $$

$v(\hat{\mu} _i)=\hat{\mu} _i$인 푸아송 $y _i$에 대해, 이것은 통상적인 피어슨 형태를 갖는다.

$$ \text{피어슨 통계량} = \sum (\text{관측} - \text{적합})^2 / \text{적합} $$

$y _i$가 $n _i$번의 시행에 기반한 이항 비율이고 $v(\hat{\mu} _i)=v(\hat{\pi} _i)=\hat{\pi} _i(1-\hat{\pi} _i)/n _i$일 때, $N$개의 이항 성공 관측치에 대한 $X^2$ 합 (4.39)은, 또한 이 피어슨 형태를 갖는 성공과 실패의 $2N$개 카운트에 대한 합과 동일하다.

두 포함된 모델에 대해, 피어슨 차이 $X^2(M _0) - X^2(M _1)$은 피어슨 형태를 갖지 않는다. 그것은 심지어 반드시 음이 아닐 수도 있다. 모델들을 비교하는 더 적절한 일반화된 피어슨 통계량은 다음과 같다 (Lovison 2005, Rao 1961).

$$ X^2(M _0|M _1) = \sum _i (\hat{\mu} _{1i} - \hat{\mu} _{0i})^2 / v(\hat{\mu} _{0i}) \quad (4.40) $$

이것은 $\{y _i\}$ 대신 $\{\hat{\mu} _{1i}\}$를 사용하여 일반화된 피어슨 형태를 갖는다. 이것은 $M _1$이 포화 모델이 아닌 이상 모델들을 비교하는 스코어 통계량은 아니다. 하지만, $v(\hat{\mu} _{0i})=\hat{\mu} _{0i}$인 푸아송 모델에 대해서는, 이것은 이탈도들의 차이 (4.38)에 대한 이차 근사이며 동일한 귀무 점근적 거동을 갖는다.

---

### 핵심 내용 해설

이 섹션들은 개별 모델의 적합도를 평가하는 것을 넘어, 두 경쟁하는 모델 중 어느 것이 더 나은지를 통계적으로 판단하는 방법을 설명합니다.

#### 4.5.4: 이탈도의 차이 = 모델 간의 거리

*   포함된 모델 (Nested Models): 비교하려는 두 모델 $M _0$와 $M _1$이 계층적 관계에 있을 때, 즉 "단순한 모델($M _0$)이 복잡한 모델($M _1$)의 특별한 경우일 때" $M _0$는 $M _1$에 포함된다고 합니다.
    *   예: $M _1: \eta = \alpha+\beta _1 x _1 + \beta _2 x _2$  vs  $M _0: \eta = \alpha+\beta _1 x _1$
    *   $M _0$는 $M _1$에서 $\beta _2=0$이라는 제약을 가한 모델이므로, $M _0$는 $M _1$에 포함됩니다.
*   이탈도의 기본 속성: 더 복잡한 모델은 데이터를 더 잘 설명하므로, 항상 더 작은 이탈도를 가집니다.
    *   $D(M _1) \le D(M _0)$
*   우도비 검정 (LR Test)의 재발견:
    *   두 포함된 모델을 비교하는 우도비 검정 통계량($-2[L _0-L _1]$)은 놀랍게도 두 모델의 이탈도의 차이와 정확히 일치합니다.

$$ G^2(M _0|M _1) = -2[L _0 - L _1] = D(M _0) - D(M _1) $$

*   해석: "단순한 모델($M _0$)의 이탈도(적합성 부족)가 복잡한 모델($M _1$)의 이탈도보다 얼마나 더 큰가?"
    *   이 이탈도의 차이는 근사적으로 카이제곱 분포를 따릅니다.
    *   자유도: (두 모델의 모수 개수의 차이). 위의 예에서는 $(3-2)=1$ 입니다.
*   실용적 의미: 통계 소프트웨어가 각 모델의 이탈도를 출력해 준다면, 우리는 단순히 그 값들을 빼기만 해서 두 모델을 비교하는 강력한 우도비 검정을 수행할 수 있습니다.

#### 4.5.5: 스코어 검정 = 피어슨 통계량

우도비 검정 외에, 스코어 검정을 사용하여 모델을 평가할 수도 있습니다.

*   적합도 검정 (모델 vs. 포화 모델):
    *   "내 모델이 데이터에 잘 맞는가?"를 검정하는 스코어 통계량은 일반화된 피어슨 통계량 $X^2$ (공식 4.39)과 같습니다.

$$ X^2 = \sum \frac{(\text{관측} - \text{적합})^2}{\text{추정된 분산}} $$

*   푸아송의 경우 $\text{var}(Y)=\mu$이므로, 이는 우리가 아는 피어슨 카이제곱 통계량 $\sum\frac{(y _i-\hat{\mu} _i)^2}{\hat{\mu} _i}$이 됩니다.
    *   $X^2$ vs $G^2$ (이탈도): $X^2$과 $G^2$은 모두 모델의 적합도를 평가하며, 점근적으로 동일한 카이제곱 분포를 따릅니다. 둘 중 어느 것을 사용해도 되지만, 이론적 배경과 속성에서 차이가 있습니다.

*   모델 비교 ( $M _0$ vs. $M _1$ ):
    *   이탈도처럼 단순하게 $X^2(M _0) - X^2(M _1)$을 사용할 수는 없습니다. 이 값은 카이제곱 분포를 따르지 않으며 음수가 될 수도 있습니다.
    *   대신, 모델 비교를 위한 스코어 검정은 (4.40)과 같은 다른 형태를 가집니다.

$$ X^2(M _0|M _1) = \sum \frac{(\text{복잡한 모델의 적합치} - \text{단순한 모델의 적합치})^2}{\text{단순한 모델 하의 추정된 분산}} $$

*   해석: "단순한 모델이 예측한 값과, 더 나은(복잡한) 모델이 예측한 값 사이에 얼마나 큰 차이가 있는가?"
    *   이 통계량 또한 두 모델의 모수 개수 차이를 자유도로 갖는 카이제곱 분포를 근사적으로 따릅니다.

종합 요약:
1.  모델의 전반적인 적합도를 평가하고 싶다면, 이탈도($G^2$)나 피어슨 통계량($X^2$)을 사용하여 포화 모델과 비교할 수 있습니다. (단, 그룹화 데이터 등 조건 만족 시)
2.  두 포함된 모델($M _0, M _1$)의 성능을 비교하고 싶다면 (예: "새 변수를 추가하는 것이 의미가 있는가?"), 다음 두 가지 표준적인 방법을 사용할 수 있습니다.
    *   우도비 검정: 두 모델의 이탈도의 차이 $D(M _0) - D(M _1)$를 계산.
    *   스코어 검정: 두 모델의 적합치의 차이에 기반한 $X^2(M _0|M _1)$ 통계량을 계산.

이 두 가지 모델 비교 방법은 GLM 분석에서 변수 선택, 상호작용 항의 유의성 평가 등 핵심적인 역할을 수행합니다.
