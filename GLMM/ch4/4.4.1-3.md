### 4.4.1 지수 분산족 (The Exponential Dispersion Family)

[원문 번역]

GLM에 대한 표기법을 두 번째 모수를 갖는 많은 분포들을 다룰 수 있도록 확장하는 것이 도움이 된다. GLM의 확률 성분은 N개의 관측치 $(y _1, \dots, y _N)$이 독립적이며, 각 $y _i$가 다음과 같은 형태의 확률질량함수 또는 밀도함수를 갖는다고 명시한다.

$$
f(y _i; \theta _i, \phi) 
= \exp\left( \frac{y _i\theta _i - b(\theta _i)}{a(\phi)} + c(y _i, \phi) \right)
\quad (4.17)
$$

이것을 지수 분산족(exponential dispersion family)이라고 부르며, $\phi$는 분산 모수(dispersion parameter)라고 불린다 (Jørgensen 1987). 모수 $\theta _i$는 자연 모수(natural parameter)이다.

$\phi$가 알려져 있을 때, (4.17)은 자연 지수족에 대한 형태 (4.1)로 단순화된다.

$$ f(y _i; \theta _i) = a(\theta _i)b(y _i)\exp[y _i Q(\theta _i)] $$

우리는 여기서 $Q(\theta)$를 (4.17)의 $\theta/a(\phi)$로, $a(\theta)$를 (4.17)의 $\exp[-b(\theta)/a(\phi)]$로, 그리고 $b(y)$를 (4.17)의 $\exp[c(y, \phi)]$로 식별한다. 이항분포와 푸아송분포 같은 단일-모수 족에 대해서는 더 일반적인 공식 (4.17)이 필요하지 않다. 보통, $a(\phi)$는 알려진 가중치 $\omega _i$에 대해 $a(\phi) = \phi/\omega _i$ 형태를 갖는다. 예를 들어, $y _i$가 $n _i$번의 베르누이 시행에 대한 표본 비율과 같이 $n _i$개의 독립적인 측정값의 평균일 때, $\phi=1$이고 $\omega _i=n _i$이다 (4.4.3절).

### 4.4.2 확률 성분의 평균 및 분산 함수 (Mean and Variance Functions for the Random Component)

[원문 번역]

$E(Y _i)$와 $\text{var}(Y _i)$에 대한 표현식은 (4.17)의 항들을 사용한다. $L _i = \log f(y _i; \theta _i, \phi)$를 로그우도에 대한 $y _i$의 기여분이라고 하자. 그러면 로그우도 함수는 $L=\sum _i L _i$이다. (4.17)로부터,

$$ L _i = [y _i\theta _i - b(\theta _i)]/a(\phi) + c(y _i, \phi) \quad (4.18) $$

따라서,

$$ \partial L _i / \partial \theta _i = [y _i - b'(\theta _i)]/a(\phi), \quad \partial^2 L _i / \partial \theta _i^2 = -b''(\theta _i)/a(\phi) $$

여기서 $b'(\theta _i)$와 $b''(\theta _i)$는 $b(\cdot)$의 첫 번째와 두 번째 도함수를 $\theta _i$에서 계산한 것을 나타낸다. 이제 우리는 일반적인 우도 결과를 적용한다.

$$ E\left(\frac{\partial L}{\partial \theta}\right)=0 \quad \text{그리고} \quad -E\left(\frac{\partial^2 L}{\partial \theta^2}\right) = E\left[\left(\frac{\partial L}{\partial \theta}\right)^2\right] $$

이 식들은 지수족이 만족하는 정규성 조건 하에서 성립한다 (Cox and Hinkley 1974, Sec. 4.8). 단일 관측치에 적용된 첫 번째 공식으로부터, $E[Y _i - b'(\theta _i)]/a(\phi)=0$, 즉

$$ \mu _i = E(Y _i) = b'(\theta _i) \quad (4.19) $$

이다. 두 번째 공식으로부터,

$$
\frac{b''(\theta_i)}{a(\phi)}
= E\left[\frac{Y_i - b'(\theta_i)}{a(\phi)}\right]^2
= \frac{\mathrm{Var}(Y_i)}{[a(\phi)]^2}
$$


이므로,

$$ \text{var}(Y _i) = b''(\theta _i)a(\phi) \quad (4.20) $$

이다. 요약하면, (4.17)의 함수 $b(\cdot)$는 $Y _i$의 모멘트(moments)를 결정한다. 이 함수는 누적생성함수(cumulant function)라고 불리는데, 이는 $a(\phi)=1$일 때 그것의 도함수들이 분포의 누적률(cumulants)을 산출하기 때문이다 (Jørgensen 1987).

### 4.4.3 푸아송 및 이항 GLM의 평균 및 분산 함수 (Mean and Variance Functions for Poisson and Binomial GLMs)

[원문 번역]

푸아송 및 이항 분포에 대한 평균과 분산 표현식을 설명한다. $Y _i$가 푸아송 분포일 때,

$$ f(y _i; \mu _i) = \frac{e^{-\mu _i}\mu _i^{y _i}}{y _i!} = \exp(y _i\log\mu _i - \mu _i - \log y _i!) $$

$$ = \exp[y _i\theta _i - \exp(\theta _i) - \log y _i!] $$

여기서 $\theta _i=\log\mu _i$이다. 이것은 $b(\theta _i)=\exp(\theta _i)$, $a(\phi)=1$, 그리고 $c(y _i, \phi)=-\log y _i!$를 갖는 지수 분산 형태 (4.17)를 갖는다. 자연 모수는 $\theta _i = \log\mu _i$이다. (4.19)와 (4.20)으로부터,

$$ E(Y _i) = b'(\theta _i) = \exp(\theta _i) = \mu _i $$

$$ \text{var}(Y _i) = b''(\theta _i) = \exp(\theta _i) = \mu _i $$

이다.

다음으로, $n _i Y _i$가 $\text{bin}(n _i, \pi _i)$ 분포를 따른다고 가정하자; 즉, 여기서 $y _i$는 성공 횟수(number)가 아닌 표본 비율(proportion)이므로, $E(Y _i)=\pi _i$는 $n _i$에 의존하지 않는다. $\theta _i=\log[\pi _i/(1-\pi _i)]$라고 하자. ... (4.3)을 확장하면, 우리는 다음 결과를 얻는다.

$$ f(y _i; \pi _i, n _i) = \exp\left[ \frac{y _i\theta _i - \log[1+\exp(\theta _i)]}{1/n _i} + \log\binom{n _i}{n _i y _i} \right] \quad (4.21) $$

이것은 $b(\theta _i)=\log[1+\exp(\theta _i)]$, $a(\phi)=1/n _i$, 그리고 $c(y _i, \phi)=\log\binom{n _i}{n _i y _i}$를 갖는 지수 분산 형태 (4.17)를 갖는다. 자연 모수는 로짓, $\theta _i=\log[\pi _i/(1-\pi _i)]$이다. (4.19)와 (4.20)으로부터,

$$ E(Y _i) = b'(\theta _i) = \exp(\theta _i)/[1+\exp(\theta _i)] = \pi _i $$

$$ \text{var}(Y _i) = b''(\theta _i)a(\phi) = \exp(\theta _i)/\{[1+\exp(\theta _i)]^2 n _i\} = \pi _i(1-\pi _i)/n _i $$

이다.

---

### 핵심 내용 해설: GLM의 수학적 심장

이 섹션들은 GLM이 왜 그렇게 다양한 분포를 하나의 통일된 이론으로 다룰 수 있는지에 대한 수학적 기초, 즉 지수 분산족(Exponential Dispersion Family, EDF)을 설명합니다.

#### 4.4.1: 분포들의 통일된 표현, EDF

*   아이디어: 겉보기에는 달라 보이는 정규분포, 이항분포, 푸아송분포, 감마분포 등의 확률밀도(질량)함수들은 사실 모두 다음과 같은 단 하나의 일반적인 형태로 다시 쓸 수 있다.

$$
f(y; \theta, \phi)
= \exp\left( \frac{y\theta - b(\theta)}{a(\phi)} + c(y, \phi) \right)
$$


*   구성 요소: 어떤 분포든 이 형태로 표현하려면, 그 분포에 맞는 네 가지 "부품"($\theta, b(\theta), a(\phi), c(y,\phi)$)을 찾아내기만 하면 됩니다.
    *   $\theta$ (자연 모수): 분포의 평균과 직접적으로 관련되며, 선형 예측자와 연결되는 대상.
    *   $\phi$ (분산 모수): 분포의 분산을 조절하는 역할. 푸아송, 이항분포에서는 $\phi=1$로 알려져 있지만, 정규분포에서는 분산 $\sigma^2$이 미지의 $\phi$가 됩니다.
    *   $b(\theta)$ (누적생성함수): 이 함수의 도함수들이 분포의 평균과 분산을 결정하는 핵심적인 역할을 합니다.
    *   $a(\phi), c(y,\phi)$: 나머지 부분. $a(\phi)$는 종종 가중치(weights)와 관련됩니다.

#### 4.4.2: 평균과 분산을 생성하는 마법의 함수, $b(\theta)$

*   핵심 결과: 어떤 분포가 EDF 형태를 만족하기만 하면, 그 분포의 평균과 분산은 복잡한 적분이나 합산을 할 필요 없이, 함수 $b(\theta)$를 미분하는 것만으로 간단하게 얻을 수 있다.
    *   평균: $$ E(Y) = \mu = b'(\theta) \quad (\text{b를 한 번 미분}) $$
    *   분산: $$ \text{Var}(Y) = b''(\theta)a(\phi) \quad (\text{b를 두 번 미분} \times a(\phi)) $$
*   이것이 왜 중요한가?: 이 관계는 GLM을 적합시키는 알고리즘(예: 피셔 스코어링)이 모든 EDF 분포에 대해 동일한 방식으로 작동할 수 있게 하는 이론적 기반이 됩니다. 소프트웨어는 단지 각 분포에 대한 $b(\theta)$와 $a(\phi)$ 함수만 알면, 평균, 분산, 우도 방정식을 자동으로 유도할 수 있습니다.

#### 4.4.3: 실제 예시 - 푸아송과 이항

이 섹션은 푸아송과 이항 분포가 실제로 EDF 형태를 만족하는지, 그리고 $b(\theta)$ 함수로부터 우리가 이미 알고 있는 평균과 분산 공식이 정말로 나오는지를 보여줍니다.

1. 푸아송 분포 ($\mu$)
*   EDF 형태로 변환: $f(y;\mu) = \frac{e^{-\mu}\mu^y}{y!} = \exp[y\log\mu - \mu - \log y!]$
*   부품 식별:
    *   $\theta = \log\mu$ (자연 모수는 로그 평균)
    *   $\mu = e^\theta \implies b(\theta) = e^\theta$
    *   $a(\phi)=1, c(y,\phi)=-\log y!$
*   평균/분산 유도:
    *   $E(Y) = b'(\theta) = \frac{d}{d\theta}(e^\theta) = e^\theta = \mu$. (성공!)
    *   $\text{Var}(Y) = b''(\theta)a(\phi) = \frac{d^2}{d\theta^2}(e^\theta) \times 1 = e^\theta = \mu$. (성공!)

2. 이항 분포 ($\pi$) (여기서는 반응 변수가 비율 $y/n$이라고 가정)
*   EDF 형태로 변환: (본문의 수식 (4.21) 참조)
*   부품 식별:
    *   $\theta = \log(\frac{\pi}{1-\pi})$ (자연 모수는 로짓)
    *   $\pi = \frac{e^\theta}{1+e^\theta} \implies b(\theta) = \log(1+e^\theta)$
    *   $a(\phi)=1/n$
*   평균/분산 유도:
    *   $E(Y) = b'(\theta) = \frac{d}{d\theta}\log(1+e^\theta) = \frac{e^\theta}{1+e^\theta} = \pi$. (성공!)
    *   $\text{Var}(Y) = b''(\theta)a(\phi) = \frac{e^\theta}{(1+e^\theta)^2} \times \frac{1}{n} = \pi(1-\pi)/n$. (성공!)

결론: 이 섹션들은 GLM이 단순한 회귀분석의 확장이 아니라, 지수 분산족이라는 강력하고 통일된 수학적 구조에 기반하고 있음을 보여줍니다. 이 구조 덕분에 다양한 확률 분포를 동일한 원리(우도 방정식)와 동일한 알고리즘으로 다룰 수 있는 것입니다. 함수 $b(\theta)$는 이 모든 것을 가능하게 하는 GLM의 "숨겨진 엔진"과 같습니다.
