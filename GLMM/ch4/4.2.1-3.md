### 4.2.1 선형 확률 모델 (Linear Probability Model)

[원문 번역]

이항 반응 변수에 대해, 회귀 모델

$$ \pi(\mathbf{x}) = \alpha + \beta _1 x _1 + \dots + \beta _p x _p \quad (4.5) $$

는 선형 확률 모델(linear probability model)이라고 불린다. 독립적인 관측치들과 함께, 이것은 이항 확률 성분과 항등 연결 함수를 갖는 GLM이다.

이 모델은 중대한 구조적 결함을 가지고 있다: 확률은 0과 1 사이에 있어야 하지만, 선형 함수는 전체 실수선에 걸쳐 값을 취한다. 모델 (4.5)는 어떤 $\mathbf{x}$ 값들에 대해 $\pi(\mathbf{x}) < 0$ 그리고/또는 $\pi(\mathbf{x}) > 1$을 가질 수 있다. 이 모델은 제한된 범위의 $\mathbf{x}$ 값들에 대해서는 유효할 수 있다. 그것이 타당할 때, 장점은 간단한 해석에 있다: $\beta _j$는 $x _j$가 한 단위 증가할 때 $\pi(\mathbf{x})$의 변화량이다.

이 모델과 다른 GLM들에 대한 ML 모델 적합의 기술적인 세부 사항은 4.6절로 미룬다. $\text{var}(Y) = \pi(\mathbf{x})[1-\pi(\mathbf{x})]$이므로, 분산은 $\mathbf{x}$가 $\pi(\mathbf{x})$에 미치는 영향을 통해 $\mathbf{x}$에 의존한다. 보통의 최소제곱 추정량을 최적(즉, 선형 비편향 추정량 클래스에서 최소 분산)으로 만드는 등분산 조건은 만족되지 않으므로, ML 추정량은 최소제곱 추정량보다 더 효율적이다. 하지만, ML과 최소제곱에 대한 추정치와 표준오차는 보통, 표본 $\mathbf{x}$ 값들에 대한 $\pi(\mathbf{x})$가 분산이 상대적으로 안정적인 범위, 대략 0.3에서 0.7 내에 있을 때 유사하다.

### 4.2.2 예제: 코골이와 심장 질환 (Example: Snoring and Heart Disease)

[원문 번역]

우리는 코골이를 심장 질환의 위험 요인으로 조사하기 위한 역학 조사에서 가져온 표 4.2를 이용하여 선형 확률 모델을 설명한다. 표본은 다른 사회경제적 계층과 인종 그룹에 속하는 토론토의 네 곳의 가정의학과를 방문한 2484명의 피험자로 구성된다. 조사 대상자들은 배우자의 보고에 따른 코골이 정도와, 심장 질환을 앓고 있다고 보고했는지 여부에 따라 분류되었다. 모델은 심장 질환의 확률이 코골이 수준 $x$에 선형적으로 관련되어 있다고 말한다. 우리는 표의 행들을 독립적인 이항 표본으로 취급한다. $x$의 범주에 대한 명백한 점수 선택은 존재하지 않는다. 우리는 (0, 2, 4, 5)를 사용했으며, 마지막 두 수준을 다른 인접 쌍들보다 더 가깝게 취급했다.

소프트웨어는 ML 적합 결과로 $\hat{\pi}(x)=0.0172+0.0198x$를 보고하며, $\hat{\beta}=0.0198$은 SE=0.0028을 갖는다. 코를 골지 않는 사람($x=0$)에 대해, 심장 질환을 앓는 피험자의 추정된 비율은 0.0172이다. 우리는 GLM에 대한 $E(Y)$의 추정된 값들을 적합치(fitted values)라고 부른다. 표 4.2는 이 모델에 대한 표본 비율과 적합치를 보여준다. 그림 4.1은 표본과 적합치를 그래프로 보여준다. 표와 그래프는 모델이 잘 맞는다는 것을 시사한다. (5.2.3절에서 우리는 이항-반응 GLM에 대한 공식적인 적합도 분석을 제시한다.) 모델 해석은 간단하다. 심장 질환의 추정된 확률은 코를 골지 않는 사람에게는 약 0.02이다; 가끔 코를 고는 사람에게는 $2(0.0198)=0.04$만큼 증가하고, 거의 매일 밤 코를 고는 사람에게는 또 다른 0.04만큼, 그리고 항상 코를 고는 사람에게는 또 다른 0.02만큼 증가한다. 이 연구는 관찰 연구였으며, 이 연관성이 수면 무호흡증과 같은 어떤 교란 요인이나 의학적 상태 때문일 수 있는지는 불분명하다.

### 4.2.3 로지스틱 회귀 모델 (Logistic Regression Model)

[원문 번역]

보통, 이항 데이터는 $\pi(x)$와 $x$ 사이의 비선형적(nonlinear) 관계로부터 발생한다. $x$의 고정된 변화는 $\pi(x)$가 0 또는 1에 가까울 때보다 0.50에 가까울 때 종종 더 큰 영향을 미친다. 자동차 구매 시, 신차와 중고차 사이의 선택을 고려해보자. $\pi(x)$를 연간 가계 소득=$x$일 때 신차를 선택할 확률이라고 하자. 소득이 1만 달러 증가하는 것은 $x=\$1,000,000$일 때[이때 $\pi(x)$는 1에 가까움]보다 $x=\$50,000$일 때 더 큰 효과를 가질 것이다.

실제 분석에서, $\pi(x)$와 $x$ 사이의 비선형 관계는 종종 단조적이며, $x$가 증가함에 따라 $\pi(x)$가 계속 증가하거나 계속 감소한다. 그림 4.2의 S자형 곡선(S-shaped curves)이 전형적이다. 이 모양을 가진 가장 중요한 곡선은 다음의 모델 공식을 갖는다.

$$ \pi(x) = \frac{\exp(\alpha + \beta x)}{1 + \exp(\alpha + \beta x)} \quad (4.6) $$

이것이 로지스틱 회귀 모델(logistic regression model)이다. $x$가 증가함에 따라, $\pi(x)$는 $\beta>0$일 때 증가하고 $\beta<0$일 때 감소한다.

로지스틱 회귀가 GLM이 되는 연결 함수를 찾아보자. 다중 예측 변수로 확장된 (4.6)에 대해, 오즈는

$$ \frac{\pi(\mathbf{x})}{1-\pi(\mathbf{x})} = \exp(\alpha + \beta _1 x _1 + \dots + \beta _p x _p) $$

이다. 로그 오즈는 다음과 같은 선형 관계를 갖는다.

$$ \log\left(\frac{\pi(\mathbf{x})}{1-\pi(\mathbf{x})}\right) = \alpha + \beta _1 x _1 + \dots + \beta _p x _p \quad (4.7) $$

따라서, 적절한 연결은 로그 오즈 변환, 즉 로짓(logit)이다. 로지스틱 회귀 모델은 이항 확률 성분과 로짓 연결 함수를 갖는 GLM이다.

---

### 핵심 내용 해설: 확률을 어떻게 선형으로 모델링할 것인가?

이 섹션들은 "성공/실패"와 같은 이항 반응의 확률($\pi$)을 설명 변수($x$)로 모델링하는 두 가지 접근법을 비교합니다.

#### 4.2.1 & 4.2.2: 가장 단순한 접근법, 선형 확률 모델 (LPM)

*   아이디어: 가장 간단하게, 확률 $\pi$가 $x$에 대한 직선 관계를 가질 것이라고 가정한다.

$$ \pi(x) = \alpha + \beta x $$

*   GLM 관점:
    *   확률 성분: 이항 분포
    *   연결 함수: 항등 연결(Identity Link) ($g(\mu)=\mu$)
*   장점 (유일한 장점): 해석이 매우 쉽다.
    *   코골이 예제: $\hat{\pi}(x) = 0.0172 + 0.0198x$.
    *   해석: "코골이 점수($x$)가 1점 증가할 때마다, 심장 질환 확률($\pi$)은 0.0198 (1.98%p)만큼 증가한다." 매우 직관적이다.
*   치명적인 단점 (구조적 결함):
    1.  비논리적인 예측: 직선은 끝없이 뻗어 나가므로, $x$ 값이 너무 크거나 작으면 모델이 예측하는 확률 $\hat{\pi}(x)$가 1보다 커지거나 0보다 작아질 수 있다. 이는 확률의 정의에 위배된다.
    2.  이분산성(Heteroscedasticity): 이항 데이터의 분산은 $\pi(1-\pi)$로, 평균 $\pi$에 따라 변한다. 이는 OLS 회귀분석의 등분산 가정을 위반한다. (ML 추정은 이 문제를 해결해주지만, 1번 문제는 여전하다.)

결론: LPM은 해석이 간편하여 경제학 등 일부 분야에서 사용되지만, 이론적 결함 때문에 대부분의 통계학자들은 사용을 권장하지 않습니다.

#### 4.2.3: 표준적인 접근법, 로지스틱 회귀 모델

*   아이디어: 확률이 0과 1 사이의 값을 가져야 한다는 제약을 만족시키기 위해, 직선이 아닌 S자형 곡선을 사용한다.
*   핵심 통찰: 확률 $\pi$ 자체를 $x$의 선형 함수로 모델링하는 대신, $\pi$를 변환하여 $(-\infty, \infty)$ 범위를 갖는 어떤 양을 $x$의 선형 함수로 모델링하자!
*   로짓 변환: 이 목적에 가장 적합한 변환이 바로 로짓(logit), 즉 로그 오즈이다.
    *   $\pi$가 0에서 1로 변할 때, 오즈 $\frac{\pi}{1-\pi}$는 0에서 $\infty$로 변한다.
    *   로그 오즈 $\log(\frac{\pi}{1-\pi})$는 $-\infty$에서 $\infty$로 변한다.
*   로지스틱 회귀 모델:

$$ \log\left(\frac{\pi(x)}{1-\pi(x)}\right) = \alpha + \beta x $$

*   GLM 관점:
    *   확률 성분: 이항 분포
    *   연결 함수: 로짓 연결(Logit Link)
*   장점:
    1.  논리적인 예측: $x$값이 아무리 변해도, 예측된 확률 $\hat{\pi}(x)$는 항상 0과 1 사이에 머무른다.
    2.  현실적인 관계 묘사: 많은 실제 현상에서 "S자형" 관계가 나타난다. 즉, $x$의 변화에 대한 효과는 중간(확률이 0.5 근처)에서 가장 크고, 양 극단(확률이 0 또는 1 근처)에서는 둔화된다. 로지스틱 곡선은 이를 잘 표현한다.
*   단점: 해석이 LPM보다 덜 직관적이다. $\beta$는 더 이상 확률의 직접적인 변화량이 아니다. 대신 "x가 1단위 증가할 때, 로그 오즈가 $\beta$만큼 변한다" 또는 "오즈가 $e^\beta$ 배만큼 변한다"라고 해석해야 한다.

코골이 예제 비교 (그림 4.1):
그림 4.1을 보면, 데이터가 있는 좁은 범위 내에서는 직선(LPM)과 S자 곡선(로지스틱)이 거의 비슷하게 보인다. 이것이 코골이 예제에서 LPM이 꽤 잘 맞는 것처럼 보였던 이유이다. 하지만 $x$의 범위가 더 넓어졌다면, 두 모델의 예측은 크게 달라졌을 것이다.

종합 결론: 이항 데이터를 모델링할 때, 선형 확률 모델(LPM)은 심각한 이론적 결함이 있으므로, 특별한 이유가 없는 한 로지스틱 회귀 모델을 사용하는 것이 표준적이고 바람직한 접근법입니다.
