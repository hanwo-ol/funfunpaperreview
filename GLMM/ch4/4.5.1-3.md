### 4.5.1 이탈도와 적합도 (Deviance and Goodness of Fit)

[원문 번역]

4.1.5절로부터, 포화 GLM(saturated GLM)은 각 관측치에 대해 별도의 모수를 갖는다. 그것은 완벽한 적합을 제공한다. 이것은 좋은 소리처럼 들리지만, 유용한 모델은 아니다. 그것은 데이터를 매끄럽게 하지 않으며, 간결성(parsimony)과 같은, 더 단순한 모델이 갖는 장점들을 갖지 못한다. 그럼에도 불구하고, 그것은 모델 적합도를 검토하는 것과 같이, 다른 모델들을 위한 기준선 역할을 한다.

포화 모델은 모델의 시스템 성분에 의해 모든 변동을 설명한다. $\tilde{\theta}$를 포화 모델에 대한 $\theta$의 추정치라고 하자. 이는 모든 $i$에 대해 추정된 평균 $\tilde{\mu} _i=y _i$에 해당한다. 특정 불포화 모델에 대해, 대응하는 ML 추정치를 $\hat{\theta}$와 $\hat{\mu} _i$라고 하자. 그 모델에 대한 최대화된 로그우도 $L(\hat{\boldsymbol{\mu}}; \mathbf{y})$와 포화된 경우의 최대화된 로그우도 $L(\mathbf{y}; \mathbf{y})$에 대해,

$$ -2 \log \frac{\text{모델에 대한 최대 우도}}{\text{포화 모델에 대한 최대 우도}} = -2[L(\hat{\boldsymbol{\mu}}; \mathbf{y}) - L(\mathbf{y}; \mathbf{y})] $$

는 적합성 결여(lack of fit)를 기술한다. 이것은 현재 모델이 성립한다는 귀무가설을, 더 일반적인 모델이 성립한다는 대립가설에 대해 검정하는 우도비 통계량이다. (4.22)로부터,

$$ -2[L(\hat{\boldsymbol{\mu}};\mathbf{y}) - L(\mathbf{y};\mathbf{y})] = 2\sum _i \frac{y _i(\tilde{\theta} _i - \hat{\theta} _i) - [b(\tilde{\theta} _i)-b(\hat{\theta} _i)]}{a(\phi)} $$

(4.17)에서 $a(\phi)$가 $a(\phi)=\phi/\omega _i$ 형태를 가질 때, 이 통계량은 다음과 같다.

$$ 2\sum _i \omega _i \{y _i(\tilde{\theta} _i-\hat{\theta} _i) - [b(\tilde{\theta} _i)-b(\hat{\theta} _i)]\} / \phi = D(\mathbf{y};\hat{\boldsymbol{\mu}})/\phi \quad (4.33) $$

이것을 척도화된 이탈도(scaled deviance)라고 부르고 $D(\mathbf{y};\hat{\boldsymbol{\mu}})$를 이탈도(deviance)라고 부른다. 척도화된 이탈도가 클수록, 적합도는 더 나쁘다. 일부 GLM에 대해 척도화된 이탈도는 근사적으로 카이제곱 분포를 갖는다.

### 4.5.2 푸아송 GLM의 이탈도 (Deviance for Poisson GLMs)

[원문 번역]

푸아송 GLM에 대해, 4.4.3절에 의해, $\hat{\theta} _i = \log\hat{\mu} _i$이고 $b(\hat{\theta} _i)=\exp(\hat{\theta} _i)=\hat{\mu} _i$이다. 비슷하게, 포화 모델에 대해 $\tilde{\theta} _i=\log y _i$이고 $b(\tilde{\theta} _i)=y _i$이다. 또한 $a(\phi)=1$이므로, 이탈도와 척도화된 이탈도 (4.33)는 다음과 같다.

$$ D(\mathbf{y};\hat{\boldsymbol{\mu}}) = 2\sum _i [y _i \log(y _i/\hat{\mu} _i) - (y _i - \hat{\mu} _i)] \quad (4.34) $$

로그 연결을 사용하는 모델이 절편항을 포함할 때, 그 모수에 의해 암시되는 우도 방정식 (4.32)는 $\sum _i y _i = \sum _i \hat{\mu} _i$이다. 그러면 이탈도는 다음과 같이 단순화된다.

$$ D(\mathbf{y};\hat{\boldsymbol{\mu}}) = 2\sum _i y _i \log(y _i/\hat{\mu} _i) \quad (4.35) $$

이원 분할표에 대해, 셀 빈도 $n _{ij}$를 $y _i$로, 독립성 적합치 $\hat{\mu} _{ij}$를 $\hat{\mu} _i$로 대입하면, 이것은 3.2.1절의 $G^2$ 통계량 (3.11)으로 축소된다. 고정된 셀 수 $N$을 갖는 분할표에 적용된 푸아송 또는 다항 모델에 대해, 16.3절은 이탈도가 큰 $\{\mu _i\}$에 대해 근사적인 카이제곱 분포를 가짐을 보여준다.

### 4.5.3 이항 GLM의 이탈도: 그룹화 데이터 대 비그룹화 데이터 (Deviance for Binomial GLMs: Grouped Versus Ungrouped Data)

[원문 번역]

이제 $\{n _i\}$번의 시행에 기반한 표본 비율 $\{y _i\}$을 갖는 이항 GLM을 고려하자. 4.4.3절에 의해, $\hat{\theta} _i=\text{logit}(\hat{\pi} _i)$이고 $b(\hat{\theta} _i)=-\log(1-\hat{\pi} _i)$이다. 비슷하게, 포화 모델에 대해 $\tilde{\theta} _i=\text{logit}(y _i)$이고 $b(\tilde{\theta} _i)=-\log(1-y _i)$이다. 또한, $a(\phi)=1/n _i$이므로 $\phi=1$이고 $\omega _i=n _i$이다. 이탈도 (4.33)는 ... (수식 전개) ... 다음과 같다.

$$ D(\mathbf{y};\hat{\boldsymbol{\mu}}) = 2\sum _i [\text{관측} \times \log(\text{관측}/\text{적합})] \quad (4.36) $$

설정 $i$에서, $n _i y _i$는 성공 횟수이고 $(n _i-n _i y _i)$는 실패 횟수이다, $i=1,\dots,N$. 따라서, 이탈도는 성공과 실패의 $2N$개 셀에 대한 합이며, 절편항을 갖는 푸아송 로그선형 모델에 대한 이탈도 (4.35)와 동일한 형태를 갖는다.

이항 반응으로, 데이터 파일을 예측 변수의 각 설정에서의 성공 및 실패 카운트를 사용하여 표현된 대로 구성하거나, 피험자 수준에서 개별 베르누이 0 또는 1 관측치로 구성하는 것이 가능하다. 이탈도는 이 두 경우에 다르다. 첫 번째 경우 포화 모델은 예측 변수의 각 설정에 대해 모수를 갖는 반면, 두 번째 경우 그것은 각 피험자에 대해 모수를 갖는다. 우리는 이들을 그룹화 데이터(grouped data)와 비그룹화 데이터(ungrouped data) 경우라고 부른다. 이탈도에 대한 근사적인 카이제곱 분포는 그룹화 데이터에 대해서는 발생하지만, 비그룹화 데이터에 대해서는 그렇지 않다(연습문제 4.5, 4.18, 5.35 참조). 그룹화 데이터로, 표본 크기는 고정된 수의 예측 변수 설정에 대해 증가하고, 따라서 포화 모델에 대한 고정된 수의 모수에 대해 증가한다.

---

### 핵심 내용 해설

이 섹션들은 GLM의 적합도를 평가하는 가장 중요한 도구인 이탈도(Deviance)를 정의하고, 이것이 우리가 이미 알고 있는 $G^2$ 통계량과 어떻게 연결되는지를 보여줍니다.

#### 4.5.1: 잔차 제곱합(RSS)의 일반화, 이탈도

*   배경 (OLS 회귀): 일반 선형 회귀분석에서는 모델의 적합도를 잔차 제곱합(Residual Sum of Squares, RSS), 즉 $\sum(y _i - \hat{y} _i)^2$으로 평가합니다. RSS가 작을수록 모델이 데이터를 잘 설명합니다.
*   GLM의 문제: GLM에서는 등분산 가정이 없으므로, 단순한 잔차 제곱합은 적절한 척도가 아닙니다.
*   이탈도의 정의: 이탈도는 우도(likelihood)에 기반한 적합도 척도입니다.

$$ D = 2 \times [\text{포화 모델의 로그우도} - \text{내가 만든 모델의 로그우도}] $$

*   해석: "내 모델이 데이터를 설명하는 능력이, 데이터를 완벽하게 설명하는 이론상의 최고 모델(포화 모델)에 비해 얼마나 떨어지는가?"
    *   이탈도는 항상 0 이상이며, 값이 작을수록 모델이 데이터에 더 잘 맞는 것을 의미합니다. (RSS와 유사한 역할)

#### 4.5.2: 푸아송 이탈도 = $G^2$

*   푸아송 GLM의 이탈도 공식: (4.34)와 (4.35)는 푸아송 모델에 대한 일반 이탈도 공식을 대입하고 정리한 결과입니다.
*   핵심 결과 (4.35): 만약 모델에 절편항이 포함되어 있다면 (대부분의 경우), 이탈도는 매우 친숙한 형태로 단순화됩니다.

$$ D = 2\sum _i y _i \log(y _i/\hat{\mu} _i) = 2 \sum (\text{관측값}) \log\left(\frac{\text{관측값}}{\text{적합값}}\right) $$

*   이것이 바로 $G^2$이다!: 이 공식은 우리가 3장에서 배운 우도비 카이제곱 통계량($G^2$)의 공식과 정확히 일치합니다.
    *   의미: 분할표의 독립성 모델에 대한 $G^2$ 통계량은, 사실 "독립성 모델의 이탈도"였던 것입니다. 즉, (독립성 모델)과 (포화 모델)을 비교하는 우도비 검정 통계량입니다.

#### 4.5.3: 이항 이탈도와 그룹화 데이터의 중요성

*   이항 GLM의 이탈도 공식 (4.36): 푸아송과 마찬가지로, 이항 GLM의 이탈도 역시 동일한 $2\sum \text{관측} \log(\frac{\text{관측}}{\text{적합}})$ 형태를 가집니다. 단, 여기서 합산은 '성공' 셀과 '실패' 셀 모두에 대해 이루어집니다.

*   그룹화(Grouped) vs. 비그룹화(Ungrouped) 데이터 - 매우 중요한 구분!
    *   상황: 설명 변수들이 모두 범주형인 경우. (예: 성별(남/여), 연령대(청년/중년/노년)가 성공/실패에 미치는 영향)
        *   비그룹화 데이터 (Ungrouped data): 데이터 파일이 각 개인별로 한 줄씩 입력됨. (N=1000명이면 1000줄)
            *   포화 모델: 각 개인마다 별도의 모수를 가짐. 모수 개수 = $N$.
            *   이탈도 분포: $N \to \infty$가 되면 포화 모델의 모수 개수도 무한히 늘어나므로, 이탈도는 카이제곱 분포를 따르지 않습니다. 따라서 적합도 검정 통계량으로 쓸 수 없습니다.
        *   그룹화 데이터 (Grouped data): 설명 변수 조합이 동일한 사람들의 데이터를 요약하여 입력. (예: 남성-청년: 100명 중 30명 성공, 남성-중년: 150명 중 80명 성공, ...)
            *   이 경우, 각 '그룹'(설명 변수 조합)이 하나의 관측 단위가 됩니다.
            *   포화 모델: 각 그룹마다 별도의 성공 확률 모수를 가짐. 모수 개수 = 그룹의 개수.
            *   이탈도 분포: 그룹의 개수($N$)는 고정된 채로 각 그룹의 표본 크기($n _i$)가 커지면, 이탈도는 근사적으로 카이제곱 분포를 따릅니다. 따라서 적합도 검정 통계량으로 쓸 수 있습니다.

결론:
1.  이탈도는 OLS의 RSS를 GLM으로 일반화한 핵심적인 적합도 척도입니다.
2.  푸아송 및 이항 모델에서 이탈도는 $G^2$ 통계량과 동일한 형태($2\sum \text{관측} \log(\frac{\text{관측}}{\text{적합}})$)를 가집니다.
3.  이탈도를 모델 전체의 적합도 검정(Goodness-of-Fit Test) 통계량으로 사용하려면, 그 분포가 카이제곱 분포를 따라야 합니다.
4.  이 카이제곱 근사는 그룹화된(grouped) 데이터에 대해서는 잘 작동하지만, 개인별 데이터(ungrouped)에서는 성립하지 않으므로 적합도 검정에 사용할 수 없습니다. 이는 이항/로지스틱 회귀 분석에서 매우 중요한 실용적인 지침입니다.
