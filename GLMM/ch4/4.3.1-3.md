### 4.3.1 푸아송 로그선형 모델 (Poisson Loglinear Models)

[원문 번역]

푸아송 분포 (1.4)는 양의 평균 $\mu$를 갖는다. 비록 GLM이 항등 연결을 사용하여 양의 평균을 모델링할 수 있지만, 평균의 로그를 모델링하는 것이 더 흔하다. 선형 예측자와 마찬가지로, 로그 평균은 어떤 실수 값이든 가질 수 있다. 로그 평균은 푸아송 분포의 자연 모수이며, 로그 연결은 푸아송 GLM의 정준 연결이다. 푸아송 로그선형 GLM(Poisson loglinear GLM)은 Y에 대해 푸아송 분포를 가정하고 로그 연결을 사용한다.

설명 변수 $\mathbf{x}$를 갖는 푸아송 로그선형 모델은 다음과 같다.

$$ \log \mu(\mathbf{x}) = \alpha + \beta _1 x _1 + \dots + \beta _p x _p. \quad (4.11) $$

이 모델에 대해, 평균은 다음과 같은 지수 관계를 만족한다.

$$ \mu(\mathbf{x}) = \exp(\alpha + \beta _1 x _1 + \dots + \beta _p x _p) = e^\alpha (e^{\beta _1})^{x _1} \dots (e^{\beta _p})^{x _p}. \quad (4.12) $$

$x _j$에서의 1-단위 증가는 $e^{\beta _j}$의 곱셈 효과(multiplicative impact)를 갖는다: $x _j+1$에서의 평균은 $x _j$에서의 평균에 $e^{\beta _j}$를 곱한 것과 같다.

### 4.3.2 예제: 투구게의 짝짓기 (Example: Horseshoe Crab Mating)

[원문 번역]

우리는 멕시코만의 한 섬에 사는 암컷 투구게에 대한 연구를 사용하여 푸아송 GLM을 설명한다. 산란기 동안, 암컷들은 번식을 위해 해변으로 이동하며, 수컷 한 마리가 그녀의 후방 가시에 붙어 있고, 그녀는 모래 속으로 파고 들어가 알 덩어리를 낳는다. 산란 동안, 다른 수컷 게들이 그 쌍 주위에 모여들 수 있으며 그 알들을 수정할 수도 있다. 암컷 게 주위에 모이는 이 수컷 게들을 위성(satellites)이라고 부른다.

이 예제에서, 173마리의 각 암컷 게에 대한 반응 결과는 그녀의 위성 수이다. 설명 변수는 암컷 게의 색깔, 가시 상태, 무게, 그리고 등딱지 너비이다. 표 4.3은 데이터의 작은 일부를 보여준다. 전체 데이터는 교재 웹사이트 www.stat.ufl.edu/~aa/cda/cda.html 에서 이용 가능하다. 지금은, 너비만을 예측 변수로 사용한다. 표 4.3은 너비를 센티미터 단위로 나열한다. 표본 평균 너비는 26.3이고 표준편차는 2.1이다.

그림 4.3은 각 지점의 관측치 수를 나타내는 숫자 기호와 함께, 너비에 대한 위성의 반응 카운트를 플롯한 것이다. 상당한 변동성 때문에 명확한 추세를 식별하기 어렵다. 더 명확한 그림을 얻기 위해, 우리는 암컷 게들을 너비 범주로 그룹화하고 각 범주 내 암컷 게들의 표본 평균 위성 수를 계산했다. 그림 4.4는 각 범주 내 게들의 표본 평균 너비에 대해 이 표본 평균들을 플롯한 것이다. ... (중략) ... 추세는 거의 선형으로 보이며, 우리는 평균 또는 평균의 로그가 너비에 선형인 비그룹화 데이터에 대한 다음 모델들을 논의한다.

암컷 게에 대해, $\mu(x)$를 너비 $x$에서의 기대 위성 수라고 하자. 교재 웹사이트의 부록에 나와 있는 GLM 소프트웨어로부터, 푸아송 로그선형 모델 (4.11)의 ML 적합은 다음과 같다.

$$ \log \hat{\mu}(x) = \hat{\alpha} + \hat{\beta}x = -3.305 + 0.164x. $$

너비의 효과 $\hat{\beta}=0.164$는 양수이며, SE=0.020이다. 너비 수준 $x$에서의 모델 적합치는 추정된 평균 위성 수 $\hat{\mu}(x)$이다. 예를 들어, 평균 너비 $x=26.3$에서의 적합치는

$$ \hat{\mu}(x) = \exp(\hat{\alpha}+\hat{\beta}x) = \exp[-3.305+0.164(26.3)] = 2.74. $$

이 모델에 대해, $\exp(\hat{\beta}) = \exp(0.164) = 1.18$은 $x$가 1-cm 증가할 때 $\hat{\mu}(x)$에 대한 곱셈 효과이다. 예를 들어, $x=27.3=26.3+1$에서의 적합치는 $\exp[-3.305+0.164(27.3)] = 3.23$이며, 이는 $1.18 \times 2.74$와 같다. 너비가 1-cm 증가하면 추정된 평균이 18% 증가한다.

### 4.3.3 푸아송 GLM의 과대산포 (Overdispersion for Poisson GLMs)

[원문 번역]

1.2.4절에서 우리는 카운트 데이터가 종종 푸아송 분포가 허용하는 것보다 더 큰 변동성을 보인다는 점을 언급했다. 그룹화된 투구게 데이터에 대해, 표 4.4는 각 너비 범주 내 암컷 게들의 위성 수 카운트에 대한 표본 평균과 분산을 보여준다. 분산은 평균보다 훨씬 더 크지만, 푸아송 분포는 동일한 평균과 분산을 갖는다. GLM 확률 성분이 예측하는 것보다 더 큰 변동성은 과대산포(overdispersion)를 반영한다.

과대산포의 흔한 원인은 개체 이질성(subject heterogeneity)이다. 예를 들어, 너비, 무게, 색깔, 가시 상태가 암컷 게의 위성 수에 영향을 미치는 네 가지 예측 변수라고 가정하자. Y가 그 예측 변수들의 각 고정된 조합에서 푸아송 분포를 갖는다고 가정하자. 우리 모델은 너비만을 예측 변수로 사용한다. 특정 너비를 갖는 게들은 그러면 다양한 무게, 색깔, 가시 상태를 가진 게들의 혼합이다. 따라서, 그 너비를 가진 게 집단은 각기 다른 반응 평균을 갖는 여러 푸아송 모집단의 혼합이다. 이 이질성은 그 너비에서의 전체 반응 분포가 푸아송이 예측하는 것보다 더 큰 분산을 갖는 결과를 낳는다. 만약 모든 관련 변수가 통제될 때 분산이 평균과 같다면, 오직 하나만 통제될 때는 분산이 평균을 초과한다.

---

### 핵심 내용 해설

#### 4.3.1: 카운트 데이터를 위한 표준 모델

*   문제: 반응 변수가 0, 1, 2, ... 와 같은 카운트(발생 횟수)일 때, 어떤 모델을 사용해야 하는가?
*   해결책: 푸아송 GLM. 이는 두 가지 핵심 아이디어에 기반한다.
    1.  확률 성분: 카운트 데이터는 푸아송 분포를 따른다고 가정한다. 푸아송 분포는 평균 $\mu$라는 단 하나의 모수로 결정된다.
    2.  연결 함수: 평균 $\mu$는 항상 0보다 커야 하지만, 선형 예측자 $\eta$는 어떤 값이든 가질 수 있다. 이 둘을 연결하기 위해, $\mu$에 로그(log)를 취한다. $\log(\mu)$의 범위는 $(-\infty, \infty)$이므로 $\eta$와 직접 연결할 수 있다.
*   푸아송 로그선형 모델:

$$ \log(\mu) = \beta _0 + \beta _1 x _1 + \dots $$

*   해석의 전환: 이 모델은 가법적(additive) 모델이 아니라 승법적(multiplicative) 모델이다.

$$ \mu = \exp(\beta _0 + \beta _1 x _1 + \dots) = e^{\beta _0}(e^{\beta _1})^{x _1} \dots $$

*   $\beta _j$의 해석: $x _j$가 1단위 증가할 때, 평균 $\mu$는 $e^{\beta _j}$ 배만큼 변한다. (더 이상 $\beta _j$만큼 더해지는 것이 아니다.)
*   $e^{\beta _j}$를 Rate Ratio 라고도 부른다.

#### 4.3.2: 너비가 클수록 매력적인가?

이 예제는 푸아송 로그선형 모델의 적용과 해석을 보여준다.
*   모델: $\log \hat{\mu}(x) = -3.305 + 0.164x$
*   $\beta$의 해석: $\hat{\beta}=0.164 > 0$ 이므로, 너비($x$)가 클수록 평균 위성 수($\mu$)가 증가하는 양의 관계가 있다.
*   Rate Ratio 해석: $e^{\hat{\beta}} = e^{0.164} = 1.18$.
    *   "등딱지 너비가 1cm 증가할 때마다, 암컷 게가 끌어들이는 평균 위성 수는 약 1.18배, 즉 18%씩 증가한다."

#### 4.3.3: 푸아송 모델의 아킬레스건, "과대산포"

*   푸아송 분포의 핵심 가정: 평균 = 분산 ($\mu = \sigma^2$)
*   문제점: 실제 세상의 카운트 데이터는 이 가정을 위반하는 경우가 매우 많다. 대부분 분산이 평균보다 훨씬 더 크다. 이를 과대산포(Overdispersion)라고 한다.
*   투구게 데이터 (표 4.4):
    *   너비 25.25-26.25 그룹: 평균=2.69, 분산=11.38
    *   너비 28.25-29.25 그룹: 평균=3.94, 분산=16.88
    *   모든 그룹에서 분산이 평균보다 현저하게 크다. 이는 푸아송 가정이 잘못되었다는 강력한 증거이다.
*   과대산포의 원인:
    1.  개체 이질성 (가장 흔한 원인): 본문에서 설명한 것처럼, 우리가 통제하지 못한 다른 중요한 변수들(무게, 색깔 등)이 존재하기 때문이다. 같은 너비($x$)를 가진 게들이라도, 무게나 색깔이 다르면 위성을 끌어들이는 능력이 다를 것이다. 이처럼 서로 다른 평균($\mu$)을 가진 여러 푸아송 분포가 섞여있는 것처럼 보이게 되고, 이 혼합된 분포의 전체 분산은 평균보다 커지게 된다.
    2.  군집화(Clustering)/상관관계: 사건들이 서로 독립적으로 발생하지 않고 떼로 몰려다니는 경향이 있을 때 발생한다.
*   과대산포의 결과:
    *   모델의 회귀 계수 추정치($\hat{\beta}$) 자체는 여전히 괜찮다 (일치성, consistent).
    *   하지만, 모델이 데이터의 실제 변동성을 과소평가하기 때문에 표준오차(SE)가 너무 작게 추정된다.
    *   결과적으로 P-값이 너무 작아지고 신뢰구간은 너무 좁아져, 실제로는 유의미하지 않은 효과를 유의미하다고 잘못 결론 내릴(1종 오류) 위험이 커진다.

결론: 푸아송 모델을 사용할 때는 반드시 과대산포를 확인해야 한다. 만약 과대산포가 존재한다면, 푸아송 모델은 부적절하며, 이를 해결하기 위한 대안 모델(예: 음이항 모델(Negative Binomial Model), 4.3.4절)이나 유사우도(Quasi-likelihood) 접근법을 사용해야 한다.
