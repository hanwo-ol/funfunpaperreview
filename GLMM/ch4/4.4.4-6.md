### **4.4.4 GLM의 시스템적 요소와 연결 함수 (Systematic Component and Link Function of a GLM)**

**[원문 번역]**

관측치 $i$에 대해, GLM의 시스템 성분은 모수 $\{\eta_i\}$를 선형 예측자를 사용하여 설명 변수들과 관련시킨다.

$$ \eta_i = \sum_j \beta_j x_{ij}, \quad i=1, \dots, N. $$

행렬 형태로,

$$ \boldsymbol{\eta} = \mathbf{X}\boldsymbol{\beta} $$

여기서 $\boldsymbol{\eta}=(\eta_1, \dots, \eta_N)^T$ 이고 $\boldsymbol{\beta}=(\beta_0, \beta_1, \beta_2, \dots)^T$는 모델 모수들의 열 벡터이다. $\boldsymbol{\beta}$에 $p$개의 모수가 있을 때, $\mathbf{X}$는 $N$명의 피험자에 대한 설명 변수 값들의 $N \times p$ 행렬이다. 일반적인 선형 모델에서, $\mathbf{X}$는 설계 행렬(design matrix)이라고 불린다. 하지만 그것이 실험 설계를 지칭할 필요는 없으며, GLM 문헌에서는 그것을 **모델 행렬(model matrix)**이라고 부른다.

GLM은 $g(\cdot)$라는 연결 함수에 의해 $\eta_i$를 $\mu_i=E(Y_i)$에 연결한다. 따라서, $\mu_i$는 다음과 같이 설명 변수들과 관련된다.

$$ \eta_i = g(\mu_i) = \sum_j \beta_j x_{ij}, \quad i=1, \dots, N. $$

(4.17)에서 $g(\mu_i)=\theta_i$인 연결 함수 $g$는 **정준 연결(canonical link)**이다. 그 경우, 자연 모수와 선형 예측자 사이에 다음과 같은 직접적인 관계가

$$ \theta_i = \sum_j \beta_j x_{ij} $$

발생한다.

### **4.4.5 GLM의 우도 방정식 (Likelihood Equations for a GLM)**

**[원문 번역]**

$N$개의 독립적인 관측치에 대해, (4.18)로부터 로그우도는 다음과 같다.

$$ L(\boldsymbol{\beta}) = \sum_i L_i = \sum_i \log f(y_i; \theta_i, \phi) = \sum_i \frac{y_i\theta_i - b(\theta_i)}{a(\phi)} + \sum_i c(y_i, \phi) \quad (4.22) $$

$L(\boldsymbol{\beta})$라는 표기법은 $\theta$가 모델 모수 $\boldsymbol{\beta}$에 의존함을 반영한다. 우도 방정식은 모든 $j$에 대해

$$ \partial L(\boldsymbol{\beta}) / \partial \beta_j = \sum_i \partial L_i / \partial \beta_j = 0 $$

이다. 로그우도 (4.22)를 미분하기 위해, 우리는 연쇄 법칙(chain rule)을 사용한다.

$$ \frac{\partial L_i}{\partial \beta_j} = \frac{\partial L_i}{\partial \theta_i} \frac{\partial \theta_i}{\partial \mu_i} \frac{\partial \mu_i}{\partial \eta_i} \frac{\partial \eta_i}{\partial \beta_j} \quad (4.23) $$

$\partial L_i / \partial \theta_i = [y_i - b'(\theta_i)]/a(\phi)$ 이고, (4.19)와 (4.20)으로부터 $\mu_i=b'(\theta_i)$ 와 $\text{var}(Y_i)=b''(\theta_i)a(\phi)$ 이므로,

$$ \partial L_i / \partial \theta_i = (y_i - \mu_i)/a(\phi), \quad \partial \mu_i / \partial \theta_i = b''(\theta_i) = \text{var}(Y_i)/a(\phi) $$

이다. 또한, $\eta_i = \sum_j \beta_j x_{ij}$ 이므로, $\partial \eta_i / \partial \beta_j = x_{ij}$ 이다.

마지막으로, $\eta_i=g(\mu_i)$ 이므로, $\partial \mu_i / \partial \eta_i$는 모델의 연결 함수에 의존한다. 요약하면, (4.23)에 대입하면 다음을 얻는다.

$$ \frac{\partial L_i}{\partial \beta_j} = \frac{y_i-\mu_i}{a(\phi)} \frac{a(\phi)}{\text{var}(Y_i)} \frac{\partial\mu_i}{\partial\eta_i} x_{ij} = \frac{(y_i-\mu_i)x_{ij}}{\text{var}(Y_i)} \frac{\partial\mu_i}{\partial\eta_i} \quad (4.24) $$

$N$개의 관측치에 대해 합산하면 우도 방정식을 산출한다.

$$ \sum_{i=1}^N \frac{(y_i-\mu_i)x_{ij}}{\text{var}(Y_i)} \frac{\partial\mu_i}{\partial\eta_i} = 0, \quad j=0, 1, 2, \dots. \quad (4.25) $$

비록 $\beta$가 이 방정식들에 명시적으로 나타나지 않지만, $\mu_i = g^{-1}(\sum_j \beta_j x_{ij})$ 이므로, 그것은 $\mu_i$를 통해 암묵적으로 존재한다. 다른 연결 함수들은 다른 방정식 집합을 산출한다.

### **4.4.6 평균-분산 관계의 핵심 역할 (The Key Role of the Mean–Variance Relationship)**

**[원문 번역]**

흥미롭게도, 우도 방정식 (4.25)는 오직 $\mu_i$와 $\text{var}(Y_i)$를 통해서만 $Y_i$의 분포에 의존한다. 분산 자체는 어떤 특정 함수 형태를 통해 평균에 의존한다.

$$ \text{var}(Y_i) = v(\mu_i) $$

어떤 함수 $v$에 대해. 예를 들어, 푸아송 분포에 대해 $v(\mu_i)=\mu_i$이고, 이항 비율에 대해 $v(\mu_i)=\mu_i(1-\mu_i)/n_i$이며, 정규분포에 대해 $v(\mu_i)=\sigma^2$ (즉, 상수)이다.

$Y_i$가 자연 지수족에 속하는 분포를 가질 때, 평균과 분산 사이의 관계는 그 분포를 특징짓는다 (Jørgensen 1987). 예를 들어, 만약 $Y_i$가 자연 지수족에 속하는 분포를 갖고 $v(\mu_i)=\mu_i$라면, $Y_i$는 반드시 푸아송 분포를 갖는다.

---

### **핵심 내용 해설: GLM 엔진의 내부 작동 원리**

이 섹션들은 GLM이 어떻게 "작동"하는지, 즉 모델 모수($\beta$)를 추정하기 위한 우도 방정식이 어떻게 유도되는지를 보여주는 수학적 핵심부입니다.

#### **4.4.4: 모든 것을 하나로 묶기**

이전 섹션들에서 GLM의 세 가지 구성 요소를 개별적으로 소개했습니다.
1.  **확률 성분**: $Y$의 분포. 평균 $E(Y)=\mu$와 분산 $\text{Var}(Y)$를 결정.
2.  **시스템 성분**: 선형 예측자 $\eta = \mathbf{X}\boldsymbol{\beta}$.
3.  **연결 함수**: $g(\mu) = \eta$.

이 섹션은 이들을 하나의 방정식으로 통합합니다:

$$ g(E(Y_i)) = \sum_j \beta_j x_{ij} $$

이것이 GLM의 **핵심 모델 방정식**입니다. 모든 GLM은 이 구조를 따릅니다.

*   **정준 연결(Canonical Link)**: $g(\mu)=\theta$ (자연 모수). 이 특별한 연결 함수를 사용하면, 모델이 $\theta_i = \sum_j \beta_j x_{ij}$ 라는 매우 깔끔하고 직접적인 형태로 표현됩니다. 이는 수학적, 통계적으로 많은 이점을 가져다줍니다. (4.4.5절에서 그 이유가 드러남)

#### **4.4.5: 최적의 $\beta$를 찾는 방정식**

최대우도(ML) 추정의 원리는 로그우도 함수 $L(\boldsymbol{\beta})$를 최대로 만드는 $\boldsymbol{\beta}$를 찾는 것입니다. 미적분학의 기본 원리에 따라, 최댓값은 **미분값이 0이 되는 지점**에서 발생합니다.

*   **우도 방정식**: $\frac{\partial L(\boldsymbol{\beta})}{\partial \beta_j} = 0$, 모든 $j$에 대해.

본문은 **연쇄 법칙(Chain Rule)**을 사용하여 이 미분을 수행합니다. 이는 각 구성 요소가 어떻게 연결되는지를 명확히 보여줍니다.

$$ \frac{\partial L}{\partial \beta_j} = \left(\frac{\partial L}{\partial \theta}\right) \cdot \left(\frac{\partial \theta}{\partial \mu}\right) \cdot \left(\frac{\partial \mu}{\partial \eta}\right) \cdot \left(\frac{\partial \eta}{\partial \beta_j}\right) $$

1.  $\frac{\partial L}{\partial \theta}$: 로그우도가 자연 모수 $\theta$에 어떻게 변하는가? (EDF의 기본 속성)
2.  $\frac{\partial \theta}{\partial \mu}$: 자연 모수 $\theta$가 평균 $\mu$에 어떻게 변하는가? ($(\partial\mu/\partial\theta)^{-1}$)
3.  $\frac{\partial \mu}{\partial \eta}$: 평균 $\mu$가 선형 예측자 $\eta$에 어떻게 변하는가? (연결 함수의 역함수의 미분)
4.  $\frac{\partial \eta}{\partial \beta_j}$: 선형 예측자 $\eta$가 모델 모수 $\beta_j$에 어떻게 변하는가? (단순히 $x_{ij}$)

이 조각들을 모두 곱하고 정리하면, 복잡해 보이지만 매우 중요한 **일반적인 우도 방정식 (4.25)**을 얻게 됩니다.

$$ \sum_{i=1}^N \frac{(y_i-\mu_i)x_{ij}}{\text{var}(Y_i)} \frac{\partial\mu_i}{\partial\eta_i} = 0 $$

*   **해석**: 이 방정식은 "가중치를 적용한 잔차($y_i-\mu_i$)가 모든 설명 변수($x_{ij}$)와 직교(orthogonal)해야 한다"는 것을 의미합니다. 여기서 가중치는 분산과 연결 함수에 의해 결정됩니다.

#### **4.4.6: GLM의 숨겨진 지문, 평균-분산 관계**

*   **놀라운 발견**: 최종 우도 방정식 (4.25)을 보면, $Y_i$의 구체적인 확률분포 함수(예: 푸아송의 $e^{-\mu}\mu^y/y!$)가 사라지고, 오직 **평균($\mu_i$)**과 **분산($\text{var}(Y_i)$)**만이 남아있습니다.
*   **핵심**: GLM을 적합시키는 데 필요한 정보는 Y의 전체 분포가 아니라, 단지 **"평균과 분산이 어떤 관계($\text{var}(Y_i)=v(\mu_i)$)를 갖는가"** 라는 것입니다.
    *   **푸아송**: 분산 = 평균 ($v(\mu)=\mu$)
    *   **이항**: 분산 = 평균(1-평균)/n ($v(\mu)=\mu(1-\mu)/n$)
    *   **정규**: 분산 = 상수 ($v(\mu)=\sigma^2$)
*   **"분포의 지문"**: 자연 지수족 내에서는 이 **평균-분산 관계($v(\mu)$)**가 각 분포를 고유하게 결정하는 **"지문"**과 같은 역할을 합니다. 만약 어떤 분포가 EDF에 속하고 분산이 평균과 같다면, 그 분포는 반드시 푸아송 분포일 수밖에 없습니다.

**결론**: 이 섹션들은 GLM이 어떻게 우아한 수학적 구조를 통해 다양한 분포를 다루는지를 보여줍니다. 모델 모수 $\beta$를 찾는 우도 방정식은 결국 **평균-분산 관계**와 **연결 함수**라는 두 가지 핵심 정보에 의해 결정됩니다. 이는 나중에 "분포를 가정하지 않고 단지 평균-분산 관계만 가정"하는 **유사우도(Quasi-likelihood)**라는 개념으로 확장되는 중요한 통찰을 제공합니다.
