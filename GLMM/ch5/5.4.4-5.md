### 5.4.4 이탈도 비교를 통한 모델 비교 (Model Comparison by Comparing Deviances)

[원문 번역]

$L _S$를 포화 모델에 대한 최대화된 로그우도라고 하자. 4.5.4절에서 논의된 바와 같이, 모델 $M _1$과 $M _0$를 비교하기 위한 우도비 통계량은 다음과 같다.

$$ G^2(M _0|M _1) = -2(L _0 - L _1) = -2(L _0 - L _S) - [-2(L _1 - L _S)] = G^2(M _0) - G^2(M _1) $$

두 모델을 비교하는 검정 통계량은 두 모델의 $G^2$ 적합도 통계량(이탈도)의 차이와 동일하다. 예를 들어, AIDS 데이터에 대한 인종 효과에 대해 $H _0: \beta _2=0$을 고려해보자. 우도비 통계량은 0.04와 같으며, 이는 더 단순한 모델이 적절함을 시사한다. 그러나 이것은 $\beta _2=0$인 더 단순한 모델이 $M _0$일 때 $G^2(M _0) - G^2(M _1) = 1.42 - 1.38$과 같다.

모델 비교 통계량은 개별적인 $G^2(M _i)$들이 그렇지 않을 때조차도 종종 근사적인 카이제곱 귀무분포를 갖는다. 예를 들어, 적어도 하나의 예측 변수가 연속형이거나 분할표가 매우 작은 적합치를 가질 때, $G^2(M _i)$의 표집분포는 카이제곱 분포와 거리가 멀 수 있다. 그럼에도 불구하고, 만약 비교 통계량의 자유도(df)가 작다면(예컨대 기껏해야 몇 개의 모수만 다른 두 모델을 비교하는 경우), $G^2(M _0|M _1)$의 귀무분포는 근사적으로 카이제곱이다.

### 5.4.5 예제: 투구게 위성 재검토 (Example: Horseshoe Crab Satellites Revisited)

[원문 번역]

투구게 데이터에 대해, 우리는 다음으로 게가 적어도 하나의 위성을 갖는지 여부(Y=1, 예; 0, 아니오)의 예측 변수로서 암컷 게의 등딱지 너비와 색깔을 모두 사용한다. 색깔은 다섯 가지 범주를 갖는다: 밝음(light), 중간 밝음(medium light), 중간(medium), 중간 어두움(medium dark), 어두움(dark). 이것은 나이의 대리 변수(surrogate)이며, 나이든 게는 더 어두워지는 경향이 있다. 표본에는 밝은 색 게가 포함되어 있지 않았으므로, 우리 모델은 다른 네 가지 범주만 사용한다. 우리는 먼저 색깔을 질적(qualitative)으로 취급한다. 네 가지 범주는 세 개의 지시 변수를 사용한다. 게가 적어도 하나의 위성을 가질 확률에 대한 모델은

$$ \text{logit}[P(Y=1)] = \alpha + \beta _1 c _1 + \beta _2 c _2 + \beta _3 c _3 + \beta _4 x \quad (5.13) $$

이며, 여기서 $x$=너비(센티미터)이고,
$c _1 = 1$ (중간 밝음 색), 0 (그 외),
$c _2 = 1$ (중간 색), 0 (그 외),
$c _3 = 1$ (중간 어두움 색), 0 (그 외)
이다. 게의 색깔은 $c _1=c _2=c _3=0$일 때 어둡다(범주 4). 표 5.9는 ML 모수 추정치를 보여준다. 예를 들어, 어두운 게에 대해, $\text{logit}[\hat{P}(Y=1)] = -12.715+0.468x$이다; 대조적으로, 중간 밝음 색 게에 대해, $c _1=1$이고, $\text{logit}[\hat{P}(Y=1)] = (-12.715+1.330)+0.468x = -11.385+0.468x$이다. 평균 너비 26.3cm에서, 어두운 게에 대해 $\hat{P}(Y=1)=0.399$이고 중간 밝음 게에 대해 0.715이다. 두 색깔 모수 추정치 간의 지수화된 차이는 그 색깔들을 비교하는 오즈비이다. 예를 들어, 중간 밝음 게와 어두운 게의 차이는 1.330이다. 어떤 주어진 너비에서, 중간 밝음 게가 위성을 가질 추정된 오즈는 어두운 게의 추정된 오즈의 $\exp(1.330)=3.8$배이다.

색깔이 모델 (5.13)에 유의하게 기여하는지 검정하기 위해, 우리는 $H _0: \beta _1=\beta _2=\beta _3=0$을 검정한다. 이것은 너비를 통제했을 때, 위성을 가질 확률이 색깔과 독립이라고 말한다. 우리는 전체 모델 (5.13)의 최대화된 로그우도 $L _1$을 더 단순한 모델의 $L _0$와 비교한다. 검정 통계량 $-2(L _0-L _1)=7.0$은 df=3을 가지며, 이는 두 모델의 모수 개수 간의 차이이다. 카이제곱 P-값 0.07은 색깔 효과에 대한 약간의 증거를 제공한다.

이 모델은 그 효과에 있어 색깔과 너비 사이에 상호작용이 없다고 가정한다. 너비는 모든 색깔에 대해 0.468의 계수를 가지므로, 너비를 $P(Y=1)$에 관련시키는 곡선들의 모양은 동일하다. 그림 5.7은 적합된 모델을 보여준다. 어떤 한 곡선은 다른 곡선을 오른쪽이나 왼쪽으로 이동시킨 것과 같다. 수평 차원에서의 곡선들의 평행성은 어떤 두 곡선도 절대 교차하지 않음을 의미한다. 모든 너비 값에서, 색깔 4(어두움)는 다른 색깔들보다 위성을 가질 추정된 확률이 더 낮다. 너비의 눈에 띄는 양의 효과가 있다.

---

### 핵심 내용 해설

이 섹션들은 모델 비교를 위한 우도비 검정, 즉 이탈도 차이 검정을 다중 로지스틱 회귀의 맥락에서 구체적으로 적용하는 방법을 보여줍니다.

#### 5.4.4: 이탈도를 이용한 모델 선택

*   핵심 원리: 4.5.4절에서 배운 것과 동일. 두 개의 포함된(nested) 모델 $M _0$와 $M _1$을 비교할 때,

$$ G^2(M _0|M _1) = D(M _0) - D(M _1) $$

는 두 모델 간의 우도비 검정 통계량이며, (두 모델의 모수 개수 차이)를 자유도로 갖는 카이제곱 분포를 따른다.

*   새로운 통찰: 이 방법은 비그룹화 데이터(ungrouped data)에 대해서도 유효하다.
    *   4.5.3절에서 우리는 비그룹화 데이터에 대한 개별 모델의 이탈도($D(M _0)$나 $D(M _1)$) 자체는 카이제곱 분포를 따르지 않으므로, 절대적인 적합도 검정(GOF)에는 쓸 수 없다고 배웠습니다.
    *   하지만, 이탈도의 차이를 계산하면 포화 모델의 로그우도($L _S$) 항이 서로 상쇄됩니다. 그 결과, $D(M _0)-D(M _1)$은 비그룹화 데이터의 경우에도 (적절한 조건 하에) 근사적으로 카이제곱 분포를 따릅니다.
*   결론: 이탈도 자체는 GOF 검정에 못 쓸 수 있어도, 이탈도의 차이는 두 모델 중 어느 것이 더 나은지를 판단하는 모델 비교(model comparison)에 매우 유용하고 신뢰할 수 있는 도구입니다.

#### 5.4.5: 투구게 예제 - 변수 선택의 실제

이 예제는 이탈도 차이 검정을 이용한 변수 선택(variable selection) 과정을 보여줍니다.

1.  연구 질문: "투구게의 위성 유무를 예측하는 데, '너비'만 사용하는 것보다 '색깔' 변수를 추가하는 것이 통계적으로 의미 있는 개선을 가져오는가?"

2.  두 개의 모델 설정:
    *   단순 모델 ($M _0$): 너비만 포함. $\text{logit}(\pi) = \alpha + \beta _4 x$
    *   복잡 모델 ($M _1$): 너비와 색깔(4개 범주 $\to$ 3개 지시 변수) 모두 포함.

$$ \text{logit}(\pi) = \alpha + \beta _1 c _1 + \beta _2 c _2 + \beta _3 c _3 + \beta _4 x \quad \text{(식 5.13)} $$

($M _0$는 $M _1$에서 $\beta _1=\beta _2=\beta _3=0$인 특별한 경우이므로, 두 모델은 포함 관계에 있습니다.)

3.  가설 검정:
    *   귀무가설 ($H _0$): "색깔 변수는 모델에 기여하지 않는다." ($\beta _1=\beta _2=\beta _3=0$)
    *   검정 통계량: 두 모델의 로그우도 $L _0$와 $L _1$을 각각 구한 후, 우도비 통계량 $-2(L _0-L _1)$을 계산. (이는 이탈도의 차이와 같습니다.)
    *   결과: 통계량 값 = 7.0
    *   자유도: (모수 개수 차이) = (5개 - 2개) = 3
    *   P-값: 자유도 3인 카이제곱 분포에서 7.0보다 큰 값이 나올 확률 = 0.07.

4.  결론 및 해석:
    *   P-값이 0.07로, 전통적인 유의수준 0.05보다는 큽니다. 따라서 "색깔이 유의하다"고 강력하게 주장하기는 어렵습니다.
    *   본문에서는 "색깔 효과에 대한 약간의 증거를 제공한다(provides slight evidence)"고 해석합니다. 이는 통계적으로 '애매한' 경계선에 있는 결과입니다.
    *   모델의 계수들을 살펴보면($\hat{\beta} _1=1.33, \hat{\beta} _2=1.40, \hat{\beta} _3=1.11$), 어두운 색(기준 범주)에 비해 다른 색깔들이 위성을 가질 오즈가 더 높은 경향을 보입니다.

5.  상호작용 없음(No Interaction) 가정의 시각화 (그림 5.7):
    *   모델 (5.13)은 너비의 효과($\beta _4$)가 모든 색깔 그룹에서 동일하다고 가정합니다.
    *   이는 로그 오즈 스케일에서 각 색깔 그룹의 회귀선이 평행함을 의미합니다.
    *   이것을 확률 스케일로 변환한 그림 5.7을 보면, 각 색깔에 대한 S자 곡선들이 서로 모양은 같고 좌우로 평행이동한 것처럼 보입니다. 두 곡선은 절대 교차하지 않습니다.
    *   "상호작용을 허용한다"는 것은 각 색깔 그룹마다 너비의 기울기($\beta _4$)가 달라지는 것을 허용하는 더 복잡한 모델을 만드는 것을 의미합니다.

종합 요약: 이탈도의 차이를 이용한 우도비 검정은 여러 예측 변수를 갖는 GLM에서 특정 변수(또는 변수 그룹)의 유의성을 평가하는 표준적이고 신뢰성 높은 방법입니다. 투구게 예제는 이 방법을 사용하여 '색깔'이라는 범주형 변수의 기여도를 평가하고, '상호작용 없음'이라는 모델 가정이 시각적으로 어떻게 표현되는지를 명확하게 보여줍니다.
