### 5.2 로지스틱 회귀에 대한 추론 (INFERENCE FOR LOGISTIC REGRESSION)

[원문 번역]

표준적인 결과에 의해, 로지스틱 회귀 모델 모수들의 최대우도(ML) 추정량들은 대푯본 정규분포를 갖는다. 추론은 1.3.3절에서 소개된 (왈드, 우도비, 스코어) 세 가지 방법들을 사용할 수 있다.

#### 5.2.1 모델 모수와 확률에 대한 추론 (Inference About Model Parameters and Probabilities)

[원문 번역]

단일 예측 변수를 갖는 로지스틱 모델,

$$ \text{logit}[\pi(x)] = \alpha + \beta x, $$

에 대해, 유의성 검정은 독립성 가설인 $H _0: \beta=0$에 초점을 맞춘다. 왈드 검정(Wald test)은 $\hat{\beta}$에서의 로그우도를 사용하며, 검정 통계량은 $z = \hat{\beta}/\text{SE}$ 또는 그것의 제곱이다; $H _0$ 하에서, $z^2$은 점근적으로 $\chi^2 _1$이다. 우도비 검정(likelihood-ratio test)은 $\hat{\beta}$에서의 최대화된 로그우도와 $\beta=0$에서의 최대화된 로그우도 간의 차이의 두 배를 사용하며, 이 또한 점근적으로 $\chi^2 _1$ 귀무분포를 갖는다. 스코어 검정(score test)은 그 지점에서의 로그우도의 미분(즉, 스코어 함수)을 통해 $\beta=0$에서의 로그우도를 사용한다. 검정 통계량은 $\beta$에 대한 충분통계량을 그것의 귀무 기댓값과 비교하며, 적절히 표준화된다[N(0,1) 또는 $\chi^2 _1$]. 5.3.5절에서 이 검정을 제시한다.

$\beta$에 대한 신뢰구간은 $H _0: \beta=\beta _0$ 검정을 역산한 결과이다. 이 구간은 카이제곱 검정 통계량이 $\chi^2 _1(\alpha) = z^2 _{\alpha/2}$ 보다 크지 않은 $\beta _0$ 값들의 집합이다. 왈드 접근법에 대해, 이것은 $[(\hat{\beta}-\beta _0)/\text{SE}]^2 \le z^2 _{\alpha/2}$를 의미하므로, 그 구간은 $\hat{\beta} \pm z _{\alpha/2}(\text{SE})$이다.

관계 요약에서, $\beta$보다 다양한 $x$ 값들에서의 $\pi(x)$와 같은 다른 특성들이 더 중요할 수 있다. 고정된 $x=x _0$에 대해, $\text{logit}[\pi(x _0)] = \alpha+\beta x _0$는 추정된 제곱근

$$ \sqrt{\text{var}(\hat{\alpha}) + x _0^2\text{var}(\hat{\beta}) + 2x _0\text{cov}(\hat{\alpha}, \hat{\beta})} $$

에 의해 주어진 대푯본 SE를 갖는다. $\text{logit}[\pi(x _0)]$에 대한 95% 신뢰구간은 $(\hat{\alpha}+\hat{\beta}x _0) \pm 1.96(\text{SE})$이다. 각 끝점을 역변환 $\pi(x _0) = \exp(\text{logit})/[1+\exp(\text{logit})]$에 대입하면 $\pi(x _0)$에 대한 해당 구간을 제공한다.

### 5.2.2 예제: 투구게 짝짓기 데이터에 대한 추론 (Example: Inference for Horseshoe Crab Mating Data)

[원문 번역]

우리는 예측 변수로 게의 너비를 사용하여, 투구게가 위성을 가질 확률에 대한 모델로 로지스틱 회귀 추론을 설명한다. 표 5.1은 적합 결과와 표준오차를 보여주었다. 통계량 $z = \hat{\beta}/\text{SE} = 0.497/0.102=4.89$는 양의 너비 효과에 대한 강력한 증거를 제공한다($P<0.0001$). 동등한 왈드 카이제곱 통계량, $z^2=23.89$는 df=1을 갖는다. 최대화된 로그우도는 $H _0: \beta=0$ 하에서는 -112.88이고 전체 모델에 대해서는 -97.23이다. 우도비 통계량은 $-2[-112.88 - (-97.23)] = 31.31$이며, df=1이다. 이것은 왈드 검정보다 훨씬 더 강력한 증거를 제공한다.

$\beta$에 대한 왈드 95% 신뢰구간은 $0.497 \pm 1.96(0.102)$, 즉 (0.298, 0.697)이다. 표 5.1은 프로파일 우도 함수에 기반한, (0.308, 0.709)의 우도비 신뢰구간을 보고한다. 너비가 1cm 증가할 때 오즈에 미치는 효과에 대한 신뢰구간은 $(e^{0.308}, e^{0.709}) = (1.36, 2.03)$과 같다. 우리는 너비가 1cm 증가하면 위성을 가질 오즈가 최소 36% 증가하고 최대 두 배가 된다고 추론한다.

대부분의 로지스틱 회귀 소프트웨어는 또한 $\pi(x)$에 대한 추정치와 신뢰구간을 보고할 수 있다(예시는 텍스트 웹사이트 참조). 평균 너비에 가까운, 너비 $x=26.5$인 게에 대해 이것을 고려해보자. 추정된 로짓은 $-12.351+0.497(26.5)=0.826$이고, $\hat{\pi}(x)=0.695$이다. 소프트웨어는

$$ \widehat{\text{var}}(\hat{\alpha}) = 6.91023, \quad \widehat{\text{var}}(\hat{\beta}) = 0.01035, \quad \widehat{\text{cov}}(\hat{\alpha}, \hat{\beta}) = -0.26685 $$

를 보고하며, 이로부터

$$ \widehat{\text{var}}\{\text{logit}[\hat{\pi}(x)]\} = 6.91023 + x^2(0.01035) + 2x(-0.26685) $$

이다. $x=26.5$에서 이것은 0.0356이므로, $\text{logit}[\pi(26.5)]$에 대한 95% 신뢰구간은 $0.826 \pm 1.96\sqrt{0.0356}$, 즉 (0.456, 1.196)과 같다. 이것은 위성을 가질 확률에 대해 (0.61, 0.77)의 구간으로 변환된다 (예: $\exp(0.456)/[1+\exp(0.456)]=0.61$).

---

### 핵심 내용 해설

이 섹션들은 로지스틱 회귀 모델을 적합시킨 후, 그 결과를 어떻게 통계적으로 해석하고 신뢰도를 평가하는지에 대한 구체적인 방법을 다룹니다.

#### 5.2.1: 모델의 불확실성 평가하기

로지스틱 회귀 모델을 적합하면 $\hat{\alpha}$와 $\hat{\beta}$라는 추정치를 얻습니다. 하지만 이것들은 표본에 기반한 추정치일 뿐, 실제 모집단의 모수 $\alpha, \beta$와는 약간의 차이가 있을 것입니다. 추론(Inference)이란 이 불확실성을 정량화하는 과정입니다.

1. 효과의 유의성 검정 ($H _0: \beta=0$)
*   핵심 질문: "설명 변수 $x$가 반응 변수 $Y$에 정말로 영향을 미치는가, 아니면 우리가 관찰한 관계가 그냥 우연인가?"
*   이를 검정하기 위해 1장에서 배운 세 가지 표준적인 방법을 사용합니다.
    *   왈드 검정: 가장 간단. $z = \hat{\beta}/\text{SE}$를 계산. 절댓값이 크면(보통 2 이상) 유의하다고 판단.
    *   우도비 검정 (LR Test): 가장 신뢰성 높음. $x$가 없는 모델(절편만 있는 모델)과 $x$가 있는 모델의 로그우도를 비교.
    *   스코어 검정: 계산상 이점이 있을 수 있음.

2. 효과의 크기 추정 (신뢰구간)
*   $\beta$의 신뢰구간: $\beta$의 그럴듯한 값들의 범위를 추정. 왈드 방법($\hat{\beta} \pm z _{\alpha/2}\text{SE}$)이 가장 간단하지만, 우도비 기반(프로파일 우도) 신뢰구간이 더 정확하고 선호됩니다.
    *   이 신뢰구간에 지수($e^x$)를 취하면, 오즈비($e^\beta$)에 대한 신뢰구간을 얻을 수 있습니다. 이것이 가장 중요한 해석입니다.
*   특정 $x _0$에서의 확률 $\pi(x _0)$의 신뢰구간:
    *   단순히 $\beta$의 크기만 보는 것보다, 실제적인 의미를 이해하기 위해 특정 $x$값에서의 확률을 추정하는 것이 더 유용할 때가 많습니다.
    *   절차:
        1.  $\text{logit}[\pi(x _0)] = \alpha + \beta x _0$의 점 추정치($\hat{\alpha}+\hat{\beta}x _0$)를 계산.
        2.  이 점 추정치의 표준오차(SE)를 계산. 이때 $\hat{\alpha}$와 $\hat{\beta}$의 분산뿐만 아니라 공분산까지 고려해야 합니다.
        3.  로그 오즈 스케일에서 신뢰구간을 구합니다: $(\hat{\alpha}+\hat{\beta}x _0) \pm z _{\alpha/2}\text{SE}$.
        4.  구간의 양 끝점을 확률 스케일로 역변환합니다: $\pi = e^{\text{logit}}/(1+e^{\text{logit}})$.

#### 5.2.2: 실제 데이터 분석 예시

투구게 데이터에 대한 로지스틱 회귀 분석 결과를 통해 위의 추론 과정을 구체적으로 보여줍니다.
*   모델: $\text{logit}[\pi(\text{너비})] = -12.351 + 0.497 \times \text{너비}$
*   1. 유의성 검정:
    *   왈드 검정: $z = 0.497/0.102 = 4.89$. P-값이 매우 작으므로(<0.0001), 너비는 위성 존재 확률에 매우 유의미한 양의 효과를 가집니다.
    *   우도비 검정: LR 통계량 = 31.31. 이 역시 P-값이 매우 작으며, 왈드 검정보다 더 강력한 증거를 제시합니다 (통계량이 더 큼).
*   2. 효과 크기 추정:
    *   오즈비: 점 추정치 $e^{\hat{\beta}} = e^{0.497} = 1.64$. "너비가 1cm 증가할 때마다, 위성을 가질 오즈가 1.64배(64%) 증가한다."
    *   오즈비의 신뢰구간: 우도비 기반 신뢰구간(1.36, 2.03)을 사용합니다. "우리는 95% 신뢰수준으로, 너비가 1cm 증가할 때 위성을 가질 오즈가 최소 1.36배에서 최대 2.03배까지 증가한다고 말할 수 있다."
*   3. 특정 확률 추정:
    *   $x=26.5$cm(평균 근처 너비)인 게가 위성을 가질 확률은 얼마인가?
    *   점 추정: $\hat{\pi}(26.5)=0.695$ (69.5%)
    *   신뢰구간: (0.61, 0.77). "우리는 95% 신뢰수준으로, 너비가 26.5cm인 게가 위성을 가질 실제 확률이 61%에서 77% 사이일 것이라고 추정한다."

결론: 이 섹션들은 로지스틱 회귀 분석이 단지 $\beta$값을 추정하는 것에서 끝나는 것이 아니라, 그 추정치의 통계적 유의성(P-값)과 불확실성(신뢰구간)을 평가하는 과정이 반드시 수반되어야 함을 보여줍니다. 특히, 효과를 실제적인 의미로 전달하기 위해 오즈비($e^\beta$)나 특정 예측 확률($\pi(x)$)에 대한 신뢰구간을 계산하고 해석하는 것이 매우 중요합니다.
