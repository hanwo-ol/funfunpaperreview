### 5.4 다중 로지스틱 회귀 (MULTIPLE LOGISTIC REGRESSION)

[원문 번역]

보통의 회귀분석처럼, 로지스틱 회귀는 양적 및 질적 변수가 혼합될 수 있는 다중 설명 변수를 갖는 모델로 확장된다 (Cox 1958). $p$개 예측 변수들의 값 $\mathbf{x}=(x _1, \dots, x _p)$에서 $P(Y=1)=\pi(\mathbf{x})$에 대한 모델은

$$ \text{logit}[\pi(\mathbf{x})] = \alpha + \beta _1 x _1 + \beta _2 x _2 + \dots + \beta _p x _p \quad (5.8) $$

이다. $\pi(\mathbf{x})$를 직접 명시하는 대안적인 공식은 다음과 같다.

$$ \pi(\mathbf{x}) = \frac{\exp(\alpha+\beta _1 x _1 + \beta _2 x _2 + \dots + \beta _p x _p)}{1+\exp(\alpha+\beta _1 x _1 + \beta _2 x _2 + \dots + \beta _p x _p)} \quad (5.9) $$

질적 예측 변수들에 대해서는, 우리는 그것의 범주들을 위해 지시 변수들을 사용한다.

모수 $\beta _j$는 다른 $x _k$들을 통제(adjusting for)하면서, $Y=1$일 로그 오즈에 대한 $x _j$의 효과를 나타낸다. 예를 들어, $\exp(\beta _j)$는 다른 $x _k$들의 수준을 고정시킬 수 있을 때, $x _j$가 1-단위 증가할 때 오즈에 대한 곱셈 효과이다.

### 5.4.1 다원 분할표를 위한 로지스틱 모델 (Logistic Models for Multiway Contingency Tables)

[원문 번역]

모든 변수들이 범주형일 때, 다원 분할표가 데이터를 보여준다. 우리는 이항 예측 변수 X와 Z로 아이디어를 설명한다. 우리는 X와 Z의 주어진 조합에서의 표본 크기를 고정된 것으로 취급하고, 각 설정에서의 Y에 대한 두 카운트를 독립적으로 처리되는 이항 변수로 간주한다. 우리는 지시 변수 $x$와 $z$가 첫 번째 범주에서는 값 1을, 두 번째 범주에서는 0을 갖도록 한다. 모델

$$ \text{logit}[P(Y=1)] = \alpha + \beta _1 x + \beta _2 z \quad (5.10) $$

는 X와 Z에 대한 주효과(main effects)를 갖지만 상호작용의 부재를 가정한다. 한 요인의 효과는 다른 요인의 각 수준에서 동일하다.

Z의 고정된 수준에서, X의 범주를 바꿀 때의 로짓에 대한 효과는

$$ [\alpha+\beta _1(1)+\beta _2 z] - [\alpha+\beta _1(0)+\beta _2 z] = \beta _1 \quad (5.11) $$

이다. 이 로짓 차이는 로그 오즈의 차이와 같으며, 이는 Z를 고정한 상태에서의 X와 Y 간의 로그 오즈비이다. 따라서, $\exp(\beta _1)$은 X와 Y 간의 조건부 오즈비(conditional odds ratio)이다. Z를 통제했을 때, $x=1$일 때의 성공 오즈는 $x=0$일 때의 오즈의 $\exp(\beta _1)$배와 같다. 이 조건부 오즈비는 $z$의 각 수준에서 동일하다; 즉, 균일 XY 연관성(homogeneous XY association)이 있다(2.3.5절). 상호작용 항의 부재는 부분표들에 대한 공통 오즈비를 의미한다. $\beta _1=0$일 때, 그 공통 오즈비는 1과 같다. 그러면 X와 Y는 각 부분표에서 독립이거나, Z가 주어졌을 때 조건부로 독립이다(2.3.4절).

### 5.4.2 예제: 에이즈(AIDS)와 AZT 사용 (Example: AIDS and AZT Use)

[원문 번역]

표 5.6은 AIDS 증상의 발현을 늦추는 데 있어 AZT의 효과에 대한 연구에서 가져온 것이다. 이 연구에서, HIV에 감염된 후 면역 체계가 약화되기 시작한 338명의 퇴역 군인들은 AZT를 즉시 받거나 또는 그들의 T 세포가 심각한 면역 약화를 보일 때까지 기다리도록 무작위로 할당되었다. 표 5.6은 재향 군인들의 인종, 그들이 AZT를 즉시 받았는지 여부, 그리고 3년 연구 기간 동안 AIDS 증상이 발현되었는지 여부를 교차 분류한다.

모델 (5.10)에서, 우리는 X를 AZT 치료(즉각적인 AZT 사용 시 $x=1$, 그 외 $x=0$)로, Z를 인종(백인일 때 $z=1$, 흑인일 때 $z=0$)으로 식별하여, AIDS 증상이 발현될 확률을 예측한다. 따라서, $\alpha$는 즉각적인 AZT 사용이 없는 흑인 피험자들의 AIDS 증상 발현에 대한 로그 오즈이고, $\beta _1$은 즉각적인 AZT 사용이 있는 사람들에 대한 로그 오즈의 증가분이며, $\beta _2$는 백인 피험자들에 대한 로그 오즈의 증가분이다. 표 5.7은 결과물을 보여준다. 즉각적인 AZT 사용과 AIDS 증상 발현 간의 추정된 오즈비는 $\exp(-0.7195)=0.487$과 같다. 각 인종에 대해, AZT를 즉시 복용한 사람들의 증상에 대한 추정된 오즈는 그렇지 않은 사람들의 절반 수준이다. 이 효과에 대한 왈드 신뢰구간은 $\exp[-0.720 \pm 1.96(0.279)] = (0.28, 0.84)$이다. 우도 기반 구간에 대해서도 유사한 결과가 나온다.

인종을 통제한 상태에서, AZT 치료와 AIDS 증상 발현의 조건부 독립성 가설은 (5.10)에서 $H _0: \beta _1=0$이다. $\beta _1=0$인 더 단순한 모델과 현재 모델을 비교하는 우도비 통계량은 6.87(df=1)과 같으며, 연관성의 증거를 보여준다($P=0.01$). 결과물에 보이는 왈드 통계량 $(\hat{\beta} _1/\text{SE})^2 = (-0.7195/0.279)^2 = 6.65$는 유사한 결과를 제공한다.

---

### 핵심 내용 해설

이 섹션들은 로지스틱 회귀를 단일 예측 변수에서 여러 예측 변수(multiple predictors)를 갖는 모델로 확장하는 방법을 설명합니다. 이는 로지스틱 회귀를 실제 분석 문제에 적용하기 위한 필수적인 단계입니다.

#### 5.4 & 5.4.1: 다중 로지스틱 회귀의 구조와 해석

*   모델:

$$ \text{logit}[\pi(\mathbf{x})] = \alpha + \beta _1 x _1 + \beta _2 x _2 + \dots + \beta _p x _p $$

*   구조: 여전히 성공의 로그 오즈가 예측 변수들의 선형 결합이라고 가정합니다. 이는 OLS 다중 회귀와 동일한 구조입니다.

*   $\beta _j$의 해석:
    *   $\beta _j$는 "다른 모든 예측 변수들($x _k, k \neq j$)이 일정하게 유지된다는 조건 하에서, $x _j$가 1단위 증가할 때 로그 오즈의 변화량"입니다.
    *   $e^{\beta _j}$는 "다른 변수들이 통제되었을 때(adjusting for), $x _j$가 1단위 증가할 때 오즈에 대한 곱셈 효과", 즉 조건부 오즈비(conditional odds ratio)입니다.

*   상호작용 없음(No Interaction) 가정:
    *   위의 주효과(main effects) 모델 (5.10)은 $x$의 효과($\beta _1$)가 $z$의 값에 따라 변하지 않고, $z$의 효과($\beta _2$)가 $x$의 값에 따라 변하지 않는다고 가정합니다.
    *   이는 X와 Y의 조건부 오즈비가 Z의 모든 수준에서 동일하다는 균일 연관성(homogeneous association) 가정과 같습니다.
    *   만약 이 가정이 의심된다면, 모델에 상호작용 항($\beta _3 xz$)을 추가하여 검정할 수 있습니다.

#### 5.4.2: 실제 데이터 분석 예시 (AZT 연구)

이 예제는 두 개의 이항 예측 변수(AZT 사용 여부, 인종)를 갖는 다중 로지스틱 회귀 모델을 적용하는 과정을 보여줍니다.

*   모델: $\text{logit}[\pi(\text{AZT, 인종})] = \alpha + \beta _1 \text{AZT} + \beta _2 \text{인종}$
    *   AZT: 즉시 사용=1, 대기=0
    *   인종: 백인=1, 흑인=0 (흑인이 기준 범주)
*   계수 해석:
    *   $\alpha$ (절편): $x=0, z=0$일 때의 로그 오즈. 즉, "AZT를 즉시 사용하지 않은 흑인"의 AIDS 발현 로그 오즈.
    *   $\beta _1$ (AZT 효과): 인종이 같을 때, AZT를 즉시 사용한 그룹과 그렇지 않은 그룹 간의 로그 오즈 차이.
    *   $\beta _2$ (인종 효과): AZT 사용 여부가 같을 때, 백인과 흑인 간의 로그 오즈 차이.
*   결과 분석 (표 5.7):
    *   $\hat{\beta} _1 = -0.7195$: 음수 값은 AZT 즉시 사용이 AIDS 발현 로그 오즈를 낮추는 효과가 있음을 의미.
    *   오즈비로 해석: $e^{-0.7195} = 0.487$. "인종에 관계없이, AZT를 즉시 사용한 그룹의 AIDS 발현 오즈는 그렇지 않은 그룹의 약 0.49배(즉, 51% 감소)이다." 이는 AZT가 효과가 있음을 시사합니다.
    *   신뢰구간: 이 오즈비의 95% 신뢰구간은 (0.28, 0.84)입니다. 이 구간은 1을 포함하지 않으므로, AZT의 효과는 통계적으로 유의미합니다.
*   가설 검정:
    *   질문: "인종을 통제한 후에도, AZT가 정말 효과가 있는가?" ($H _0: \beta _1=0$)
    *   LR 검정: 통계량=6.87 (df=1), P-값=0.01. $\implies$ 유의수준 5%에서 귀무가설 기각. AZT는 유의미한 효과가 있다.
    *   왈드 검정: 통계량=6.65 (df=1), P-값=0.0099. $\implies$ LR 검정과 거의 동일한 결론.

결론: 다중 로지스틱 회귀는 여러 변수의 효과를 동시에 평가하고, 특정 변수의 "순수한" 효과를 다른 변수들을 통제한 상태에서 추정할 수 있게 해주는 강력한 도구입니다. 각 계수의 해석은 항상 "다른 변수들이 고정되었을 때"라는 조건 하에서 이루어집니다.
