### 5.2.3 적합도 검토: 그룹화 데이터와 비그룹화 데이터 (Checking Goodness of Fit: Grouped and Ungrouped Data)

[원문 번역]

실제 분석에서, 특정 로지스틱 회귀 모델이 데이터에 잘 맞는다는 보장은 없다. 어떤 유형의 이항 데이터에 대해서든, 적합성 결여를 탐지하는 한 가지 방법은 현재 모델을 더 복잡한 모델과 비교하는 우도비 검정을 사용하는 것이다. 더 복잡한 모델은 비선형 효과를 포함할 수 있다. 다중 예측 변수를 갖는 모델은 상호작용을 고려할 것이다. 만약 더 복잡한 모델이 더 잘 맞지 않는다면, 이것은 선택된 모델이 합리적이라는 어느 정도의 확신을 제공한다.

모델이 실패하는 어떤 방식이든 찾으려는 다른 적합성 결여 탐지 접근법들이 있다. 이것은 5.4.3절에서 설명할 것처럼, 설명 변수들이 순전히 범주형일 때 가장 간단하다. $\mathbf{x}$의 각 설정에서, 두 결과에 대한 추정된 확률에 그 설정의 피험자 수를 곱하면 $y=0$과 $y=1$에 대한 추정된 기대 빈도를 산출한다. 이것들이 적합치(fitted values)이다. 모델의 검정은 관측된 빈도와 적합치를 피어슨 $X^2$ 또는 우도비 $G^2$ 통계량을 사용하여 비교한다. 고정된 수의 설정에 대해, 적합치가 증가함에 따라, $X^2$과 $G^2$은 극한에서 카이제곱 귀무분포를 갖는다. 모델에 대한 잔차 자유도(residual df)라고 불리는 자유도는, 포화 모델의 모수 개수(즉, $\mathbf{x}$의 설정 개수)에서 현재 모델의 모수 개수를 뺀다.

전체 적합도 검정을 범주형 예측 변수로 제한하는 이유는 4.5.3절에서 언급한 이항 모델의 그룹화 데이터와 비그룹화 데이터 간의 구별과 관련이 있다. 포화 모델은 두 경우에 다르다. 이탈도에 대한 점근적 카이제곱 분포는 그 모델의 고정된 수의 모수와 그에 따른 고정된 수의 예측 변수 값 설정(즉, 그룹화 데이터)에 대해 $n \to \infty$일 때 발생한다.

### 5.2.4 예제: 투구게 데이터의 모델 적합도 (Example: Model Goodness of Fit for Horseshoe Crab Data)

[원문 번역]

암컷 게가 위성을 가질 확률을 예측하기 위해 $x$=너비를 사용하는 모델에 대한 적합도 분석으로 설명한다. 그것을 확인하는 한 가지 방법은 이차항이나 선형 스플라인을 포함하는 모델과 같은, 더 복잡한 모델과 비교하는 것이다. 너비를 그 평균인 26.3을 빼서 0을 중심으로 맞추면, 이차 모델은 다음과 같은 적합 결과를 갖는다.

$$ \text{logit}[\hat{\pi}(x)] = 0.618 + 0.533(x-\bar{x}) + 0.040(x-\bar{x})^2 $$

이차항 추정치는 SE=0.046을 갖는다. 그 항을 추가하는 것을 지지할 만한 증거는 많지 않다. $x^2$의 실제 계수가 0인지 검정하기 위한 우도비 통계량은 0.83과 같다(df=1).

다음으로, 전반적인 적합도를 평가한다. 너비는 173마리의 게에 대해 66개의 서로 다른 값을 가지며, 대부분의 너비에서 관측치는 거의 없다. 우리는 데이터를 $66 \times 2$ 분할표로 볼 수 있다. 각 행의 두 셀은 해당 너비에서 위성이 있는 게의 수와 없는 게의 수를 센다. $X^2$과 $G^2$에 대한 카이제곱 이론은 $x$의 수준 수가 고정되고, 각 수준의 관측치 수가 증가할 때 적용된다. 비록 우리가 173개의 개별 이항 반응 대신 고유한 너비 값을 사용하여 데이터를 그룹화했지만, 이 이론은 여기서 두 가지 방식으로 위반된다. 첫째, 대부분의 적합치가 매우 작다. 둘째, 더 많은 데이터가 수집되면, 추가적인 너비 값이 발생할 것이므로, 분할표는 고정된 수가 아닌 더 많은 셀을 포함하게 될 것이다. 이 때문에, 연속형 또는 거의 연속형인 예측 변수를 갖는 로지스틱 회귀 모델에 대한 $X^2$과 $G^2$은 근사적인 카이제곱 분포를 갖지 않는다.

### 5.2.5 비그룹화 데이터의 적합도를 그룹화를 통해 검토하기 (Checking Goodness of Fit with Ungrouped Data by Grouping)

[원문 번역]

방금 언급했듯이, 비그룹화 데이터나 연속형 또는 거의 연속형인 예측 변수가 있을 때, $X^2$과 $G^2$은 극한에서 카이제곱 분포를 갖지 않는다. 그것들은 이차항을 확인하기 위해 위에서 한 것처럼 모델들을 비교하는 데 여전히 유용하다. 또한, 우리는 $x$ 값의 공간을 분할하여 그룹화된 관측치와 적합치에 근사적인 방식으로 그것들을 적용할 수 있다.

표 5.2는 표 4.4의 그룹화를 사용하여 $8 \times 2$ 표를 제공한다. 각 너비 범주에서, "예" 반응에 대한 적합치는 그 범주 내 너비를 가진 모든 게들에 대한 추정된 확률 $\hat{\pi}(x)$의 합이다; "아니오" 반응에 대한 적합치는 그 게들에 대한 $1-\hat{\pi}(x)$의 합이다. 그러면 적합치는 훨씬 더 커진다. 그러면, 비록 각 범주에서 $\pi(x)$가 상수가 아니기 때문에 카이제곱 이론이 여전히 완벽하지는 않지만, $X^2$과 $G^2$은 더 나은 타당성을 갖는다. 그 값들은 $X^2=5.3$과 $G^2=6.2$이다. 표 5.2는 각 너비 설정에 대해 하나씩, 8개의 이항 표본을 갖는다; 모델은 두 개의 모수를 가지므로, df=8-2=6이다. $X^2$과 $G^2$ 모두 적합성 결여의 증거를 보이지 않는다 ($P>0.4$). 따라서, 우리는 원래의 비그룹화 데이터에 대해 모델을 사용하는 것에 대해 더 편안하게 느낄 수 있다.

설명 변수의 수가 증가함에 따라, 이 전략은 효과를 잃는다. 각 변수에 대한 값들을 동시에 그룹화하면, 대부분이 매우 작은 빈도를 갖는 많은 수의 셀을 가진 분할표를 생성할 수 있다.

... (호스머-레머쇼 검정 설명 생략) ...

### 5.2.6 왈드 추론은 차선일 수 있음 (Wald Inference Can Be Suboptimal)

[원문 번역]

왈드, 우도비, 스코어 추론 방법들은 보통 대푯본에 대해 비슷한 결과를 준다. ... 이 방법들이 보통 비슷한 결과를 주지만, 왈드 방법은 우도비 및 스코어 방법과 비교할 때 두 가지 단점을 갖는다. 첫째, 그 결과는 모수화(parameterization)의 척도에 의존한다. ...

왈드 통계량의 이러한 거동은 또 다른 단점을 반영한다. 실제 효과가 상대적으로 클 때, 왈드 검정은 우도비 및 스코어 검정만큼 강력하지 않으며 심지어 비정상적인 거동을 보일 수 있다 (Hauck and Donner 1977). 방금 기술한 단일-이항 사례에 대해, 예를 들어, $n=25$라고 가정하자. 우리는 $y=24$가 $y=23$보다 $H_0$에 대한 더 강한 증거라고 간주할 것이다. 그러나 로짓 왈드 통계량은 $y=24$일 때 9.7이고 $y=23$일 때 11.0이다. 비교를 위해, 우도비 통계량은 26.3과 20.7이다.

더 일반적으로, Hauck과 Donner는 고정된 표본 크기에 대해, 로지스틱 모델에서 $H_0: \beta=0$을 검정하기 위한 왈드 통계량은 $\hat{\beta}$가 무한히 커짐에 따라 결국 감소하기 시작하여 실제로 0으로 수렴함을 보였다. 유사한 결과는 다중 예측 변수를 갖는 로지스틱 모델에서도 성립한다.

---

### 핵심 내용 해설

이 섹션들은 모델을 만든 후, 그 모델이 데이터에 정말 잘 맞는지를 평가하는 적합도 검정(Goodness-of-Fit, GOF)의 방법들과, 세 가지 추론 방법 중 왈드 추론이 가진 내재적 한계에 대해 논의합니다.

#### 5.2.3 ~ 5.2.5: 모델이 데이터를 잘 설명하는가?

모델이 아무리 그럴듯해 보여도, 데이터가 모델의 가정을 따르지 않으면 그 모델로부터의 추론은 신뢰할 수 없습니다.

적합도 검정의 두 가지 접근법:

1.  모델 비교 접근법 (더 복잡한 모델과의 비교)
    *   아이디어: "내 모델($M_0$)보다 더 복잡한(유연한) 모델($M_1$)을 만들었을 때, 설명력이 통계적으로 유의미하게 좋아지는가?"
    *   방법: $M_1$과 $M_0$의 이탈도의 차이($D(M_0) - D(M_1)$)를 계산하고, 이를 카이제곱 검정(자유도=두 모델의 모수 개수 차이)으로 평가한다.
    *   투구게 예제: 선형 모델($M_0$)에 이차항($x^2$)을 추가한 모델($M_1$)을 만들었더니, 우도비 통계량(이탈도 차이)이 0.83 (df=1)으로 매우 작았다. $\implies$ "굳이 모델을 복잡하게 만들 필요가 없다. 원래의 선형 모델로 충분하다."

2.  전체 적합도 검정 (포화 모델과의 비교)
    *   아이디어: "내 모델이 데이터의 변동성을 얼마나 잘 설명하는가? 설명하지 못하는 부분이 우연으로 보기에는 너무 큰가?"
    *   방법: 모델의 이탈도($G^2$) 또는 피어슨 통계량($X^2$)을 계산하고, 이를 잔차 자유도를 갖는 카이제곱 분포와 비교한다.
    *   치명적인 제약: 이 방법은 예측 변수 값의 조합(설정)이 몇 개 안 되는 그룹화된 데이터에만 적용 가능하다. 예측 변수가 연속형이거나, 범주형이라도 조합이 너무 많아 각 조합에 해당하는 데이터가 거의 없는 비그룹화 데이터에는 카이제곱 근사가 성립하지 않는다.
    *   해결책 (5.2.5): 연속형 변수를 몇 개의 구간으로 인위적으로 그룹화하여, 그룹화된 데이터처럼 만든 후 $X^2$ 또는 $G^2$을 계산한다.
        *   투구게 예제: 너비 값을 8개 구간으로 묶어 $8 \times 2$ 표를 만들었다. 이 표에 대한 $X^2=5.3, G^2=6.2$ (df=6)는 P-값이 0.4보다 커서 통계적으로 유의하지 않았다. $\implies$ "모델이 데이터와 잘 맞는 것 같다."

#### 5.2.6: 왈드 추론의 배신

*   문제 1 (척도 의존성): 왈드 검정/신뢰구간은 모수를 어떤 척도(예: $\pi$ vs. $\text{logit}(\pi)$)에서 계산하느냐에 따라 결과가 달라진다. 이는 비논리적이다.
*   문제 2 ( Hauck-Donner 현상): 가장 심각한 문제.
    *   직관: 효과가 매우 클수록($\hat{\beta}$의 절댓값이 커질수록), 검정 통계량 값도 계속 커져서 유의하다는 증거가 더 강력해져야 한다.
    *   왈드 검정의 이상 행동: 로지스틱 회귀에서, 효과($\hat{\beta}$)가 어느 수준을 넘어 극단적으로 커지면, 왈드 통계량($z=\hat{\beta}/\text{SE}$)은 오히려 감소하기 시작하여 0으로 수렴한다!
        *   이유: $\hat{\beta}$가 매우 커지면(예: 데이터가 완벽하게 분리될 때), 표준오차(SE)가 $\hat{\beta}$보다 더 빠른 속도로 커지기 때문이다.
    *   결과: 효과가 매우 강력해서 통계적으로 매우 유의미해야 할 상황에서, 왈드 검정은 오히려 "효과가 유의미하지 않다"는 역설적인 결론을 내릴 수 있다.
*   결론: 이러한 이유로, 왈드 추론은 계산이 간단하다는 장점에도 불구하고 우도비(LR) 추론이나 스코어 추론보다 신뢰성이 떨어진다(suboptimal). 특히 효과가 크거나 표본이 작을 때는 왈드 방법의 결과를 의심해봐야 하며, 가능하면 LR 테스트나 프로파일 우도 신뢰구간을 사용하는 것이 훨씬 더 안전하고 신뢰할 수 있다.
