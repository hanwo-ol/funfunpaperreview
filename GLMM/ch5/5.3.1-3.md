### 5.3 범주형 예측 변수를 갖는 로지스틱 모델 (LOGISTIC MODELS WITH CATEGORICAL PREDICTORS)

[원문 번역]

보통의 회귀분석처럼, 로지스틱 회귀는 질적 설명 변수, 즉 흔히 요인(factors)이라고 불리는 변수들을 포함하도록 확장된다. Dyke와 Patterson(1952)이 처음 언급했듯이, 우리는 이를 위해 지시 변수(indicator variables)를 사용한다.

#### 5.3.1 요인의 분산분석(ANOVA) 형태 표현 (ANOVA-Type Representation of Factors)

[원문 번역]

단순화를 위해, 우리는 먼저 $I$개의 범주를 갖는 단일 요인 X를 고려한다. $I \times 2$ 표의 행 $i$에서, $y_i$를 $n_i$번의 시행 중 첫 번째 열(성공)에 속하는 결과의 수라고 하자. 우리는 $y_i$를 모수 $\pi_i$를 갖는 이항 변수로 취급한다.

단일 요인을 예측 변수로 갖는 로지스틱 회귀 모델은 다음과 같다.

$$ \log\left(\frac{\pi_i}{1-\pi_i}\right) = \alpha + \beta_i \quad (5.4) $$

$\beta_i$가 높을수록, $\pi_i$의 값도 높다. (5.4)의 우변은 일원 분산분석(one-way ANOVA)의 평균에 대한 모델 공식과 유사하다.

분산분석에서처럼, 요인은 범주만큼 많은 모수 $\{\beta_i\}$를 갖는다. 만약 모델에서 $\alpha$를 삭제하지 않는 한, 하나의 $\beta_i$는 중복(redundant)된다. 하나의 $\beta_i$는 0으로 설정될 수 있는데, 가령 마지막 범주에 대해 $\beta_I=0$으로 둔다. 만약 값들이 이를 만족하지 않으면, 우리는 그것이 사실이 되도록 재코딩할 수 있다. 예를 들어, $\tilde{\beta}_i = \beta_i - \beta_I$ 그리고 $\tilde{\alpha} = \alpha + \beta_I$로 설정하면, $\tilde{\beta}_I=0$을 만족한다. 그러면

$$ \text{logit}(\pi_i) = \alpha + \beta_i = (\tilde{\alpha}-\beta_I) + (\beta_i+\beta_I) = \tilde{\alpha} + \tilde{\beta}_i $$

이며, 여기서 새로 정의된 모수들은 제약을 만족한다. $\beta_I=0$일 때, $\alpha$는 행 $I$에서의 로짓과 같고, $\beta_i$는 행 $i$와 행 $I$의 로짓 간의 차이이다. 따라서, $\beta_i$는 그 두 행 쌍에 대한 로그 오즈비와 같다.

어떤 $\{\pi_i>0\}$에 대해서든, 모델 (5.4)가 성립하도록 하는 $\{\beta_i\}$가 존재한다. 이 모델은 이항 관측치만큼 많은 모수($I$개)를 가지며 포화(saturated)되어 있다. 요인에 효과가 없을 때, $\beta_1=\beta_2=\dots=\beta_I$이다. 이것은 $\pi_1=\dots=\pi_I$와 동등하므로, 이 경우는 X와 Y의 통계적 독립성에 해당한다.

#### 5.3.2 지시 변수가 요인을 표현함 (Indicator Variables Represent a Factor)

[원문 번역]

모델 (5.4)의 동등한 표현은 지시 변수(indicator variables)를 사용한다. $x_i=1$을 행 $i$의 관측치에 대해, 그 외에는 $x_i=0$이라고 하자, $i=1, \dots, I-1$. 모델은

$$ \text{logit}(\pi_i) = \alpha + \beta_1 x_1 + \beta_2 x_2 + \dots + \beta_{I-1}x_{I-1} $$

이다. 이것은 범주 $I$에 대한 지시 변수를 만들지 않음으로써 모수 중복성을 설명한다. 제약 $\beta_I=0$은 이 지시 변수 선택에 해당한다. 지시 변수에서 제외할 범주는 임의적이다. 일부 소프트웨어는 $\beta_1=0$으로 설정한다; 이것은 범주 2부터 $I$까지에 대한 지시 변수를 갖지만 범주 1은 아닌 모델에 해당한다.

제약을 부과하는 또 다른 방법은 $\sum_i \beta_i=0$으로 설정하는 것이다. X가 $I=2$개의 범주를 가질 때, 그러면 $\beta_1=-\beta_2$이다. 이것은 지시 변수에 대한 효과 코딩(effect coding)으로부터 나오며, 범주 1에서는 $x=1$, 범주 2에서는 $x=-1$이다.

어떤 코딩 방식을 사용하든 추정 가능한 효과에 대한 동일한 실질적인 결과가 나온다. 모델 (5.4)에 대해, $\{\beta_i\}$에 대한 제약과 무관하게, 선형 예측자 값 $\{\hat{\alpha}+\hat{\beta}_i\}$와 그에 따른 $\{\hat{\pi}_i\}$는 동일하다. X의 범주 쌍 $(a, b)$에 대한 차이 $\hat{\beta}_a - \hat{\beta}_b$는 동일하며 추정된 로그 오즈비를 나타낸다. 따라서, $\exp(\hat{\beta}_a - \hat{\beta}_b)$는 X의 범주 $b$에서의 성공의 추정된 오즈로 나눈 X의 범주 $a$에서의 성공의 추정된 오즈이다. 모델을 재모수화하는 것은 모수 추정치를 바꿀 수 있지만, 모델 적합도나 관심 효과를 바꾸지는 않는다.

단일 범주에 대한 $\beta_i$ 또는 $\hat{\beta}_i$ 값은 무관하다. 다른 제약 시스템은 다른 값들을 낳는다. 예를 들어, 이항 예측 변수에 대해, 기준값 $\beta_2=0$을 갖는 지시 변수를 사용하면, 로그 오즈비는 $\beta_1-\beta_2=\beta_1$과 같다; 대조적으로, $\pm 1$ 지시 변수를 사용하는 효과 코딩과 그에 따른 $\beta_1+\beta_2=0$에 대해, 로그 오즈비는 $\beta_1-\beta_2=\beta_1-(-\beta_1)=2\beta_1$과 같다. 모수 또는 그 추정치는 다른 범주와의 비교를 통해서만 의미를 갖는다.

#### 5.3.3 예제: 알코올과 영아 기형 재검토 (Example: Alcohol and Infant Malformation Revisited)

[원문 번역]

우리는 이제 다시 표 5.3에 보인, 산모의 알코올 소비와 아이의 선천성 기형에 대한 연구의 표 3.8로 돌아간다. 모델 (5.4)에 대해, 우리는 기형 상태를 반응으로, 알코올 소비를 설명 요인으로 취급한다. $\{\beta_i\}$에 대한 제약과 무관하게, 이 모델은 포화되어 있으며 $\{\hat{\alpha}+\hat{\beta}_i\}$는 표 5.3에 보고된 표본 로짓이다. 예를 들어,

$$ \text{logit}(\hat{\pi}_1) = \hat{\alpha}+\hat{\beta}_1 = \log(48/17,066) = -5.87 $$

$\beta_5=0$을 제약하는 코딩에 대해, $\hat{\alpha}=-3.61$이고 $\hat{\beta}_1=-2.26$이다. $\beta_1=0$ 코딩에 대해, $\hat{\alpha}=-5.87$이다. 표 5.3은 알코올 소비의 첫 번째와 두 번째 범주 사이의 약간의 반전을 제외하고, 표본 로짓과 그에 따른 기형 사례의 표본 비율이 알코올 소비가 증가함에 따라 증가함을 보여준다.

---

### 핵심 내용 해설: 숫자가 아닌 변수를 다루는 법

이 섹션들은 로지스틱 회귀 모델의 예측 변수($x$)가 "너비"나 "나이" 같은 숫자가 아니라, "직업"이나 "혈액형" 같은 범주형(categorical) 변수일 때 어떻게 모델을 구성하는지를 설명합니다.

#### 5.3.1 & 5.3.2: 범주를 숫자로 바꾸는 마법, "지시 변수(Indicator Variables)"

*   문제: 회귀 모델($\alpha+\beta x$)의 $x$ 자리에는 숫자가 들어가야 한다. "A형", "B형" 같은 문자를 직접 넣을 수는 없다.
*   해결책 1 (ANOVA 형태): 각 범주($i$)마다 고유한 효과($\beta_i$)를 갖는다고 가정한다.

$$ \text{logit}(\pi_i) = \alpha + \beta_i $$

*   문제점 (중복성): $I$개의 범주에 대해, $\alpha$와 $\beta_1, \dots, \beta_I$까지 총 $I+1$개의 모수가 있다. 하지만 우리가 설명하려는 것은 $I$개의 로짓($\text{logit}(\pi_i)$) 뿐이다. 모수가 데이터가 가진 정보보다 많아서 해가 유일하게 결정되지 않는다. 이를 과잉모수화(overparameterized)되었다고 한다.

*   해결책 2 (지시 변수, Indicator Variables): 중복성을 해결하기 위해, 범주형 변수를 여러 개의 가변수(dummy variables) 또는 지시 변수로 변환한다.
    1.  기준 범주(Reference Category) 선택: $I$개의 범주 중 하나를 '기준'으로 정한다 (예: 마지막 범주 $I$).
    2.  지시 변수 생성: 나머지 $I-1$개의 범주에 대해 지시 변수($x_1, \dots, x_{I-1}$)를 만든다.
        *   $x_1 = 1$ (범주 1일 때), 0 (그 외)
        *   $x_2 = 1$ (범주 2일 때), 0 (그 외)
        *   ...
    3.  모델 구성: 이 $I-1$개의 지시 변수를 모델에 포함시킨다.

$$ \text{logit}(\pi) = \alpha + \beta_1 x_1 + \dots + \beta_{I-1}x_{I-1} $$

#### 계수($\alpha, \beta$)의 해석

이 지시 변수 코딩 방식 하에서, 모델 계수들은 매우 직관적인 의미를 갖습니다. (마지막 범주 $I$를 기준으로 가정)

*   절편($\alpha$): 모든 $x_j=0$일 때의 로짓. 즉, 기준 범주($I$)의 로그 오즈이다.
    *   $\alpha = \text{logit}(\pi_I)$
*   기울기($\beta_j$): $x_j=1$일 때(즉, 범주 $j$일 때)의 로짓과, 기준 범주($I$)일 때의 로짓 간의 차이이다.
    *   범주 $j$의 로짓: $\text{logit}(\pi_j) = \alpha + \beta_j$
    *   기준 범주 $I$의 로짓: $\text{logit}(\pi_I) = \alpha$
    *   따라서, $\beta_j = \text{logit}(\pi_j) - \text{logit}(\pi_I)$
    *   이것은 범주 $j$와 기준 범주 $I$ 간의 로그 오즈비이다.
    *   $e^{\beta_j}$는 범주 $I$에 비해 범주 $j$의 오즈가 몇 배인지를 나타내는 오즈비가 된다.

중요한 점:
*   어떤 범주를 기준으로 선택하느냐에 따라 $\alpha$와 $\beta_j$의 값은 달라지지만, 모델의 적합도($\hat{\pi}_i$)나 범주 간의 오즈비($e^{\beta_a - \beta_b}$)와 같은 실질적인 결과는 절대 변하지 않습니다.
*   개별 $\beta_j$ 값 자체는 "기준 범주와의 비교"라는 의미 외에는 절대적인 의미가 없습니다.

#### 5.3.3: 예제 적용

*   알코올 소비라는 5개 범주를 갖는 예측 변수를 모델링합니다.
*   포화 모델(Saturated Model): 이 모델은 5개의 범주에 대해 5개의 모수($\alpha, \beta_1, \dots, \beta_4$, 단 $\beta_5=0$)를 사용합니다. 이는 우리가 가진 정보(5개의 표본 비율 $\hat{\pi}_i$)와 모수의 개수가 같으므로, 모델은 데이터에 완벽하게 들어맞습니다.
*   결과: 모델의 적합치($\hat{\alpha}+\hat{\beta}_i$)는 각 범주의 표본 로짓($\log(\frac{y_i}{n_i-y_i})$)과 정확히 일치하게 됩니다.
    *   $\beta_5=0$ 코딩: $\hat{\alpha} = \text{logit}(\hat{\pi}_5) = -3.61$, $\hat{\beta}_1 = \text{logit}(\hat{\pi}_1) - \text{logit}(\hat{\pi}_5) = -5.87 - (-3.61) = -2.26$.
    *   $\beta_1=0$ 코딩: $\hat{\alpha} = \text{logit}(\hat{\pi}_1) = -5.87$.
*   해석: 표본 로짓 값들이 알코올 소비가 증가함에 따라 (거의) 단조적으로 증가하는 경향을 보입니다. 이는 알코올 소비량이 많을수록 기형 발생 확률이 높아진다는 양의 연관성을 시사합니다.

결론: 범주형 예측 변수는 지시 변수(dummy variables)를 통해 로지스틱 회귀 모델에 쉽게 통합될 수 있습니다. 이때 회귀 계수 $\beta_j$는 기준 범주 대비 해당 범주의 로그 오즈비로 해석되며, 어떤 코딩 방식을 사용하더라도 모델의 본질적인 예측이나 효과의 크기는 변하지 않습니다.
