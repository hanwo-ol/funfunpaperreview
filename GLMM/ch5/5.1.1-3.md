### 5.1.1 β 해석하기: 오즈, 확률, 그리고 선형 근사 (Interpreting β: Odds, Probabilities, and Linear Approximations)

[원문 번역]

(5.2)에서 $\beta$를 어떻게 해석할 수 있을까? 그것의 부호는 $x$가 증가함에 따라 $\pi(x)$가 증가하는지 감소하는지를 결정한다. 곡선의 상승 또는 하강률은 $|\beta|$가 증가함에 따라 증가한다; $\beta \to 0$이 되면 곡선은 수평 직선으로 평평해진다. $\beta=0$일 때, Y는 X와 독립이다. $\beta>0$인 양적 변수 $x$에 대해, $\pi(x)$ 곡선은 로지스틱 분포의 cdf 모양을 갖는다 (4.2.5절 참조). 로지스틱 밀도함수는 대칭적이므로, $\pi(x)$는 0에 접근하는 것과 동일한 속도로 1에 접근한다.

(5.2)의 양변을 지수 변환하면 오즈가 $x$의 지수 함수임을 보여준다. 이것은 $\beta$의 크기에 대한 기본적인 해석을 제공한다: $x$가 1-단위 증가할 때마다 오즈는 $e^\beta$배 곱해진다. 다른 말로, $e^\beta$는 $X=x+1$에서의 오즈를 $X=x$에서의 오즈로 나눈 오즈비이다.

많은 과학자들은 오즈나 로짓에 익숙하지 않으므로, 오즈 척도에서의 곱셈 효과 $e^\beta$나 로짓 척도에서의 덧셈 효과 $\beta$의 해석은 그들에게 도움이 되지 않는다. 더 간단한 기울기 해석은 선형화 논증을 사용한다 (Berkson 1951). 선형이 아닌 곡선 형태를 가지므로, 로지스틱 회귀 함수 (5.1)는 $x$의 단위 변화당 $\pi(x)$의 변화율이 변함을 의미한다. 그림 5.1에 보이는 것처럼, 특정 $x$ 값에서 곡선에 그려진 접선은 그 지점에서의 순간 변화율(instantaneous rate of change)을 기술한다. (5.1)로 $d\pi(x)/dx$를 계산하면 매개변수와 $x$의 꽤 복잡한 함수가 나오지만, 그것은 $\beta\pi(x)[1-\pi(x)]$ 형태로 단순화된다.

예를 들어, $\pi(x)=1/2$인 $x$에서 곡선에 대한 접선은 기울기 $\beta(1/2)(1/2) = \beta/4$를 갖는다; $\pi(x)=0.9$ 또는 0.1일 때, 그것은 기울기 $0.09\beta$를 갖는다. 기울기는 $\pi(x)$가 1.0 또는 0에 접근함에 따라 0에 접근한다. 가장 가파른 기울기는 $\pi(x)=1/2$인 $x$에서 발생한다; 그 $x$ 값은 $x=-\alpha/\beta$이다.

이 선형 근사로부터, $\pi(x)=1/2$인 $x$ 근처에서, $x$의 $1/\beta$ 만큼의 변화는 $\pi(x)$에서 대략 $(1/\beta)(\beta/4)=1/4$ 만큼의 변화에 해당한다; 즉, $1/\beta$는 $\pi(x)=0.50$인 $x$ 값과 $\pi(x)=0.25$ 또는 $0.75$인 $x$ 값 사이의 거리를 근사한다 (실제로는 0.27과 0.73). 선형 근사는 $x$의 더 작은 변화에 대해 더 잘 작동한다. 변화율이 $x$의 값에 따라 변하므로, 그것들의 요약은 표본의 피험자들에 대한 $\beta\pi(x _i)[1-\pi(x _i)]$의 평균이다.

효과를 해석하는 대안적인 방법은 최소값과 최대값과 같은, 특정 $x$ 값들에서 $\pi(x)$의 값을 보고하는 것이다. ...

### 5.1.2 데이터 살펴보기 (Looking at the Data)

[원문 번역]

실제 분석에서, 이러한 해석들은 모수 대신 ML 추정치를 대입한 공식 (5.1)을 사용한다. 모델을 적합시키고 그러한 해석을 하기 전에, 로지스틱 회귀 모델이 적절한지 확인하기 위해 데이터를 살펴보라. $y$는 0과 1의 값만 가지므로, 관측된 $(x, y)$ 값들의 일반적인 산점도로 이것을 확인하기는 어렵다.

$x$에 대해 표본 비율이나 로짓을 플로팅하는 것이 도움이 될 수 있다. $x$의 설정 $i$에서의 관측치 수를 $n _i$라고 하자. 그중, $y _i$를 "1" 결과의 수라고 하고, $p _i = y _i/n _i$라고 하자. 표본 로짓(sample logit) (또한 경험적 로짓, empirical logit) $i$는 $\log[p _i/(1-p _i)] = \log[y _i/(n _i-y _i)]$이다. 표본 로짓들의 산점도는 대략 선형이어야 한다. 표본 로짓은 $y _i=0$ 또는 $n _i$일 때 유한하지 않다. 임시방편적인 조정은 두 유형의 결과 수에 양의 상수를 더하는 것이다. 조정

$$ \log\frac{y _i+1/2}{n _i-y _i+1/2} $$

은 실제 로짓에 대해 이러한 형태의 가장 편향이 적은 추정량이다 (주석 5.2 참조).

$x$가 연속이고 모든 $n _i=1$이거나, $x$가 본질적으로 연속이고 모든 $n _i$가 작을 때, 이것은 만족스럽지 않다. 우리는 표본 비율과 표본 로짓을 계산하기 전에 가까운 $x$ 값들을 가진 데이터를 범주로 묶을 수 있다. 임의의 범주를 선택할 필요가 없는 더 나은 접근법은 추세를 드러내기 위해 평활화(smoothing) 메커니즘을 사용하는 것이다. 한 가지 그러한 평활화 접근법은 GLM의 선형 예측자를 평활 함수로 대체하는 일반화 가법 모델(generalized additive model, GAM)을 적합시키는 것이다 (7.4.9절에서 소개될 예정). 이 적합의 플롯은 로지스틱 회귀가 예측하는 S자형 추세로부터 심각한 불일치가 발생하는지를 드러낸다.

### 5.1.3 예제: 투구게의 짝짓기 재검토 (Example: Horseshoe Crab Mating Revisited)

[원문 번역]

로지스틱 회귀를 설명하기 위해, 4.3.2절에서 소개된 투구게 데이터를 재분석한다. 이항 반응은 암컷 게가 근처에 거주하는 수컷 게(위성)를 가지고 있는지 여부이다. 게 $i$에 대해, 그녀가 적어도 하나의 위성을 가지고 있으면 $y _i=1$이고, 없으면 $y _i=0$이다. 여기서, 우리는 예측 변수로 암컷 게의 등딱지 너비를 사용한다.

그림 5.2는 $x$=너비에 대해 데이터를 플로팅한다. 산점도는 $y _i=1$인 점들의 집합과 $y _i=0$인 두 번째 점들의 집합으로 구성된다. ... $y _i=1$이 더 높은 $x$ 값에서 상대적으로 더 자주 발생하는 것으로 보인다; 사실, 너비가 29cm보다 큰 모든 게들은 위성을 가지고 있다. ... 여덟 개의 너비 범주 각각에 대해, 우리는 위성을 가진 게의 표본 비율과 그 범주 내 게들의 평균 너비를 계산했다. 그림 5.2는 여덟 개의 범주에 대한 평균 너비에 대해 플로팅된 위성을 가진 암컷 게의 표본 비율을 나타내는 여덟 개의 점을 보여준다. 그림 5.2는 또한 이항 반응과 로짓 연결을 가정하는 일반화 가법 모델링 방법을 사용하여 데이터를 평활화한 것에 기반한 곡선을 보여준다. 이 곡선은 대략적인 증가 추세를 보여주며, 이진 데이터만 보는 것보다 더 유익한 정보를 제공한다. 이는 S자형 회귀 함수가 이 관계를 비교적 잘 설명할 수 있음을 시사한다. 여덟 개의 플로팅된 표본 비율과 GAM 평활화 곡선 모두 증가 추세를 시사하므로, 우리는 선형 너비 예측 변수를 갖는 로지스틱 회귀 모델을 적합시키는 것을 진행한다.

---

### 핵심 내용 해설

이 섹션들은 로지스틱 회귀 모델의 심장부, 즉 회귀계수 $\beta$를 어떻게 해석하고, 모델을 적용하기 전에 데이터가 모델 가정에 부합하는지를 어떻게 시각적으로 탐색하는지에 대해 설명합니다.

#### 5.1.1: $\beta$를 해석하는 세 가지 방법

로지스틱 회귀 모델 $\text{logit}[\pi(x)] = \alpha + \beta x$에서, $\beta$는 확률($\pi$)에 직접적인 영향을 주지 않기 때문에 해석이 까다롭습니다.

방법 1: 오즈비(Odds Ratios)를 이용한 해석 (가장 정확하고 표준적인 방법)
*   모델의 양변에 지수($e^x$)를 취하면, $\frac{\pi(x)}{1-\pi(x)} = e^{\alpha+\beta x} = e^\alpha (e^\beta)^x$ 가 됩니다.
*   이는 "x가 1단위 증가할 때마다, 성공의 오즈(odds)가 $e^\beta$ 배가 된다"는 것을 의미합니다.
*   $e^\beta$가 바로 오즈비입니다.
    *   $\beta > 0 \implies e^\beta > 1$: x가 증가하면 성공 오즈가 증가 (양의 연관성).
    *   $\beta < 0 \implies e^\beta < 1$: x가 증가하면 성공 오즈가 감소 (음의 연관성).
    *   $\beta = 0 \implies e^\beta = 1$: x가 변해도 오즈가 변하지 않음 (독립).

방법 2: 확률의 순간 변화율 (선형 근사)
*   아이디어: S자 곡선은 구부러져 있지만, 아주 짧은 구간을 확대해서 보면 거의 직선처럼 보입니다. 이 "접선의 기울기"를 이용해 $\beta$를 해석하는 것입니다.
*   순간 변화율 (기울기): $\frac{d\pi(x)}{dx} = \beta\pi(x)[1-\pi(x)]$
*   해석:
    *   이 기울기는 $\pi(x)$ 값에 따라 변합니다.
    *   $\pi(x)=0.5$일 때 최대 기울기를 가집니다 (기울기 = $\beta/4$). 즉, 불확실성이 가장 클 때 $x$의 변화가 확률에 가장 큰 영향을 미칩니다.
    *   $\pi(x)$가 0 또는 1에 가까워지면 기울기는 0에 가까워집니다. 즉, 거의 확실한 상황에서는 $x$가 변해도 확률은 거의 변하지 않습니다.
*   용도: 특정 확률 지점(예: $\pi(x)=0.5$)에서 "$x$가 1단위 변할 때 확률 $\pi(x)$가 대략 $\beta/4$만큼 변한다"고 근사적으로 설명할 때 유용합니다.

방법 3: 특정 $x$값에서의 확률 계산
*   아이디어: 가장 직관적인 방법. 모델에 특정 $x$값들(예: 평균, 사분위수, 최솟값/최댓값)을 직접 대입하여 예측 확률 $\hat{\pi}(x)$를 계산하고 비교합니다.
*   예시: "x가 하위 사분위수에서 상위 사분위수로 변할 때, 성공 확률은 0.2에서 0.7로 0.5만큼 증가했다."
*   장점: 오즈나 로짓 같은 어려운 개념 없이도 효과의 크기를 쉽게 전달할 수 있습니다.

#### 5.1.2 & 5.1.3: 모델 적합 전, 데이터를 시각화하라

*   문제: 이항 데이터(0과 1)는 산점도를 그려도 모든 점이 y=0 또는 y=1 선에 몰려있어 추세를 파악하기 어렵습니다.
*   해결책 1 (그룹화):
    *   연속형 $x$를 몇 개의 구간(예: 너비 범주)으로 나눕니다.
    *   각 구간 내에서 성공/실패 데이터를 요약하여 표본 비율(sample proportions)을 계산합니다.
    *   이 표본 비율을 $x$의 평균값(또는 중간값)에 대해 플로팅합니다.
    *   투구게 예제(그림 5.2)에서 8개의 점이 바로 이 표본 비율을 나타냅니다. 이 점들이 대략적인 S자 형태를 띠는지 확인합니다.
*   해결책 2 (평활화, Smoothing):
    *   그룹화는 구간을 어떻게 나눌지에 대한 자의적인 선택이 필요합니다.
    *   평활화는 이러한 단점 없이 데이터의 기저에 있는 추세를 유연한 곡선으로 보여주는 기법입니다. (예: GAM, Loess)
    *   투구게 예제(그림 5.2)의 'Smoothing curve'가 바로 이것입니다. 이 곡선이 대략적인 S자 형태를 보이는지 확인하면, 로지스틱 회귀 모델이 적절한 선택임을 시각적으로 뒷받침할 수 있습니다.

결론: 로지스틱 회귀의 계수 $\beta$는 오즈비로 해석하는 것이 가장 표준적이지만, 대중에게 설명할 때는 특정 값에서의 확률 변화나 순간 변화율을 이용하는 것이 더 효과적일 수 있습니다. 모델을 적합하기 전에는 반드시 데이터를 그룹화하거나 평활화하여 산점도를 그려봄으로써, 데이터가 S자 형태의 추세를 따르는지 시각적으로 탐색하는 것이 매우 중요합니다.
