### 5.1.4 후향적 연구에서의 로지스틱 회귀 (Logistic Regression with Retrospective Studies)

[원문 번역]

로지스틱 회귀의 또 다른 속성은 반응 변수 Y가 아닌 설명 변수 X가 무작위인 상황과 관련이 있다. 이것은 환자-대조군 생의학 연구와 같은 후향적 표집 설계에서 발생한다. $y=1$인 피험자(환자군)와 $y=0$인 피험자(대조군)의 표본에 대해, X의 값이 관찰된다. 만약 X 값의 분포가 환자군과 대조군 사이에 다르다면 연관성의 증거가 존재한다. 후향적 연구에서, 우리는 오즈비를 추정할 수 있다. 로지스틱 회귀 모델의 효과는 오즈비를 참조한다. 우리는 환자-대조군 연구에서 그러한 모델을 적합시키고 효과를 추정할 수 있다 (Breslow and Powers 1978, Prentice and Pyke 1979).

이에 대한 정당화는 다음과 같다. Z가 피험자가 표집되었는지 여부를 나타낸다고 하자 (1=예, 0=아니오). $p _1 = P(Z=1|y=1)$을 환자군을 표집할 확률, $p _0=P(Z=1|y=0)$를 대조군을 표집할 확률이라고 하자. 비록 $X=x$가 주어졌을 때 Y의 조건부 분포가 표집되지 않았더라도, 우리는 $P(Y=1|x)$가 로지스틱 모델을 따른다고 가정하고 $P(Y=1|z=1,x)$에 대한 모델이 필요하다. 베이즈 정리에 의해,

$$ P(Y=1|z=1, x) = \frac{P(Z=1|y=1,x)P(Y=1|x)}{\sum _{j=0}^1 [P(Z=1|y=j,x)P(Y=j|x)]} \quad (5.3) $$

이제, $y=0$과 1에 대해 $P(Z=1|y,x)=P(Z=1|y)$라고 가정하자; 즉, 각 $y$에 대해, 표집 확률은 $x$에 의존하지 않는다. ... 이 가정 하에서, (5.3)에 $p _1$과 $p _0$를 대입하고 분자와 분모를 $P(Y=0|x)$로 나누면, 우리는

$$ P(Y=1|z=1,x) = \frac{p _1 \exp(\alpha+\beta x)}{p _0 + p _1 \exp(\alpha+\beta x)} $$

를 얻는다. 그러면, 분자와 분모를 $p _0$로 나누고 $p _1/p _0 = \exp[\log(p _1/p _0)]$를 사용하면

$$ \text{logit}[P(Y=1|z=1,x)] = \alpha^* + \beta x $$

가 산출되며, 여기서 $\alpha^* = \alpha+\log(p _1/p _0)$이다. 로지스틱 회귀 모델은 $P(Y=1|x)$에 대한 모델과 동일한 효과 모수 $\beta$를 가지며 성립한다. 만약 환자군의 표집률이 대조군보다 높다면, 추정된 절편은 전향적 연구로 추정된 것보다 더 크다.

환자-대조군 연구에서는, 로짓 이외의 연결 함수를 갖는 이항-반응 모델에서 $\beta$를 추정하는 것이 불가능하다. 오즈비와 달리, $y$가 주어졌을 때 X의 조건부 분포에 대한 효과는 그때 $x$가 주어졌을 때 Y에 대한 효과와 같지 않다. 이것이 로짓 연결의 중요한 이점이며, 로지스틱 회귀 모델이 생의학 연구에서 매우 인기 있는 한 가지 이유이다.

### 5.1.5 정규분포 설명 변수가 로지스틱 회귀를 암시함 (Logistic Regression Is Implied by Normal Explanatory Variables)

[원문 번역]

표집 메커니즘과 무관하게, 로지스틱 회귀는 관계를 잘 설명할 수도 있고 그렇지 않을 수도 있다. 한 가지 특별한 경우에서는, 그것이 필연적으로 성립한다. $Y=i$가 주어졌을 때, X가 $N(\mu _i, \sigma^2)$ 분포를 갖는다고 가정하자, $i=0, 1$. 그러면, 베이즈 정리에 의해, $P(Y=1|X=x)$는 $\beta=(\mu _1-\mu _0)/\sigma^2$를 갖는 로지스틱 모델을 만족시킨다 (Cornfield 1962). 따라서, 한 모집단이 두 유형의 피험자들의 혼합일 때, 한 유형은 $y=1$이고 X에 대해 근사적으로 정규분포를 따르며 다른 유형은 $y=0$이고 유사한 분산을 가지며 X에 대해 정규분포를 따를 때, 로지스틱 회귀 함수는 $\pi(x)$ 곡선을 잘 근사한다.

그 결과는 각 경우에 다변량 정규분포를 갖는 설명 변수 벡터로 확장된다 (연습문제 5.30과 15.1.1절). 만약 분포들이 정규분포이지만 분산이 다르면, 모델은 적용되지만 이차항(quadratic term)을 갖는다. 그 경우, 관계는 비단조적이며, $\pi(x)$가 증가하다가 감소하거나 그 반대이다.

---

### 핵심 내용 해설

이 섹션들은 로지스틱 회귀가 단지 편리한 S자 곡선 모델을 넘어, 왜 그렇게 많은 다양한 상황에서 근본적으로 중요한지를 보여주는 두 가지 심오한 이론적 속성을 설명합니다.

#### 5.1.4: 후향적 연구의 불변성 - 오즈비의 또 다른 마법

*   핵심 결과: 환자-대조군(후향적) 연구에서 얻은 데이터로 로지스틱 회귀를 적합해도, 우리가 정말 알고 싶은 전향적 관계의 효과 모수($\beta$)를 정확하게 추정할 수 있다.
*   어떻게 가능한가?:
    1.  우리가 실제로 모델링하는 것은 $P(Y=1|Z=1, X=x)$ 입니다. 즉, "우리 표본에 포함되었고(Z=1), 설명변수 X의 값이 $x$일 때, 환자(Y=1)일 확률"입니다.
    2.  베이즈 정리를 통해 이 확률을 전개하고, "표집 확률이 X의 값에 의존하지 않는다"는 합리적인 가정을 하면 (즉, 흡연자 환자와 비흡연자 환자가 같은 확률로 표본에 뽑힌다고 가정), 수식이 놀랍게도 정리됩니다.
    3.  최종 결과:

$$ \text{logit}[\underbrace{P(Y=1|z=1,x)} _{\text{우리가 모델링하는 것}}] = \underbrace{(\alpha + \log(p _1/p _0))} _{\text{새로운 절편 } \alpha^*} + \underbrace{\beta x} _{\text{동일한 효과!}} $$

*   결론 및 의미:
    *   $\beta$는 불변: 후향적 연구에서 추정된 기울기 $\beta$는, 만약 우리가 엄청난 시간과 비용을 들여 전향적 연구를 수행했을 때 얻었을 기울기 $\beta$와 동일합니다. 따라서 오즈비($e^\beta$)도 동일합니다. 이것이 환자-대조군 연구가 비용 효율적으로 질병의 위험 요인을 연구할 수 있게 하는 핵심 원리입니다.
    *   $\alpha$는 변함: 절편 $\alpha$는 환자군과 대조군의 표집 비율($p _1/p _0$)에 따라 변합니다. 이는 후향적 연구에서는 전체 질병 발생률(prevalence)을 추정할 수 없다는 사실을 반영합니다.
    *   로짓 연결의 독보성: 이 놀라운 불변성은 오직 로짓 연결(logit link)에서만 성립합니다. 프로빗이나 다른 연결 함수를 사용하는 모델에서는 후향적 연구로 효과 $\beta$를 추정할 수 없습니다. 이것이 로지스틱 회귀가 생의학 연구에서 압도적인 표준 모델로 자리 잡은 가장 큰 이유 중 하나입니다.

#### 5.1.5: 정규분포 가정으로부터 로지스틱 회귀 유도하기

*   핵심 결과: 만약 설명 변수 X의 분포가 각 반응 그룹(Y=0, Y=1) 내에서 정규분포를 따른다면, 반응 확률 $\pi(x)=P(Y=1|X=x)$는 필연적으로 로지스틱 회귀 모델을 따른다.
*   가정:
    1.  $X | (Y=1) \sim N(\mu _1, \sigma^2)$ (환자 그룹의 X 분포는 정규분포)
    2.  $X | (Y=0) \sim N(\mu _0, \sigma^2)$ (정상 그룹의 X 분포는 정규분포)
    3.  두 그룹의 분산($\sigma^2$)이 동일하다.
*   어떻게 가능한가?:
    *   이것 역시 베이즈 정리의 결과입니다. $P(Y=1|X=x)$를 베이즈 정리를 이용해 $P(X=x|Y=1)$과 $P(X=x|Y=0)$ 등으로 표현하고, 여기에 정규분포의 확률밀도함수를 대입하여 식을 정리하면, 그 최종 형태가 정확히 로지스틱 회귀 공식이 됩니다.
    *   이때 기울기 $\beta = (\mu _1-\mu _0)/\sigma^2$ 로 주어집니다. 이는 두 그룹 평균 간의 거리(표준화된)가 클수록 효과($\beta$)가 커짐을 의미하며, 매우 직관적입니다.
*   실용적 의미:
    *   이 결과는 로지스틱 회귀 모델이 왜 그렇게 많은 실제 데이터에 잘 맞는지를 설명하는 이론적 근거를 제공합니다. 많은 생물학적, 사회적 측정값들이 근사적으로 정규분포를 따르기 때문입니다.
    *   이는 판별 분석(Discriminant Analysis)이라는 다른 통계 기법과 로지스틱 회귀 사이의 깊은 연관성을 보여줍니다.

종합 요약: 이 섹션들은 로지스틱 회귀가 단지 편리하기만 한 모델이 아님을 보여줍니다. 그것은 1) 연구 설계의 방향성(전향적/후향적)에 대해 불변이라는 강력한 속성을 가지며, 2) 설명 변수가 정규분포를 따른다는 매우 일반적인 조건 하에서 자연스럽게 유도되는 근본적인 모델입니다. 이러한 이론적 배경이 로지스틱 회귀를 범주형 데이터 분석에서 가장 중요하고 신뢰성 있는 도구로 만들었습니다.
