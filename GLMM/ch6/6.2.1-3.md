### 6.2.1 잔차: 피어슨, 이탈도, 표준화 잔차 (Residuals: Pearson, Deviance, and Standardized)

[원문 번역]

범주형 예측 변수와 함께일 때, 관측된 빈도와 적합된 빈도를 비교하기 위해 잔차를 형성하는 것이 유용하다. $y_i$를 설명 변수들의 설정 $i$에서의 $n_i$번 시행에 대한 이항 결과라고 하자, $i=1,\dots,N$. $\hat{\pi}_i$를 $P(Y=1)$의 모델 추정치라고 하자. 그러면 $\hat{\mu}_i = n_i\hat{\pi}_i$는 성공의 적합된 수이다.

이항 확률 성분을 갖는 GLM에 대해, 관측치 $i$에 대한 피어슨 잔차(Pearson residual) (4.41)은

$$ e_i = \frac{y_i - n_i\hat{\pi}_i}{\sqrt{\text{var}(Y_i)}} = \frac{y_i - n_i\hat{\pi}_i}{\sqrt{n_i\hat{\pi}_i(1-\hat{\pi}_i)}} \quad (6.1) $$

이다. 이것은 원시 잔차($y_i - \hat{\mu}_i$)를 $y_i$의 추정된 이항 표준편차로 나눈 것이다. 모델 적합도를 검정하기 위한 피어슨 통계량은 $X^2 = \sum_{i=1}^N e_i^2$를 만족한다.

대안적인 잔차는 $G^2$ 적합도 통계량의 성분들을 사용한다. 이것은 (4.42)에서 GLM에 대해 소개된 이탈도 잔차(deviance residual)이다. 이항 GLM에 대해, 이것은

$$ \sqrt{d_i} \times \text{sign}(y_i - n_i\hat{\pi}_i), \quad (6.2) $$

이며, 여기서

$$ d_i = 2\left[ y_i\log\left(\frac{y_i}{n_i\hat{\pi}_i}\right) + (n_i-y_i)\log\left(\frac{n_i-y_i}{n_i-n_i\hat{\pi}_i}\right) \right]. $$

4.5.6절에서 설명했듯이, 이것들과 $\{e_i\}$는 N(0, 1)보다 덜 변동적이다.

피어슨 잔차의 표준화된 버전은 그것을 그것의 추정된 표준오차로 나눈다. 4.5.6절에서 언급했듯이, 이것은 추정된 햇 행렬로부터의 레버리지(leverage)를 사용하는 조정을 통해 피어슨 잔차보다 크다. 관측치 $i$가 레버리지 $\hat{h}_i$를 가질 때, 표준화 잔차(standardized residual)는

$$ r_i = \frac{e_i}{\sqrt{1-\hat{h}_i}} = \frac{y_i - n_i\hat{\pi}_i}{\sqrt{n_i\hat{\pi}_i(1-\hat{\pi}_i)(1-\hat{h}_i)}} $$

이다. 이것은 모델이 성립할 때 근사적인 N(0, 1) 분포를 갖고 중복성을 적절히 인식한다는 점에서 (3.3.1절과 아래 6.2.3절에서 $2 \times 2$ 표에 대해 언급된 바와 같이) 피어슨 및 이탈도 잔차와 비교하여 장점을 갖는다. 대략 2 또는 3보다 큰 절댓값은 적합성 결여의 증거를 제공한다. 더 많은 잔차를 검사할수록 더 큰 값이 주목할 만하게 된다.

### 6.2.2 예제: 심장 질환과 혈압 (Example: Heart Disease and Blood Pressure)

[원문 번역]

매사추세츠 주 프레이밍햄의 40세에서 59세 사이의 남성 거주자 표본이 수축기 혈압을 포함한 여러 요인에 대해 분류되었다. 반응 변수는 그들이 6년의 추적 기간 동안 관상 동맥 심장 질환이 발병했는지 여부이다. 표 6.5는 결과를 보여준다.

$\pi_i$를 혈압 범주 $i$에 대한 심장 질환의 확률이라고 하자. 표는 두 로지스틱 회귀 모델에 대한 적합 결과와 표준화 잔차를 보여준다. 첫 번째 모델,

$$ \text{logit}(\pi_i) = \alpha $$

는 반응을 혈압과 독립으로 취급한다. 그 모델에 대한 일부 잔차는 크다. 모델이 형편없이 적합되기 때문에($G^2=30.02, X^2=33.38, \text{df}=7$), 이것은 놀랍지 않다. 독립성 모델에 대한 잔차의 플롯은 증가하는 추세를 보여준다. 이것은 선형 로짓 모델을 시사한다.

$$ \text{logit}(\pi_i) = \alpha + \beta x_i $$

수축기 혈압 수준에 대한 점수 $\{x_i\}$를 사용한다. 우리는 점수 (111.5, 121.5, ..., 191.5)를 사용했다. 극단이 아닌 점수들은 혈압 구간의 중간점이다. 표준화 잔차의 추세는 이 모델에 대해 사라지며, 오직 두 번째 범주만이 적합성 결여의 약간의 증거를 보인다. 하지만, 단 하나의 상대적으로 큰 잔차는 놀랍지 않다. 많은 잔차들이 있을 때, 몇 개는 단지 우연에 의해 클 수 있다. 여기서 전체 적합도 통계량 ($G^2=5.91, X^2=6.29$, df=6)은 문제를 나타내지 않는다. 잔차 패턴을 분석할 때, 우리는 패턴을 모델로부터의 우연한 변동일 수 있는 것에 귀인하는 것에 신중해야 한다.

### 6.2.3 예제: 플로리다 대학원 입학 (Example: Admissions to Graduate School at Florida)

[원문 번역]

표 6.6은 1997-1998 학년도 동안 플로리다 대학교 인문과학대학의 23개 학과에 대한 대학원 지원을 참조한다. 그것은 지원자의 성별, 그 또는 그녀가 지원한 학과, 그리고 우리가 반응 변수로 취급하는 그 또는 그녀의 합격 여부를 교차 분류한다. 학과 $k$의 성별 $i$에 대해, $y_{ik}$를 합격자 수라 하고 $\pi_{ik}$를 합격 확률이라 하자. 우리는 $\{Y_{ik}\}$를 독립적인 $\text{bin}(n_{ik}, \pi_{ik})$로 취급한다. 다른 모든 것이 같다면, 우리는 입학 결정이 성별과 독립적이기를 바랄 것이다. 학과가 주어졌을 때, 성별 효과가 없는 모델은

$$ \text{logit}(\pi_{ik}) = \alpha_k + \beta_i^G $$

이다. 하지만, 이 모델은 상당히 형편없이 적합된다 ($G^2=44.74, X^2=40.85$, df=23).

표 6.6의 소프트웨어 결과물은 합격한 여성 수에 대한 표준화 잔차 $\{r_i\}$를 보고한다. 예를 들어, 천문학과는 6명의 여성을 합격시켰는데, 이는 모델이 예측한 것보다 2.87 추정 표준편차만큼 더 높았다. 각 학과는 모델에 대한 주변 제약 때문에, 단 하나의 중복되지 않는 표준화 잔차만을 갖는다. ...

큰 표준화 잔차를 가진 학과들은 적합성 결여의 이유를 드러낸다. 천문학과 지리학과에서는 모델이 예측하는 것보다 유의하게 더 많은 여성이 합격했고, 심리학과에서는 더 적었다. 이 세 학과를 제외하면, 모델은 합리적으로 잘 맞는다 ($G^2=24.37, X^2=22.75$, df=20).

---

### 핵심 내용 해설: 모델의 약점을 찾아내는 현미경

전체적인 적합도 통계량($G^2, X^2$)은 모델이 전체적으로 잘 맞는지에 대한 "합격/불합격" 정보만 제공합니다. 잔차 분석(Residual Analysis)은 모델이 어디에서, 그리고 어떻게 잘못되었는지를 세밀하게 들여다보는 진단 도구입니다.

#### 6.2.1: 세 종류의 잔차

1.  피어슨 잔차 ($e_i$):
    *   정의: (관측값 - 적합값) / (추정된 표준편차)
    *   아이디어: 각 데이터 포인트의 오차를, 이항 분포 가정 하에서의 변동성으로 표준화.
    *   특징: $\sum e_i^2 = X^2$. 피어슨 카이제곱 통계량을 각 관측치의 기여도로 분해.
    *   단점: 이 잔차들의 분산은 1보다 작고 일정하지 않아, "얼마나 커야 큰 것인지"에 대한 명확한 기준이 없다.

2.  이탈도 잔차 (Deviance Residual):
    *   정의: 각 관측치가 전체 이탈도($G^2$)에 기여하는 정도를 나타내는 값.
    *   특징: $\sum (\text{deviance residual}_i)^2 = G^2$.
    *   단점: 피어슨 잔차와 마찬가지로 분산이 1이 아니다.

3.  표준화 잔차 ($r_i$): (가장 유용함)
    *   정의: (관측값 - 적합값) / (잔차의 실제 표준오차)

$$ r_i = \frac{y_i - \hat{\mu}_i}{\text{SE}(y_i-\hat{\mu}_i)} = \frac{e_i}{\sqrt{1-\hat{h}_i}} 

*   핵심: 분모에 레버리지($\hat{h}_i$)를 이용한 보정 항($\sqrt{1-\hat{h}_i}$)이 추가된다. 레버리지는 해당 관측치가 모델 적합에 얼마나 큰 영향을 미쳤는지를 나타낸다.
    *   장점:
        *   근사적으로 표준정규분포 $N(0,1)$를 따른다.
        *   따라서, 우리는 잔차의 크기를 판단하는 명확한 기준을 갖게 된다: 절댓값이 2 또는 3보다 크면 이례적인 값으로 간주할 수 있다.
    *   이것이 모델 진단에서 가장 선호되는 잔차이다.

#### 6.2.2 & 6.2.3: 잔차 분석의 실제

이 예제들은 잔차 분석을 통해 어떻게 모델의 문제점을 진단하고 개선하는지를 보여줍니다.

심장 질환 예제:
1.  독립성 모델($\text{logit}(\pi_i)=\alpha$): 적합 결과, 표준화 잔차들이 혈압이 높아짐에 따라 체계적으로 증가하는 추세를 보였다.
2.  진단: 이는 "혈압이 높을수록 모델이 실제보다 사망 위험을 과소평가하고 있다"는 의미이다. 즉, 혈압이라는 변수를 모델에 포함시켜야 한다는 강력한 신호이다.
3.  개선 모델($\text{logit}(\pi_i)=\alpha+\beta x_i$): 혈압을 예측 변수로 추가하자, 잔차의 추세가 사라지고 무작위적으로 흩어졌다.
4.  결론: 잔차 플롯은 모델에 누락된 중요한 패턴(여기서는 선형 추세)을 식별하는 데 매우 유용하다.

대학원 입학 예제:
1.  성별 효과 없는 모델($\text{logit}(\pi_{ik})=\alpha_k$): 전체적인 적합도($G^2=44.74$, df=23)가 나빴다.
2.  진단: 어디가 문제인가? 각 학과별 표준화 잔차를 살펴본다.
    *   천문학, 지리학: 크고 양(+)인 잔차. $\implies$ 이 학과들에서는 모델의 예측보다 여성이 훨씬 더 많이 합격했다.
    *   심리학: 크고 음(-)인 잔차. $\implies$ 이 학과에서는 모델의 예측보다 여성이 훨씬 더 적게 합격했다.
3.  결론: 전체적인 적합성 결여는 몇몇 특정 학과들에서 나타나는 이례적인 패턴 때문이었다. 이는 성별에 따른 합격률 차이가 모든 학과에서 동일한 방향으로 나타나는 것이 아니라, 학과에 따라 그 방향과 크기가 다르다는 상호작용(interaction)의 존재를 강력하게 시사한다. 단순하게 "성별 효과가 있다/없다"고 결론 내리는 것은 잘못된 분석이다.

종합 요약: 전체적인 적합도 통계량이 모델이 잘 맞지 않는다고 경고할 때, 표준화 잔차는 마치 현미경처럼 데이터의 어느 부분에서 문제가 발생하는지를 정확히 보여줍니다. 잔차의 크기는 적합이 나쁜 개별 관측치를 식별해주고, 잔차의 패턴은 모델에서 누락된 변수나 상호작용 항과 같은 구조적인 문제점을 진단하는 데 결정적인 단서를 제공합니다.
