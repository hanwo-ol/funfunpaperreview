### 6.4.8 통합성과 분할표의 로지스틱 모델 (Collapsibility and Logistic Models for Contingency Tables)

[원문 번역]

우리는 부분표에서의 조건부 연관성이 보통 주변 연관성과 다르다는 것을 보았다. 하지만, 2.3.6절에서 주어진 특정 통합성(collapsibility) 조건 하에서는, 그것들이 동일하다. 오즈비에 대해, 삼원 분할표에서, 만약 Z와 X가 조건부로 독립이거나 Z와 Y가 조건부로 독립이라면 XY 주변 오즈비와 조건부 오즈비가 동일함을 상기하라.

예를 들어, 한 임상시험이 K개의 센터(Z)로부터의 데이터를 사용하여 이항 치료 변수 X($x_1=1, x_2=0$)와 이항 반응 Y 간의 연관성을 연구한다고 가정하자. 로지스틱 모델 (6.4), 즉

$$ \text{logit}(\pi_{ik}) = \alpha + \beta x_i + \beta_k^Z, \quad i=1,2, \quad k=1,\dots,K \quad (6.9) $$

는 각 센터에 대해 동일한 치료 효과 $\beta$를 갖는다. 이 모델은 Z와 X 또는 Y의 조건부 연관성에 제한을 두지 않으므로, 이 효과는 $2 \times 2 \times K$ 표를 센터에 대해 합친 후에 달라질 수 있다. 추정된 XY 조건부 오즈비, $\exp(\hat{\beta})$는 보통 주변 $2 \times 2$ 표의 표본 오즈비와 다르다.

다음으로, 센터 효과가 없는 더 단순한 모델, $\text{logit}(\pi_{ik})=\alpha+\beta x_i$를 고려하자. 이것은 각 치료에 대해, 성공 확률이 각 센터에서 동일하다고 말한다. 이 모델은, X가 주어졌을 때 Z가 Y와 조건부로 독립이라고 말하기 때문에, XY 연관성에 대한 통합성 조건을 만족한다. 따라서, 센터 효과가 무시할 수 있고 더 단순한 모델이 거의 비슷하게 잘 맞는다면, 추정된 치료 효과는 대략 주변 XY 오즈비와 같다.

### 6.4.9 오즈비의 동질성 검정 (Testing Homogeneity of Odds Ratios)

[원문 번역]

$2 \times 2 \times K$ 표에 대한 균일 연관성 조건 $\theta_{XY(1)}=\dots=\theta_{XY(K)}$는 로지스틱 모델 (6.9)와 동등하다. 균일 연관성 검정은 암묵적으로 이 모델의 적합도 검정이다. 통상적인 $G^2$과 $X^2$ 검정 통계량은 df=$K-1$을 가지고 이것을 제공한다. 그들은 포화 모델에서 X에 대한 지시 변수와 Z의 범주에 대한 $(K-1)$개 지시 변수들의 교차곱인 상호작용 항들의 계수들이 모두 0인지를 검정한다.

표 6.9의 8개 센터 임상시험 데이터에 대해, $G^2=9.75$와 $X^2=8.03$ (df=7)은 동일한 오즈비의 가설과 모순되지 않는다. 8개 부분표 모두에 대해 단일 오즈비(예: $\hat{\theta}_{MH}=2.13$ 또는 $e^{\hat{\beta}}=2.17$)로 조건부 연관성을 요약하는 것이 합리적이다.

---

### 핵심 내용 해설

이 섹션들은 이전 섹션들에서 묘사적으로 다루었던 '통합성'과 '균일성'의 개념을 로지스틱 회귀 모델이라는 공식적인 프레임워크 안에서 어떻게 다루고 검정하는지를 보여줍니다.

#### 6.4.8: 통합성 - 언제 Z를 무시해도 안전한가?

*   배경: 심슨의 역설은 제3의 변수 Z를 무시하고 표를 합치면(주변 연관성을 보면) 결과가 왜곡될 수 있음을 보여주었습니다.
*   통합성(Collapsibility)의 질문: "그렇다면, 언제 Z를 무시하고 표를 합쳐도 안전한가? 즉, 언제 주변 오즈비 = 조건부 오즈비가 성립하는가?"
*   로지스틱 모델 관점에서의 재해석:
    1.  일반적인 상황 (균일 연관성 모델, 6.4/6.9)

$$ \text{logit}(\pi_{ik}) = \alpha + \beta x_i + \beta_k^Z $$

*   이 모델은 센터(Z)마다 다른 효과($\beta_k^Z$)가 있다고 가정합니다.
        *   이 모델은 Z가 X 또는 Y와 어떻게 관련되는지에 대해 아무런 제약을 두지 않기 때문에, 교란(confounding)이 발생할 수 있습니다.
        *   따라서, 이 모델에서 추정된 조건부 효과 $\beta$는, 데이터를 합쳐서 구한 주변 오즈비와 일반적으로 다릅니다.
    2.  특별한 상황 (Z 효과가 없는 모델)

$$ \text{logit}(\pi_{ik}) = \alpha + \beta x_i $$

*   이 모델은 훨씬 더 단순한 가정: "센터 효과($\beta_k^Z$)가 아예 없다. 즉, 성공 확률은 센터와 무관하다"를 의미합니다.
        *   이 가정은 "X가 주어진 상태에서 Y와 Z는 조건부로 독립이다"라는 2.3.6절의 통합성 조건과 정확히 일치합니다.
        *   결론: 만약 이 단순한 모델이 데이터에 잘 맞는다면, Z는 교란 변수가 아니며 통합성이 성립합니다. 이 경우, 이 모델에서 추정된 $\beta$는 주변 오즈비와 거의 같아집니다.

*   실용적 지침:
    *   두 모델(센터 효과 있는 모델 vs. 없는 모델)을 비교하여, 센터 효과가 유의미한지 확인합니다.
    *   만약 센터 효과가 무시할 만하다면(두 모델의 적합도 차이가 작다면), 더 단순한 모델을 선택하고 그 결과를 주변 오즈비처럼 해석할 수 있습니다.

#### 6.4.9: 동질성 검정 - 모든 층에서 효과가 정말 같은가?

*   핵심 질문: "우리가 가정한 '균일 연관성' 모델(6.9), 즉 모든 센터에서 치료 효과($\beta$)가 동일하다는 가정이 과연 타당한가?"
*   다른 표현: "치료 효과와 센터 간에 상호작용(interaction)이 없는가?"
*   검정 방법: 이는 모델 (6.9)에 대한 적합도 검정(Goodness-of-Fit Test)과 동일한 문제입니다.
    *   귀무가설 ($H_0$): 모델 (6.9)가 데이터를 잘 설명한다 (즉, 모든 층에서 오즈비는 동일하다).
    *   대립가설 ($H_a$): 포화 모델이 맞다 (즉, 각 층마다 오즈비가 다를 수 있다).
    *   검정 통계량: 모델 (6.9)의 이탈도($G^2$) 또는 피어슨 통계량($X^2$)을 계산합니다.
*   자유도:
    *   포화 모델: 각 센터별로 치료 그룹과 대조군 그룹, 총 $2K$개의 독립적인 성공 확률 $\pi_{ik}$가 있으므로 모수가 $2K$개.
    *   모델 (6.9): 절편 $\alpha$, 치료 효과 $\beta$ (1개), 센터 효과 $\beta_k^Z$ ($K-1$개, 하나는 기준). 총 $1+1+(K-1) = K+1$개의 모수.
    *   잔차 자유도: (포화 모델 모수) - (현재 모델 모수) = $2K - (K+1) = K-1$.
*   임상시험 예제:
    *   8개 센터($K=8$) 데이터에 대해 균일성 검정을 수행.
    *   $G^2=9.75, X^2=8.03$ (df = $8-1 = 7$).
    *   두 값 모두 자유도 7인 카이제곱 분포에서 흔하게 나올 수 있는 값입니다 (P-값이 큼).
*   결론: "모든 센터에서 치료 효과(오즈비)가 동일하다"는 균일 연관성 가설을 기각할 증거가 없습니다. 따라서 8개 센터의 정보를 하나의 공통 오즈비(예: $\hat{\theta}_{MH}=2.13$)로 요약하는 것이 통계적으로 합리적이라고 결론 내릴 수 있습니다.

종합 요약: 로지스틱 회귀 프레임워크는
1.  통합성 문제를 "Z의 주효과($\beta_k^Z$)가 0인가?"라는 모델 비교 문제로 변환하여 다룰 수 있게 하고,
2.  균일 연관성 문제를 "X와 Z의 상호작용 항이 0인가?" 또는 "모델 (6.9)의 적합도가 좋은가?"라는 적합도 검정 문제로 변환하여 다룰 수 있게 합니다.

이는 묘사적 수준에 머물렀던 개념들을 공식적인 통계 검정의 틀 안으로 가져오는 강력한 방법론입니다.
