### **3.1.6 델타 방법의 표본 로짓 적용 (Delta Method Applied to the Sample Logit)**

**[원문 번역]**

$n$번의 시행에서 $y$번의 성공이 있었을 때, 이항 모수 $\pi$의 최대우도(ML) 추정량 $T_n = \hat{\pi} = y/n$의 함수에 대해 델타 방법을 설명하겠습니다. $E(\hat{\pi}) = \pi$이고 $\text{var}(\hat{\pi}) = \pi(1-\pi)/n$임을 상기합시다. 또한, $\hat{\pi}$는 중심극한정리에 의해 대푯본 정규분포를 가집니다. $\hat{\pi}$의 많은 함수들 역시 그러합니다.

$\hat{\pi}$의 로그 오즈 함수(log odds function)인,

$$ g(\hat{\pi}) = \log[\hat{\pi}/(1-\hat{\pi})] $$

를 **표본 로짓(sample logit)**이라고 부릅니다. $\pi$에서 계산된 이 함수의 도함수(derivative)는 $1/[\pi(1-\pi)]$와 같습니다. 델타 방법에 의해, 표본 로짓의 점근적 분산(asymptotic variance)은 $\hat{\pi}$의 분산인 $\pi(1-\pi)/n$에 $[1/\pi(1-\pi)]$의 제곱을 곱한 것입니다. 즉,

$$ \text{Asy. Var}(\text{logit}(\hat{\pi})) = \left(\frac{\pi(1-\pi)}{n}\right) \times \left(\frac{1}{\pi(1-\pi)}\right)^2 = \frac{1}{n\pi(1-\pi)} $$

이는 수렴 분포 결과로 나타납니다.

$$ \sqrt{n}\left(\log\frac{\hat{\pi}}{1-\hat{\pi}} - \log\frac{\pi}{1-\pi}\right) \xrightarrow{d} N\left(0, \frac{1}{\pi(1-\pi)}\right) $$

$\hat{\pi}$의 점근적 정규성은 $\log[\hat{\pi}/(1-\hat{\pi})]$의 점근적 정규성으로 전파됩니다.

점근적 분산은 큰 $n$에 대해 실제 분포를 근사하는 정규분포의 분산입니다. 그것은 실제 분포의 분산에 대한 근사치는 **아닙니다**. $0 < \pi < 1$에 대해, 표본 로짓의 점근적 분산 $[n\pi(1-\pi)]^{-1}$은 유한합니다. 대조적으로, 실제 분산은 존재하지 않습니다. 왜냐하면 $\hat{\pi}=0$ 또는 $1$이 양의 확률로 발생 가능하므로, 로짓은 양의 확률로 $-\infty$ 또는 $\infty$가 될 수 있기 때문입니다. 무한한 로짓이 발생할 확률은 $n$이 증가함에 따라 빠르게 0으로 수렴합니다. 큰 $n$에 대해, 표본 로짓의 분포는 평균이 $\log[\pi/(1-\pi)]$이고 표준편차가 $[n\pi(1-\pi)]^{-1/2}$인 정규분포와 본질적으로 동일하게 보입니다. 따라서, 로짓에 대해서는 실제 분산보다 점근적 분산이 사실상 더 유용합니다.

---

### **핵심 내용 해설: 델타 방법의 구체적인 적용 예시**

이 섹션은 3.1.5절에서 배운 추상적인 델타 방법을 매우 구체적이고 중요한 예시인 **로짓(logit) 변환**에 적용하는 과정을 보여줍니다.

#### **1. 목표 설정: 표본 로짓의 분산 구하기**

*   **우리가 아는 것**:
    *   기본 통계량 $T_n$: 표본 비율 $\hat{\pi}$
    *   $\hat{\pi}$의 분산: $\text{Var}(\hat{\pi}) = \frac{\pi(1-\pi)}{n}$
*   **우리가 알고 싶은 것**:
    *   변환 함수: 로짓 함수 $g(\pi) = \log\left(\frac{\pi}{1-\pi}\right)$
    *   $g(\hat{\pi})$의 분산, 즉 $\text{Var}\left(\log\frac{\hat{\pi}}{1-\hat{\pi}}\right)$은 무엇인가?

#### **2. 델타 방법 적용 (단계별 계산)**

델타 방법의 핵심 공식: $\text{Var}[g(\hat{\pi})] \approx [g'(\pi)]^2 \times \text{Var}(\hat{\pi})$

**1단계: 함수 $g(\pi)$ 미분하기**
*   $g(\pi) = \log\left(\frac{\pi}{1-\pi}\right) = \log(\pi) - \log(1-\pi)$
*   $g'(\pi) = \frac{d}{d\pi}g(\pi) = \frac{1}{\pi} - \left(\frac{-1}{1-\pi}\right) = \frac{1}{\pi} + \frac{1}{1-\pi}$
*   통분하면:

$$ g'(\pi) = \frac{(1-\pi) + \pi}{\pi(1-\pi)} = \frac{1}{\pi(1-\pi)} $$

이 본문에 나온 "도함수는 $1/[\pi(1-\pi)]$와 같다"는 내용입니다.

**2단계: 델타 방법 공식에 대입하기**

$$ \text{Var}[g(\hat{\pi})] \approx \left[ \frac{1}{\pi(1-\pi)} \right]^2 \times \left[ \frac{\pi(1-\pi)}{n} \right] $$

*   분자와 분모의 $\pi(1-\pi)$ 항 하나씩을 약분합니다.

$$ \text{Var}[g(\hat{\pi})] \approx \frac{1}{\pi(1-\pi)} \times \frac{1}{n} = \frac{1}{n\pi(1-\pi)} $$

*   이것이 바로 **표본 로짓의 점근적 분산(asymptotic variance)**입니다.

**3단계: 표준오차(Standard Error) 구하기**
*   점근적 분산에 제곱근을 취하고, 모르는 모수 $\pi$를 추정치 $\hat{\pi}$로 대체합니다.

$$ \widehat{\text{SE}}\left(\log\frac{\hat{\pi}}{1-\hat{\pi}}\right) = \sqrt{\frac{1}{n\hat{\pi}(1-\hat{\pi})}} $$

*   이 표준오차는 로지스틱 회귀분석 등에서 회귀 계수의 신뢰구간을 계산하는 데 매우 중요하게 사용됩니다.

#### **3. "점근적 분산" vs "실제 분산" - 중요한 개념적 차이**

이 섹션의 후반부는 통계 이론의 미묘하지만 중요한 지점을 설명합니다.

*   **실제 분산(True Variance)**: 수학적으로 엄밀하게 정의된 분산입니다. 확률변수가 가질 수 있는 모든 값에 대해 $(X-E[X])^2$의 기댓값을 계산한 것입니다.
    *   **문제점**: 표본 로짓 $g(\hat{\pi})$는 $\hat{\pi}=0$일 때 $-\infty$가 되고, $\hat{\pi}=1$일 때 $+\infty$가 됩니다. 표본 크기 $n$이 아무리 커도, $\hat{\pi}$가 0 또는 1이 될 확률은 (아주 작지만) 0이 아닙니다.
    *   확률변수가 무한대의 값을 가질 수 있으면, 그 분산은 수학적으로 **정의되지 않거나 무한대**가 됩니다. 따라서 표본 로짓의 "실제 분산"은 존재하지 않습니다.

*   **점근적 분산(Asymptotic Variance)**: 이것은 "실제 분산"의 근사치가 **아닙니다**. 점근적 분산은 **"표본 크기 $n$이 무한대로 갈 때, $g(\hat{\pi})$의 분포가 근사하게 되는 정규분포의 분산"**을 의미합니다.
    *   **유용성**: $n$이 커지면 $\hat{\pi}$가 0 또는 1이 될 확률은 사실상 0에 가까워지고, 표본 로짓의 분포는 특정 평균과 분산을 갖는 정규분포와 거의 똑같이 보입니다. 이 "거의 똑같이 보이는" 정규분포의 분산이 바로 점근적 분산입니다.
    *   따라서 실제 분석에서는, 수학적으로 존재하지 않는 "실제 분산" 대신, 데이터의 분포를 매우 잘 설명해주는 **"점근적 분산"**을 사용하는 것이 훨씬 더 유용하고 실용적입니다.

**결론**: 델타 방법을 통해 우리는 표본 로짓의 점근적 분산이 $1/[n\pi(1-\pi)]$임을 유도할 수 있습니다. 비록 표본 로짓의 수학적인 '실제' 분산은 존재하지 않지만, 이 점근적 분산은 대표본에서 표본 로짓의 변동성을 매우 잘 나타내므로 통계적 추론에 매우 유용하게 사용됩니다.
