### **3.2.6 프로파일 우도 신뢰구간 (Profile Likelihood Confidence Intervals)**

**[원문 번역]**

마찬가지로, 우리는 모수의 비귀무가설 값에 대한 우도비 검정을 역산하여 신뢰구간을 구성할 수 있습니다. 오즈비를 예로 들어 설명하겠습니다. 방금 정의한 $\{\hat{\mu}_{ij}(\theta_0)\}$에 대해, 다음을 만족하는 $\theta_0$ 값들의 집합이

$$ G^2(\theta_0) = 2 \sum_i \sum_j n_{ij} \log[n_{ij}/\hat{\mu}_{ij}(\theta_0)] < \chi_1^2(\alpha) $$

$100(1-\alpha)\%$ 우도비 검정 기반 신뢰구간을 형성합니다. 안전벨트 사용과 교통사고에 대한 표 3.1의 오즈비에 대한 95% 신뢰구간은 (6.82, 17.70)입니다.

더 일반적으로, 이후 장들에서 우리는 종종 어떤 모델 모수 $\beta$에 대한 신뢰구간을 구성하면서, 모델의 다른 모수들은 **방해 모수(nuisance parameters)**로 간주할 것입니다. 우리가 오즈비를 추정할 때 $2 \times 2$ 표의 주변 확률과 같은 이러한 방해 모수들을 $\boldsymbol{\psi}$로 표기합시다. $\beta_0$가 신뢰구간에 속하는지 확인하기 위해 $H_0: \beta=\beta_0$라는 우도비 검정을 역산할 때, 귀무가설 하에서 우도를 최대로 만드는 ML 추정치 $\hat{\boldsymbol{\psi}}(\beta_0)$는 $\beta_0$ 값에 따라 변합니다. **프로파일 로그우도 함수(profile log-likelihood function)**는 $L(\beta_0, \hat{\boldsymbol{\psi}}(\beta_0))$를 $\beta_0$의 함수로 본 것입니다. 각 $\beta_0$에 대해 이 함수는 $\beta=\beta_0$라는 제약 하에서 일반 로그우도의 최댓값을 제공합니다. $\beta_0 = \hat{\beta}$에서 계산된 값은 제약 없는 ML 추정치에서 발생하는 최대화된 로그우도 $L(\hat{\beta}, \hat{\boldsymbol{\psi}})$입니다. $\beta$에 대한 **프로파일 우도 신뢰구간**은 다음을 만족하는 $\beta_0$ 값들의 집합입니다.

$$ -2[L(\beta_0, \hat{\boldsymbol{\psi}}(\beta_0)) - L(\hat{\beta}, \hat{\boldsymbol{\psi}})] < \chi_1^2(\alpha) $$

이 구간은 명목 크기 $\alpha$의 우도비 검정에서 기각되지 않는 모든 $\beta_0$를 포함합니다.

스코어 구간은 현재 이 책의 컴퓨팅 부록에 있는 R 함수와 같은 특수한 소프트웨어에서만 사용할 수 있습니다. 프로파일 우도 접근법은 더 일반적으로 사용할 수 있는데, 예를 들어 R의 `confint()` 함수, SAS의 PROC GENMOD의 LRCI 옵션과 PROC LOGISTIC의 PLCL 옵션, 그리고 Stata의 `pllf` 명령어가 있습니다.

---

### **핵심 내용 해설: 가장 신뢰성 높은 신뢰구간**

이 섹션은 스코어 신뢰구간과 마찬가지로 '검정의 역산' 원리를 사용하되, 이번에는 **우도비 검정(Likelihood-Ratio test)**을 역산하는 방법을 소개합니다. 이 방법으로 얻은 신뢰구간은 이론적으로 가장 우수한 성능을 보이는 경우가 많습니다.

#### **1. 기본 아이디어: 우도비 검정의 역산**

> **"모수 $\theta$에 대한 95% 신뢰구간이란, 귀무가설 $H_0: \theta=\theta_0$를 유의수준 5%의 우도비 검정에서 기각하지 못하는 모든 $\theta_0$ 값들의 집합이다."**

**오즈비($\theta$)의 우도비 신뢰구간 구축 과정:**

1.  **가상의 귀무가설 설정**: 실제 오즈비가 어떤 특정 값 $\theta_0$라고 가정합니다 ($H_0: \theta=\theta_0$).
2.  **우도비 검정 통계량 계산**: 이 가설($\theta_0$)에 대한 우도비 검정 통계량 $G^2(\theta_0)$를 계산합니다.
    *   $G^2(\theta_0) = 2 \sum n_{ij} \log(n_{ij}/\hat{\mu}_{ij}(\theta_0))$
    *   **핵심**: 여기서 기대 빈도 $\hat{\mu}_{ij}(\theta_0)$는 **"오즈비가 정확히 $\theta_0$가 된다"는 제약 조건 하에서** 계산된 값입니다. 이는 보통 반복적인 계산을 통해 구해집니다.
3.  **검정 수행**: 계산된 $G^2(\theta_0)$ 값이 임계값(예: 95% 신뢰수준의 경우 $\chi^2_1(0.05) \approx 3.84$)보다 작은지 확인합니다.
4.  **반복**: 이 과정을 수많은 가능한 $\theta_0$ 값들에 대해 반복하여, $G^2(\theta_0) < 3.84$를 만족하는 $\theta_0$ 값들의 범위를 찾습니다. 이 범위가 바로 95% 우도비 신뢰구간입니다.

#### **2. "프로파일 우도"라는 일반적인 개념**

본문의 후반부는 이 아이디어를 더 일반적인 통계 모델링 상황으로 확장합니다. 대부분의 통계 모델에는 우리가 직접적으로 관심을 갖는 **주요 모수(parameter of interest, $\beta$)**와, 모델을 완성하기 위해 필요하지만 우리의 주된 관심사는 아닌 **방해 모수(nuisance parameters, $\boldsymbol{\psi}$)**가 함께 존재합니다.

*   **예시 (오즈비)**:
    *   **주요 모수 ($\beta$)**: 오즈비 $\theta$ (또는 $\log\theta$)
    *   **방해 모수 ($\boldsymbol{\psi}$)**: 표의 주변 확률($\pi_{1+}, \pi_{+1}$). 오즈비가 특정 값을 갖더라도 주변 확률이 어떻게 분포하느냐에 따라 셀 확률이 달라집니다.

**프로파일 우도(Profile Likelihood)의 아이디어:**

우리는 방해 모수 $\boldsymbol{\psi}$에는 관심이 없고 오직 주요 모수 $\beta$에 대한 추론만 하고 싶습니다.

1.  우리가 관심 있는 주요 모수 $\beta$의 값을 어떤 특정 값 $\beta_0$로 **고정**합니다.
2.  그 상태에서, 나머지 방해 모수 $\boldsymbol{\psi}$들을 자유롭게 움직여서 로그우도 함수를 **최대화**합니다. 이때의 최대 로그우도 값을 $L(\beta_0, \hat{\boldsymbol{\psi}}(\beta_0))$라고 씁니다.
3.  이 과정을 모든 가능한 $\beta_0$ 값에 대해 반복합니다.

이렇게 얻어진, 각 $\beta_0$ 값에 대한 '조건부' 최대 로그우도 값들의 집합을 **프로파일 로그우도 함수**라고 합니다. 이는 마치 다차원 공간의 복잡한 로그우도 함수를, 우리가 관심 있는 $\beta$ 축으로 "내려다보며(profiling)" 그 윤곽선을 그리는 것과 같습니다.

**프로파일 우도 신뢰구간:**
이 프로파일 로그우도 함수를 사용하여 일반적인 우도비 검정을 수행합니다.

$$ -2 \times [\text{제약 하의 최대 로그우도} - \text{제약 없는 최대 로그우도}] < \chi_1^2(\alpha) $$

$$ -2[L(\beta_0, \hat{\boldsymbol{\psi}}(\beta_0)) - L(\hat{\beta}, \hat{\boldsymbol{\psi}})] < \chi_1^2(\alpha) $$

이 부등식을 만족하는 모든 $\beta_0$의 집합이 바로 프로파일 우도 신뢰구간입니다.

#### **3. 장점 및 결론**

*   **우수한 통계적 성능**: 프로파일 우도 신뢰구간은 스코어 신뢰구간과 함께, 왈드 신뢰구간의 문제점을 모두 해결하며, 많은 경우 이론적으로 가장 바람직한 통계적 속성을 가집니다. 실제 포함 확률이 명목 신뢰수준에 매우 가깝습니다.
*   **일관성**: 스코어 신뢰구간과 마찬가지로, 우도비 가설 검정 결과와 완벽하게 일치합니다.
*   **범용성**: 이 "프로파일링" 아이디어는 매우 일반적이어서, 로지스틱 회귀, 푸아송 회귀 등 거의 모든 종류의 통계 모델에서 특정 모수의 신뢰구간을 구하는 표준적인 방법으로 사용됩니다.
*   **가용성**: 본문에서 언급하듯이, 주요 통계 소프트웨어(R, SAS, Stata 등)에서 이 기능을 표준으로 제공하고 있어 계산의 복잡성은 더 이상 큰 문제가 되지 않습니다.

**요약**: 프로파일 우도 신뢰구간은 우도비 검정을 역산하는 원리에 기반하며, 방해 모수가 있는 복잡한 모델에서도 우리가 원하는 특정 모수에 대한 신뢰성 높은 구간을 제공하는 강력하고 일반적인 방법입니다. 통계적 추론의 정확성과 일관성을 위해 적극적으로 사용해야 할 방법 중 하나입니다.
