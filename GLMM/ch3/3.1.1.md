### **3.1.1 오즈비의 구간 추정 (Interval Estimation of the Odds Ratio)**

**[원문 번역]**

$2 \times 2$ 표에 대한 표본 오즈비는 $\hat{\theta} = (n_{11}n_{22})/(n_{12}n_{21})$ 입니다. 다항 표본에 대해, 추정량 $\hat{\theta}$는 모수 $\theta$ 주위에서 점근적으로 정규분포를 따릅니다. 하지만, 표본 크기 $n$이 매우 크지 않은 이상, 그것의 표집분포는 매우 치우쳐져 있습니다. 예를 들어, $\theta=1$일 때, $\hat{\theta}$는 $\theta$보다 훨씬 작을 수는 없지만(왜냐하면 $\hat{\theta} \ge 0$ 이므로), 무시할 수 없는 확률로 훨씬 더 클 수는 있습니다.

곱셈 구조가 아닌 덧셈 구조를 가지는 로그 변환(log transform)은 정규성으로 더 빠르게 수렴합니다. $\log \hat{\theta}$에 대한 추정된 표준오차는 다음과 같습니다.

$$ \hat{\sigma}(\log\hat{\theta}) = \sqrt{\frac{1}{n_{11}} + \frac{1}{n_{12}} + \frac{1}{n_{21}} + \frac{1}{n_{22}}} \quad (3.1) $$

이 공식은 3.1.7절에서 유도합니다.

$\log \hat{\theta}$의 대푯본 정규성에 의해,
$$ \log \hat{\theta} \pm z_{\alpha/2}\hat{\sigma}(\log \hat{\theta}) \quad (3.2) $$
는 $\log \theta$에 대한 왈드(Wald) 신뢰구간입니다(Woolf 1955). 이 구간의 양 끝점에 지수 변환(역로그를 취함)을 하면 $\theta$에 대한 신뢰구간을 얻을 수 있습니다. 실제 포함 확률은 보통 명목 수준보다 약간 더 높은 경향이 있습니다.

만약 어떤 셀 빈도 $n_{ij}$가 0이면, $\hat{\theta}$는 0 또는 $\infty$가 되고 왈드 구간은 존재하지 않습니다. 이러한 결과는 양의 확률로 발생할 수 있으므로, $\hat{\theta}$와 $\log \hat{\theta}$의 실제 기댓값과 분산은 존재하지 않습니다¹. 이는 $\theta$에 대한 스코어 검정이나 우도비 검정을 역산하여 형성된 신뢰구간에서는 문제가 되지 않습니다. 이러한 구간들에서는, $\hat{\theta}=0$일 때 0이 하한이 되고 $\hat{\theta}=\infty$일 때 $\infty$가 상한이 됩니다. 이는 빈도주의적 접근법에서는 합리적입니다. 16.6.4절에서 소개될 오즈비에 대한 소표본 신뢰구간을 구성할 때도 같은 현상이 발생합니다. 대안적으로, 다소 임시방편적이긴 하지만, 추정량과 표준오차에서 $\{n_{ij}\}$를 $\{n_{ij} + 0.5\}$로 대체하는 것과 같은 조정을 한 후에 왈드 공식(3.2)을 사용할 수 있습니다. 편향(bias)과 평균제곱오차(mean squared error) 측면에서, Gart와 Zweifel(1967) 그리고 Haldane(1956)은 이러한 수정된 추정량들이 좋은 성능을 보임을 보여주었습니다(연습문제 16.8 참조).

---
¹ 이것은 이후 장에서 제시될 모델 모수들의 ML 추정량에서도 마찬가지입니다.

---

### **핵심 내용 해설**

이 섹션은 $2 \times 2$ 분할표에서 가장 중요한 연관성 측도인 **오즈비(Odds Ratio, $\theta$)**의 신뢰구간을 어떻게 구하는지에 대해 설명합니다.

#### **1. 문제점: 오즈비 자체의 분포는 매우 치우쳐져 있다**

*   표본 오즈비($\hat{\theta}$)는 이론적으로 $0$부터 무한대($\infty$)까지의 값을 가질 수 있습니다.
*   이 분포는 대칭적이지 않고 오른쪽으로 길게 꼬리가 늘어진 **심하게 치우친(highly skewed)** 형태를 가집니다. (아래 그림 참조)
*   이처럼 치우친 분포는 정규분포 근사를 사용하기에 적합하지 않습니다. 만약 억지로 $\hat{\theta}$에 대해 정규분포 기반의 왈드 신뢰구간($\hat{\theta} \pm z_{\alpha/2} \cdot \text{SE}(\hat{\theta})$)을 만들면, 구간이 음수 값을 포함하는 등 비합리적인 결과가 나올 수 있습니다. (오즈비는 음수가 될 수 없습니다.)

![오즈비 분포 그림](https://i.stack.imgur.com/u7q6K.png)
*(그림: 오즈비의 표집분포(위)는 치우쳐 있지만, 로그 오즈비의 표집분포(아래)는 정규분포에 가깝다.)*

#### **2. 해결책: 로그 변환 (The Log Transform)**

*   이 문제에 대한 표준적인 해결책은 **로그(log)를 취하는 것**입니다.
*   **로그 오즈비($\log\hat{\theta}$)**의 표집분포는 $\hat{\theta}$ 자체의 분포보다 훨씬 **대칭적**이며 **정규분포에 빠르게 근사**합니다.
*   **왜 로그 변환이 효과적인가?**
    *   **범위 확장**: 오즈비의 범위 ($[0, \infty)$)를 로그를 통해 ($(-\infty, \infty)$)로 변환하여 대칭적인 분포가 될 수 있는 공간을 만듭니다.
    *   **곱셈을 덧셈으로**: 로그는 곱셈/나눗셈 구조를 덧셈/뺄셈 구조로 바꿔줍니다. 이는 통계적 모델링과 분포 근사를 더 쉽게 만듭니다.

#### **3. 신뢰구간 구축 절차 (3단계)**

1.  **로그 스케일에서 계산**: 먼저, **로그 오즈비**에 대한 신뢰구간을 왈드 방식으로 구합니다.
    *   **점 추정치**: $\log \hat{\theta}$
    *   **표준 오차**: $\hat{\sigma}(\log\hat{\theta}) = \sqrt{\frac{1}{n_{11}} + \frac{1}{n_{12}} + \frac{1}{n_{21}} + \frac{1}{n_{22}}}$
        *   이 공식은 매우 중요하며, 각 셀 빈도의 **역수를 모두 더한 후 제곱근**을 취하는 간단한 형태입니다. 각 셀에 관측치가 많을수록 표준오차는 작아집니다.
    *   **신뢰구간**: $\log \hat{\theta} \pm z_{\alpha/2} \cdot \hat{\sigma}(\log\hat{\theta})$

2.  **원래 스케일로 변환**: 1단계에서 얻은 신뢰구간의 양 끝점(하한과 상한)에 **지수 함수($e^x$)를 적용**합니다.
    *   오즈비의 신뢰구간 하한: $\exp(\text{로그 오즈비 신뢰구간 하한})$
    *   오즈비의 신뢰구간 상한: $\exp(\text{로그 오즈비 신뢰구간 상한})$

3.  **결과 해석**: 최종적으로 얻은 구간은 더 이상 점 추정치($\hat{\theta}$)를 중심으로 대칭적이지 않습니다. 이는 오즈비 분포의 비대칭성을 올바르게 반영하는 것입니다.

#### **4. 실용적인 문제: 셀에 0이 있을 경우 (Zero Cell Counts)**

*   $2 \times 2$ 표의 네 셀 중 하나라도 빈도가 0이면, 표본 오즈비 $\hat{\theta}$는 0 또는 무한대가 됩니다.
*   이 경우, $\log\hat{\theta}$는 정의되지 않거나($\log 0$) 무한대가 되며, 표준오차 공식(3.1)에서도 $1/0$ 항이 생겨 계산이 불가능해집니다.
*   **해결 방안**:
    1.  **스코어 또는 우도비 기반 신뢰구간 사용**: 이 방법들은 왈드 방법과 달리 0 셀 문제에 더 강건합니다. (3.2.5, 3.2.6절에서 소개됨)
    2.  **임시방편적 수정 (Ad-hoc adjustment)**: 가장 흔히 사용되는 방법은 모든 셀의 빈도에 아주 작은 값(보통 **0.5**)을 더하는 것입니다. 이를 통해 0 셀 문제를 피하고 왈드 공식을 그대로 사용할 수 있습니다. 이 방법은 비록 임시방편적이지만, 통계적으로 좋은 속성을 가지는 것으로 알려져 널리 사용됩니다.

**요약**: 오즈비의 신뢰구간을 구할 때는 항상 **로그 변환**을 이용하여 로그 스케일에서 먼저 구간을 계산한 후, 다시 **지수 변환**으로 원래 스케일로 되돌리는 3단계 절차를 따라야 합니다. 셀에 0이 있는 경우, 모든 셀에 0.5를 더하는 방법을 고려할 수 있습니다.
