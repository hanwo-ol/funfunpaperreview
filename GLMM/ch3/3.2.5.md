### **3.2.5 비율 비교를 위한 스코어 신뢰구간 (Score Confidence Intervals Comparing Proportions)**

**[원문 번역]**

3.1절에서 제시된 비율 차이, 오즈비, 상대위험도에 대한 왈드 신뢰구간은 간단하지만 단점이 있습니다: 측정 척도에 따라 결과가 달라지고[예: $\theta$에 대한 왈드 구간과, $\log(\theta)$에 대해 구한 후 지수 변환한 구간이 같지 않음], 추정치가 모수 공간의 경계에 있을 때 실패하며[예: 셀 빈도 0으로 인해 $\log(\hat{\theta})=\pm\infty$ 와 $\hat{\sigma}(\log\hat{\theta})=\infty$가 되는 경우], $n$이 매우 크지 않은 이상 실제 포함 확률이 명목 수준에서 상당히 벗어날 수 있습니다.

스코어 검정이나 우도비 검정을 역산하여 얻는 대안적인 구간들은 이러한 단점이 없습니다. 이 검정들은 모수의 귀무가설 값이 아닌 값(nonnull values)에 적용되는 $X^2$ 또는 $G^2$ 통계량의 확장을 사용합니다. 비록 왈드 방법보다 계산적으로 더 복잡하지만, 계산 원리가 간단명료하므로 현대 컴퓨팅 시대에 이를 사용하는 데 장애가 되어서는 안 됩니다.

우리는 비율 차이에 대한 구간을 형성하는 스코어 방법을 설명합니다. $H_0: \pi_1 - \pi_2 = \Delta_0$를 검정하는 것을 고려해 봅시다(여기서 $\Delta_0$는 0일 필요는 없음). $\hat{\pi}_1(\Delta_0)$와 $\hat{\pi}_2(\Delta_0)$를 $\pi_1 - \pi_2 = \Delta_0$라는 제약 하에서 $\pi_1$과 $\pi_2$의 ML 추정치라고 합시다. 즉, $\hat{\pi}_1(\Delta_0)$와 $\hat{\pi}_2(\Delta_0)$는 두 이항 확률 질량 함수의 곱을 최대로 만드는, $\pi_1 - \pi_2 = \Delta_0$를 만족하는 $\pi_1$과 $\pi_2$의 값입니다. 스코어 검정 통계량은 다음과 같습니다.

$$ z(\Delta_0) = \frac{(\hat{\pi}_1 - \hat{\pi}_2) - \Delta_0}{\sqrt{\frac{\hat{\pi}_1(\Delta_0)[1-\hat{\pi}_1(\Delta_0)]}{n_1} + \frac{\hat{\pi}_2(\Delta_0)[1-\hat{\pi}_2(\Delta_0)]}{n_2}}} $$

스코어 신뢰구간은 $|z(\Delta_0)| < z_{\alpha/2}$를 만족하는 $\Delta_0$ 값들의 집합입니다 (Mee 1984). 주어진 $\Delta_0$에 대해, 각 $\hat{\pi}_i(\Delta_0)$와 그에 따른 $z(\Delta_0)$는 명시적으로 찾을 수 있지만, 구간의 양 끝점을 찾기 위해서는 반복 계산(iteration)이 필요합니다 (Nurminen 1986).

$\Delta_0 = 0$일 때, 검정 통계량 $z(\Delta_0)$는 두 비율을 비교하는 합동(pooled) 통계량 (3.12)으로 간단해집니다. 그러면 $[z(\Delta_0)]^2$은 피어슨 $X^2$ 통계량입니다. $\Delta_0 \neq 0$일 때 이 제곱값은 비귀무가설(nonnull) 유형의 피어슨 통계량입니다. 왈드 구간과 달리, 스코어 구간은 독립성에 대한 피어슨 카이제곱 검정의 결과와 **일관성(coherent)**이 있습니다. 예를 들어, 해당 검정의 P-값이 0.05 미만으로 나오는 것은 $\pi_1 - \pi_2$에 대한 95% 스코어 신뢰구간이 0을 포함하지 않는 것과 동등합니다. 아스피린 사용과 심장마비에 대한 표 2.1에 대해, $\pi_1 - \pi_2$의 95% 스코어 신뢰구간은 (0.0004, 0.0022)입니다.

오즈비(Cornfield 1956)와 상대위험도(Koopman 1984)에 대해서도 스코어 검정에 기반한 신뢰구간이 제안되었습니다. 우리는 $2 \times 2$ 표의 셀들에 대한 다항 표본의 오즈비에 대해 설명합니다. ... (중략) ... 피어슨 카이제곱 검정 결과와 일관성이 있으며, $H_0: \theta=1$에 대한 검정과 관련됩니다. 안전벨트 사용과 교통사고에 대한 표 3.1의 오즈비에 대한 95% 스코어 신뢰구간은 (6.76, 17.35)입니다.

---

### **핵심 내용 해설: 검정과 구간 추정의 일관성**

이 섹션은 왈드 신뢰구간의 여러 문제점을 지적하고, 그에 대한 우수한 대안으로 **스코어 신뢰구간**을 소개합니다. 가장 중요한 핵심 개념은 **"검정과 구간 추정의 일관성"**입니다.

#### **1. 왈드 신뢰구간의 문제점 재확인**

*   **척도 의존성**: $\theta$의 신뢰구간과 $\log\theta$의 신뢰구간을 변환한 것이 서로 다르다. 어느 것을 믿어야 할까? 이는 비논리적입니다.
*   **경계 문제**: 데이터에 0이 있으면 신뢰구간을 계산할 수 없다.
*   **부정확성**: 실제 포함 확률이 명목 수준(예: 95%)과 크게 다를 수 있다.

#### **2. 스코어 신뢰구간: 검정을 뒤집는 원리**

스코어 신뢰구간은 1.3.4절에서 배운 **"검정의 역산(inverting a test)"** 원리에 기반합니다.

> **"모수 $\theta$에 대한 95% 신뢰구간이란, 귀무가설 $H_0: \theta=\theta_0$를 유의수준 5%에서 기각하지 못하는 모든 $\theta_0$ 값들의 집합이다."**

이 원리를 스코어 검정에 적용한 것이 스코어 신뢰구간입니다.

**비율 차이($\pi_1 - \pi_2 = \Delta$)의 스코어 신뢰구간 구축 과정:**

1.  **가상의 귀무가설 설정**: 우리가 관심 있는 모수, 즉 비율 차이가 어떤 특정 값 $\Delta_0$라고 가정합니다 ($H_0: \pi_1 - \pi_2 = \Delta_0$).
2.  **스코어 검정 통계량 계산**: 이 가설($\Delta_0$)에 대한 스코어 검정 통계량 $z(\Delta_0)$를 계산합니다.
    *   **핵심**: 이 통계량의 분모(표준오차)를 계산할 때, 왈드 방법처럼 $\hat{\pi}_1, \hat{\pi}_2$를 쓰거나 z-검정처럼 합동 추정치 $\hat{\pi}$를 쓰는 것이 아닙니다. 대신, **$H_0: \pi_1 - \pi_2 = \Delta_0$라는 제약 조건 하에서** 구한 ML 추정치, 즉 $\hat{\pi}_1(\Delta_0)$와 $\hat{\pi}_2(\Delta_0)$를 사용합니다. 이는 스코어 검정의 원리(귀무가설 하에서의 정보 사용)와 일치합니다.
3.  **검정 수행**: 계산된 $|z(\Delta_0)|$ 값이 임계값(예: 95% 신뢰수준의 경우 1.96)보다 작은지 확인합니다.
4.  **반복**: 이 과정을 수많은 가능한 $\Delta_0$ 값들에 대해 반복하여, $|z(\Delta_0)| < 1.96$을 만족하는 $\Delta_0$ 값들의 범위를 찾습니다. 이 범위가 바로 95% 스코어 신뢰구간입니다.
    *(실제로는 양 끝점을 찾는 방정식을 수치적으로 풉니다.)*

#### **3. 스코어 신뢰구간의 가장 큰 장점: 일관성 (Coherence)**

> "95% 신뢰구간이 0을 포함하지 않으면, 유의수준 5%에서 $H_0: \Delta=0$ 가설 검정은 기각되어야 한다. 반대도 마찬가지다."

이것은 너무나 당연해 보이지만, **왈드 방법은 이 당연한 원리를 종종 위반합니다.** 왈드 신뢰구간과 왈드 가설 검정은 서로 다른 표준오차를 사용하기 때문에 결과가 불일치할 수 있습니다.

반면, **스코어 신뢰구간은 정의 자체가 스코어 검정을 역산한 것**이므로, 가설 검정 결과와 신뢰구간의 결론은 항상 완벽하게 일치합니다.

*   **예시**: 아스피린 연구에서 $\pi_1 - \pi_2$에 대한 95% 스코어 신뢰구간은 (0.0004, 0.0022)입니다. 이 구간은 0을 포함하지 않습니다. 이는 유의수준 5%에서 $H_0: \pi_1=\pi_2$에 대한 피어슨 카이제곱 검정(스코어 검정과 동등)이 반드시 "통계적으로 유의하다"는 결론을 내릴 것임을 보장합니다.

#### **4. 계산의 복잡성**

*   왈드 구간은 추정치와 표준오차만 있으면 바로 계산할 수 있어 매우 간단합니다.
*   스코어 구간은 각 $\Delta_0$ 값마다 제약 하의 ML 추정치를 구하고 방정식을 풀어야 하므로 계산이 복잡합니다.
*   **결론**: 하지만 저자의 주장처럼, 현대 컴퓨터의 성능으로는 이 정도 계산은 전혀 문제가 되지 않습니다. 따라서 통계적 우월성을 고려할 때, 왈드 구간 대신 스코어 구간(또는 다음 절의 우도비 구간)을 사용하는 것이 훨씬 더 바람직합니다.

**요약**: 스코어 신뢰구간은 왈드 구간의 이론적 결함(척도 의존성, 경계 문제, 부정확성, 불일관성)을 모두 극복하는 뛰어난 대안입니다. 계산은 복잡하지만, 그 원리가 명확하고 결과의 신뢰도와 일관성이 높기 때문에 적극적으로 사용해야 합니다.
