### **3.1.8 다중 비교를 위한 동시 신뢰구간 (Simultaneous Confidence Intervals for Multiple Comparisons)**

**[원문 번역]**

많은 유전학 연구에서처럼, 어떤 모수에 대해 비교해야 할 그룹이 여러 개인 경우가 종종 있습니다. **다중 비교(Multiple comparison)** 방법은 신뢰수준을 개별적인 비교 각각이 아니라, 모든 비교의 **동시적인 집합(simultaneous set)**에 적용합니다.

추론의 한 묶음에 대한 통제권을 확립하는 간단하고 다목적이지만 다소 보수적인(conservative) 방법은 **본페로니 방법(Bonferroni method)**입니다. 이 방법에서는, $g$개의 추론을 수행할 때 각각에 대해 오류 확률 $\alpha^* = \alpha/g$를 사용합니다. 예를 들어, 동시 포함 확률이 최소 $1-\alpha$가 되는 $g$개의 신뢰구간을 형성하려면, 각각에 대해 신뢰수준 $1-\alpha/g$를 사용하여 표준적인 방법을 적용합니다. 이는 전체 구간 집합에서 적어도 하나의 오류가 발생할 확률의 상한이 $\alpha$임을 의미합니다. 연습문제 1.36은 다항 모수들의 모든 쌍을 동시적으로 비교하는 데 이 방법을 적용했습니다. Goodman (1964a)은 $I \times J$ 표의 모든 오즈비에 대한 동시 신뢰구간을 제시했습니다. 주석 3.2는 여러 이항 모수를 비교하는 대안적인 방법을 인용합니다. 7.5.2절에서 본페로니 방법을 더 설명하고, 7.5.3절에서는 유의성 검정의 맥락에서 덜 보수적인 다중 비교 접근법을 제시합니다.

---

### **핵심 내용 해설: 여러 번 비교할 때 발생하는 문제**

#### **1. 다중 비교 문제(The Problem of Multiple Comparisons)란?**

통계 검정을 한 번 할 때마다 우리는 작은 오류의 위험을 감수합니다. 예를 들어, 95% 신뢰구간은 5%의 확률로 실제 모수 값을 포함하지 못할 수 있습니다.

**문제**: 만약 우리가 서로 관련 없는 95% 신뢰구간을 **20개** 만든다면 무슨 일이 일어날까요?
*   각 구간이 '성공'(모수를 포함)할 확률: 0.95
*   각 구간이 '실패'(모수를 놓침)할 확률: 0.05
*   20개의 모든 구간이 전부 '성공'할 확률: $(0.95)^{20} \approx 0.358$ (약 36%)
*   **적어도 하나 이상의 구간이 '실패'할 확률**: $1 - 0.358 = 0.642$ (약 64%)

**결론**: 95%라는 신뢰수준으로 시작했지만, 20번의 비교를 하고 나니 전체적인 신뢰수준은 36%로 폭락했습니다. 즉, 비교를 많이 하면 할수록, 그 중 적어도 하나는 우연히 잘못된 결론을 내릴 가능성이 매우 높아집니다. 이를 **1종 오류의 인플레이션(inflation of Type I error rate)**이라고 합니다.

#### **2. 본페로니 방법: 가장 간단한 해결책**

본페로니 방법은 이 문제를 해결하는 가장 직관적이고 간단한 방법입니다.

**핵심 아이디어**: "전체 오류율을 원하는 수준($\alpha$)으로 유지하고 싶다면, 개별 비교에 허용되는 오류율을 더 엄격하게 만들면 된다. 즉, 전체 오류 예산을 개별 비교에 똑같이 나누어 준다."

**적용 절차**:
1.  **전체 유의수준($\alpha$)을 정한다**: 보통 0.05 (5%)를 사용합니다.
2.  **수행할 비교의 총 개수($g$)를 센다**: 예를 들어, 3개 그룹(A, B, C)을 서로 비교한다면, (A vs B), (A vs C), (B vs C)로 총 $g=3$개의 비교를 합니다.
3.  **개별 유의수준($\alpha^*$)을 계산한다**:

$$ \alpha^* = \frac{\alpha}{g} $$

위의 예에서는 $\alpha^* = 0.05 / 3 \approx 0.0167$ 입니다.

4.  **보정된 수준으로 분석을 수행한다**:
    *   **신뢰구간의 경우**: 개별 신뢰구간을 95% 수준이 아니라, **$(1-\alpha^*)\%$** 수준으로 계산합니다.
        *   예: 95% 동시 신뢰구간을 원하면, 개별적으로는 $(1-0.0167) \times 100 = 98.33\%$ 신뢰구간을 만들어야 합니다. 이는 일반적으로 $z_{\alpha/2}$ 대신 더 큰 값인 $z_{\alpha^*/2}$를 사용함을 의미하며, 결과적으로 **개별 신뢰구간의 폭이 더 넓어집니다.**
    *   **가설 검정의 경우**: 개별 검정의 P-값을 0.05가 아니라, **$\alpha^*$**와 비교하여 유의성을 판단합니다.

#### **3. 장점과 단점**

*   **장점**:
    *   **매우 간단하다**: 적용하기가 매우 쉽습니다.
    *   **다목적이다**: 신뢰구간, 가설 검정 등 어떤 종류의 추론에도 적용할 수 있습니다.
    *   **가정이 거의 없다**: 비교들이 서로 독립이든 아니든 상관없이 항상 성립합니다.

*   **단점**:
    *   **지나치게 보수적(Conservative)이다**: "보수적"이라는 말은 귀무가설을 너무 기각하지 않으려는 경향, 즉 차이가 있어도 없다고 결론 내릴(2종 오류) 가능성이 높아진다는 의미입니다.
    *   **이유**: 본페로니 부등식($P(\cup A_i) \le \sum P(A_i)$)에 기반하는데, 이는 최악의 시나리오(모든 비교가 완벽히 독립인 경우)를 가정합니다. 실제로는 비교들이 서로 관련 있는 경우가 많아, 이 방법은 필요 이상으로 엄격한 기준을 적용하게 됩니다.
    *   비교의 개수($g$)가 많아지면 개별 유의수준($\alpha/g$)이 너무 작아져서, 사실상 어떤 결과도 통계적으로 유의미하다고 말하기 어렵게 될 수 있습니다.

**결론**: 본페로니 방법은 다중 비교 문제를 해결하기 위한 **가장 기본적인 첫 단계**입니다. 적용이 간편해 널리 사용되지만, 특히 비교 개수가 많을 때는 지나치게 보수적일 수 있다는 단점을 인지해야 합니다. 텍스트에서 언급하듯이, 이보다 덜 보수적이면서 더 강력한 다른 다중 비교 방법들(예: Tukey's HSD, Holm-Bonferroni method 등)도 존재합니다.
