### **3.5.3 피셔의 정확 검정에 대한 양측 P-값 (Two-Sided P-Values for Fisher's Exact Test)**

**[원문 번역]**

단측 대립가설에 대해서는, 표들을 더 큰 $n_{11}$, 더 큰 오즈비, 또는 더 큰 비율 차이에 따라 순서를 매겨도 동일한 P-값이 나옵니다(Davis 1986a). 양측 대립가설에 대해서는, 다른 기준들이 다른 P-값을 가질 수 있습니다.

양측 P-값에 대해, 가장 흔한 접근법(Irwin 1935)은 $p(t) \le p(t_0)$를 만족하는 빈도 $t$에 대해 (3.17)의 $P(n_{11}=t)$를 합산하는 것입니다; 즉, 관측된 값 $t_0$에 대해 P-값은 $P[p(n_{11}) \le p(t_0)]$ 입니다. 또 다른 가능성은 $H_0$로부터 더 멀리 떨어진 표들에 대해 $p(t)$를 합산하는 것입니다; 즉,

$$ \text{P-값} = P[|n_{11} - E(n_{11})| \ge |t_0 - E(n_{11})|] $$

여기서 초기하분포의 $E(n_{11}) = n_{1+}n_{+1}/n$ 입니다. 이것은 관측된 피어슨 통계량 $X^2_{obs}$에 대해 $P(X^2 \ge X^2_{obs})$ 와 동일합니다. 세 번째 접근법은 최소 단측 P-값을 두 배 하는 것인데, 즉 $2 \min[P(n_{11} \ge t_0), P(n_{11} \le t_0)]$ 이지만, 이 값은 1을 초과할 수 있습니다. 네 번째 접근법(Blaker 2000)은 $Q=\min[P(n_{11} \ge t_0), P(n_{11} \le t_0)]$ 와, 다른 쪽 꼬리에서 그 단측 확률보다 크지 않으면서 가능한 한 가까운 달성 가능한 확률을 더한 것을 사용합니다. 이 P-값은 관측된 $Q$의 값 $q_0$에 대해 $P(Q \le q_0)$로 표현될 수 있습니다.

각 접근법은 장단점이 있습니다(주석 3.10). 이산성(discreteness)과 잠재적인 비대칭성(skewness) 때문에 다른 결과들을 제공할 수 있습니다. $H_0$로부터의 거리 측도(예: $X^2$)에 따라 표의 순서를 매기는 접근법은 $I \times J$ 표로 자연스럽게 확장됩니다. 그 더 일반적인 경우에 대한 정확 검정은 16.5.2절로 미루겠습니다.

실제 분석에서는 단측 검정보다 양측 검정이 더 흔합니다. 부분적으로 이는 연구자들이 효과에 대한 예측된 방향을 지지하는 증거를 제시하는 데 있어 편향되었다는 비난을 피하기 위함입니다. 효과가 특정 방향을 가질 것이라고 진정으로 믿을 때 크기 0.05의 검정을 수행하려면, 비판을 막기 위해 0.025 수준에서 단측 검정을 수행할 수 있습니다. 예를 들어, 1998년 문서 *임상시험을 위한 생물통계학적 원칙*에서, 국제조화회의(ICH E9)는 다음과 같이 명시했습니다: "양측 검정에서 사용되는 전통적인 1종 오류의 절반 수준으로 단측 검정에 대한 1종 오류를 설정하는 접근법이 규제 환경에서는 더 선호된다. 이는 일반적으로 두 치료법 간의 차이의 가능한 크기를 추정하는 데 적절한 양측 신뢰구간과의 일관성을 증진시킨다."

### **3.5.4 조건부 우도에 기반한 신뢰구간 (Confidence Intervals Based on Conditional Likelihood)**

소표본 방법은 추정에도 적용됩니다. 7.3절에서 논의된 한 접근법은 조건부 우도 함수를 사용하여, 방해 모수(nuisance parameters)를 그들의 충분통계량(sufficient statistics)에 대해 조건화함으로써 제거합니다. 이는 대푯본 신뢰구간에서도 유용합니다. 사실, 3.2.5절과 3.2.6절에서 고정된 열 주변 총합과 행 주변 총합을 갖는 결합 분포를 활용한 오즈비에 대한 구간들은 실제로는 **조건부 스코어 및 프로파일 우도 신뢰구간**입니다.

소표본 구간 추정은 이산성으로 인해 그리고 전체 모수 공간에 걸쳐 성능을 평가하는 데서 발생하는 다른 복잡한 문제들을 수반합니다. 우리는 이 방법들에 대한 논의를 16.6.4절과 16.6.8절로 미루겠습니다.

### **3.5.5 이산성과 보수성 문제 (Discreteness and Conservatism Issues)**

초기하분포 (3.17)는 작은 표본에 대해 매우 이산적인데, 이는 $n_{11}$과 그에 따른 P-값이 상대적으로 적은 수의 값만 가질 수 있기 때문입니다. 0.05와 같은 고정된 유의수준(크기)을 달성하는 것은 보통 불가능합니다.

예를 들어, 차 감별 실험에서 $n_{11}$은 오직 4, 3, 2, 1, 0 값만 가질 수 있습니다. 단측 P-값은 0.014, 0.243, 0.757, 0.986, 1.0으로 제한됩니다. 만약 우리가 P-값 $\le 0.05$일 때 $H_0$를 기각한다면, 1종 오류의 확률은 0.05가 아닙니다. 오직 0.014의 P-값만이 0.05를 초과하지 않습니다; 따라서, $H_0$가 참일 때, 그것을 잘못 기각할 확률은 0.05가 아니라 0.014입니다. 이런 의미에서, 가설 검정에 대한 전통적인 접근법은 **보수적(conservative)**입니다: 실제 1종 오류의 확률은 명목 수준에 의해 위쪽으로 경계가 정해집니다.

기각역(critical region)의 경계에서 데이터와 무관한 무작위화(randomization)를 통해 어떤 고정된 유의수준이든 달성하는 것이 가능합니다. 차 감별 실험에 대해, 우리가 $n_{11}=4$일 때 $H_0$를 기각하고, $n_{11}=3$일 때 확률 0.157로 $H_0$를 기각하며, 그 외에는 기각하지 않는다고 가정합시다; 즉, $n_{11}=3$일 때, 우리는 [0, 1]에서 균등 난수 U를 생성하고 U < 0.157이면 $H_0$를 기각합니다. $n_{11}$의 귀무 초기하분포에 대해 기댓값을 취하면, 유의수준은 다음과 같습니다.

$$ P(\text{reject } H_0) = E[P(\text{reject } H_0|n_{11})] $$

$$ = 1.0(0.014) + 0.157(0.229) + 0.0 \times P(n_{11} \le 2) = 0.05. $$

이 무작위화 확장을 통해, Tocher(1950)는 피셔의 검정이 선택된 크기(여기서는 0.05)에 대해 균일 최강력 불편 검정(UMPU)임을 보였습니다.

실제 분석에서, 데이터와 아무 관련이 없는 무작위화는 받아들여지지 않으며, 이 가설에 대한 합리적인 검정들은 편향됩니다(연습문제 3.43). 우리는 단순히 P-값을 보고하는 것을 추천합니다. 보수성을 줄이기 위해, **중간 P-값(mid P-value)**을 보고하십시오(1.4.4절). 이 검정은 더 이상 실제 P(1종 오류)가 명목 값보다 크지 않다고 보장하지는 않지만, 실제 분석에서 그것이 훨씬 더 커지는 경우는 드뭅니다. 차 감별 데이터에 대한 단측 검정에 대해,

$$ \text{mid P-값} = (\frac{1}{2})P(n_{11}=3) + P(n_{11}>3) = 0.5(0.229) + 0.014 = 0.129. $$

$X^2$과 같은 기준을 사용하는 양측 검정에 대해서는, 주어진 주변 총합을 갖는 표들에 대해, 관측된 $X^2$ 값의 확률의 절반을 더 큰 값들에 대한 확률에 더할 것입니다.

---

### **핵심 내용 해설**

이 세 섹션은 피셔의 정확 검정을 사용할 때 발생하는 몇 가지 미묘하지만 중요한 이론적, 실용적 문제들을 다룹니다.

#### **3.5.3: "양측(Two-Sided)"의 여러 의미**

*   **문제**: 단측 검정("A가 B보다 크다")은 명확하지만, 양측 검정("A와 B는 다르다")은 무엇을 의미하는가?
*   **어려움**: 초기하분포는 비대칭일 수 있으므로, 한쪽 꼬리의 "극단성"을 다른 쪽 꼬리의 "극단성"과 어떻게 대응시킬지가 명확하지 않습니다.
*   **다양한 접근법**:
    1.  **확률 기준 (가장 흔함)**: 관측된 표보다 **나올 확률이 같거나 더 낮은** 모든 표들의 확률을 더한다. 직관적이지만 계산이 복잡할 수 있다.
    2.  **거리 기준**: $X^2$과 같은 거리 측도를 계산하고, 관측된 $X^2$ 값보다 크거나 같은 모든 표들의 확률을 더한다. 다른 분할표로 확장이 용이하다.
    3.  **단순 2배**: 작은 쪽 단측 P-값을 그냥 2배 한다. 간단하지만 결과가 1을 넘을 수 있어 이론적 결함이 있다.
*   **결론**: 어떤 방법을 쓰느냐에 따라 P-값이 달라질 수 있습니다. 대부분의 소프트웨어는 1번 또는 2번 방법을 사용합니다.

#### **3.5.4: 신뢰구간으로의 확장**

*   **핵심**: 피셔의 정확 검정은 $H_0: \theta=1$ (독립성)에 대한 검정입니다. 그렇다면 **오즈비($\theta$)의 정확한 신뢰구간**은 어떻게 구할까요?
*   **원리**: 검정의 역산 원리를 다시 사용합니다.
    *   $H_0: \theta = \theta_0$ (예: $H_0: \theta=2$) 라는 가설을 검정합니다.
    *   이 가설에 대한 P-값을 계산합니다. (이때는 초기하분포가 아닌, $\theta_0$에 의존하는 **비중심 초기하분포(noncentral hypergeometric distribution)**를 사용해야 해서 매우 복잡합니다.)
    *   이 P-값이 0.05보다 큰 모든 $\theta_0$ 값들을 모으면, 그것이 바로 95% 정확 신뢰구간이 됩니다.
*   **저자의 요점**: 3.2.5절과 3.2.6절에서 소개된, 주변 총합을 고정하여 구한 스코어/프로파일 우도 신뢰구간이 사실상 이 복잡한 조건부 신뢰구간을 구하는 것과 같은 원리라는 것입니다.

#### **3.5.5: 피할 수 없는 보수성 문제**

*   **이산성(Discreteness)의 저주**: 정확 검정에서 P-값은 띄엄띄엄 나타납니다 (예: 0.014, 0.243, 0.757, ...).
*   **보수성(Conservatism)**: 우리가 유의수준을 $\alpha=0.05$로 정하고 "P-값 $\le 0.05$"일 때 기각하기로 규칙을 정하면, 실제 기각이 일어나는 P-값은 0.014밖에 없습니다. 따라서 실제 1종 오류 확률은 우리가 설정한 0.05보다 훨씬 작은 0.014가 됩니다. 이것이 "보수적"이라는 의미입니다. 즉, 귀무가설을 너무 기각하지 않으려는 경향이 생깁니다.
*   **이론적 해결책 (무작위화)**: 경계선에 있는 결과(예: $n_{11}=3$)에 대해 동전을 던져서(무작위화) 기각 여부를 결정하면 정확히 유의수준 0.05를 맞출 수 있습니다. 이는 이론적으로는 UMPU라는 최상의 검정을 만들지만, **실제 분석에서는 데이터와 무관한 동전 던지기로 결론을 내리는 것이 터무니없으므로 절대 사용되지 않습니다.**
*   **실용적 해결책 (중간 P-값)**: 보수성을 완화하는 합리적인 타협안입니다.
    *   **계산**: (관측된 결과가 나올 확률의 절반) + (더 극단적인 결과가 나올 확률)
    *   **차 감별사 예제**: $\frac{1}{2}P(n_{11}=3) + P(n_{11}=4) = \frac{1}{2}(0.229) + 0.014 = 0.129$
    *   **장점**: 일반 P-값(0.243)보다는 작아져 보수성이 완화됩니다. 연속 분포의 P-값과 유사한 통계적 성질을 가집니다.
    *   **단점**: 더 이상 실제 1종 오류율이 명목 수준($\alpha$)보다 낮다고 100% 보장하지는 못합니다 (하지만 대개 크게 벗어나지 않습니다).

**종합 결론**: 소표본 분석에서는 '정확성'을 얻는 대신 '이산성'과 그로 인한 '보수성'이라는 문제를 마주하게 됩니다. 실제 분석에서는 단순히 P-값을 보고하거나, 보수성을 완화하기 위해 **중간 P-값(mid P-value)**을 함께 보고하는 것이 좋은 절충안이 될 수 있습니다.
