### **3.1.5 델타 방법을 이용한 표준오차 유도 (Deriving Standard Errors with the Delta Method)**

**[원문 번역]**

표준오차를 유도하는 간단하고 유용한 방법이 존재합니다. 모수 $\theta$에 대해 점근적으로 정규분포를 따르는 통계량 $T_n$을 생각해 봅시다. 아래 첨자 $n$은 표본 크기에 대한 의존성을 표현합니다. 어떤 추정량이 $T_n$의 함수 $g(T_n)$이라고 가정합시다. 그러면, 완만한 조건 하에서, $g(T_n)$ 자체도 대푯본 정규분포를 가집니다. 그 표준오차는 $t=\theta$에서의 $g(t)$의 변화율(rate of change)에 따라 달라집니다.

구체적으로, 큰 $n$에 대해, $T_n$이 모수 $\theta$를 중심으로 표준오차 $\sigma/\sqrt{n}$을 갖는 정규분포를 따른다고 가정합시다. 즉, $n \to \infty$ 일 때, $\sqrt{n}(T_n - \theta)$의 누적분포함수(cdf)는 평균이 0이고 분산이 $\sigma^2$인 정규 확률변수의 cdf로 수렴합니다. 이러한 극한 거동은 **분포 수렴(convergence in distribution)**의 한 예이며, 다음과 같이 표기합니다.

$$ \sqrt{n}(T_n - \theta) \xrightarrow{d} N(0, \sigma^2) $$

함수 $g$가 $\theta$에서 적어도 두 번 미분 가능하다고 합시다. $t=\theta$ 근방에서 $g(t)$에 대한 테일러 급수 전개(Taylor series expansion)로부터,

$$ \sqrt{n}[g(T_n) - g(\theta)] \approx \sqrt{n}(T_n - \theta)g'(\theta) $$

가 큰 $n$에 대해 성립합니다. 여기서 $g'(\theta) = dg/dt$를 $t=\theta$에서 계산한 값입니다. 만약 확률변수 $Y \sim N(0, \sigma^2)$ 이라면, $cY \sim N(0, c^2\sigma^2)$ 임을 상기합시다. 따라서,

$$ \sqrt{n}[g(T_n) - g(\theta)] \xrightarrow{d} N(0, [g'(\theta)]^2\sigma^2) \quad (3.6) $$

다른 말로, $g(T_n)$은 $g(\theta)$를 중심으로 분산이 $[g'(\theta)]^2\sigma^2/n$인 정규분포를 근사적으로 따릅니다. 16.1.2절에서 자세한 내용을 제공합니다.

그림 3.1은 이 결과를 묘사합니다. $\theta$ 근방에서 국소적으로, $g(t)$는 기울기 $g'(\theta)$를 갖는 거의 선형(linear)입니다. 정규 확률변수의 선형 변환은 그 자체로 정규분포이므로, $g(T_n)$도 근사적으로 정규분포를 따릅니다. $g(\theta)$를 중심으로 한 $g(T_n)$ 값들의 분산 정도는 $\theta$를 중심으로 한 $T_n$ 값들의 분산 정도에 $|g'(\theta)|$를 곱한 것과 거의 같습니다. 예를 들어, $\theta$에서 $g$의 기울기가 1/2이라면, $g$는 $T_n$ 값들의 영역을 폭이 절반 정도밖에 안 되는 $g(T_n)$ 값들의 영역으로 매핑(mapping)합니다.

결과 (3.6)은 **델타 방법(delta method)**이라고 불립니다. $g'(\theta)$와 $\sigma^2 = \sigma^2(\theta)$는 보통 미지의 모수 $\theta$에 의존하기 때문에, 점근적 분산은 알려져 있지 않습니다. 왈드 신뢰구간은 $\theta$ 대신 $T_n$을 대입하고, $\sqrt{n}[g(T_n) - g(\theta)] / [|g'(T_n)|\hat{\sigma}(T_n)]$가 점근적으로 표준정규분포를 따른다는 결과를 사용합니다. 따라서,

$$ g(T_n) \pm 1.96 |g'(T_n)|\hat{\sigma}(T_n)/\sqrt{n} $$

은 $g(\theta)$에 대한 대푯본 95% 왈드 신뢰구간입니다.

---

### **핵심 내용 해설: 복잡한 함수의 불확실성을 근사하는 마법**

델타 방법은 통계학에서 매우 강력하고 널리 사용되는 도구입니다. 그 본질은 다음과 같은 질문에 답하는 것입니다.

> **"우리가 어떤 통계량($T_n$)의 분산(불확실성)을 알고 있을 때, 그 통계량을 변환한 새로운 함수($g(T_n)$)의 분산은 어떻게 될까?"**

예를 들어, 우리는 표본 비율($\hat{\pi}$)의 분산이 $\pi(1-\pi)/n$임을 알고 있습니다. 그렇다면 **로그 오즈($\log[\hat{\pi}/(1-\hat{\pi})]$)**의 분산은 어떻게 될까요? 델타 방법은 이 질문에 대한 근사적인 답을 제공합니다.

#### **델타 방법의 핵심 원리: "선형 근사"**

델타 방법의 아이디어는 미적분학의 **테일러 급수(Taylor series)**, 특히 1차 근사(선형 근사)에 기반합니다.

1.  **함수 확대하기**: 어떤 매끄러운 함수 $g(t)$가 있을 때, 특정 지점 $t=\theta$ 주변을 아주 크게 확대해서 보면, 그 함수는 거의 **직선처럼 보입니다.**
2.  **직선의 방정식**: 이 직선의 방정식은 $y \approx g(\theta) + g'(\theta)(t - \theta)$ 입니다. 여기서 $g'(\theta)$는 점 $\theta$에서의 **접선의 기울기**입니다.
3.  **통계량에 적용**: 이제 변수 $t$ 자리에 우리의 통계량 $T_n$을 대입합니다. $T_n$은 $\theta$ 주변의 값을 가지므로 이 근사는 잘 작동합니다.
    $$ g(T_n) \approx g(\theta) + g'(\theta)(T_n - \theta) $$
    이항하면,
    $$ g(T_n) - g(\theta) \approx g'(\theta)(T_n - \theta) $$

#### **분산으로의 확장**

분산의 기본 성질 중 하나는 $\text{Var}(aX+b) = a^2 \text{Var}(X)$ 입니다. 위의 선형 근사식에 이 성질을 적용해 봅시다.

$$ \text{Var}[g(T_n)] \approx \text{Var}[g(\theta) + g'(\theta)(T_n - \theta)] $$

$g(\theta)$와 $g'(\theta)\theta$는 상수이므로 분산에 영향을 주지 않습니다.

$$ \approx \text{Var}[g'(\theta)T_n] = [g'(\theta)]^2 \text{Var}(T_n) $$

이것이 바로 델타 방법의 **핵심 공식**입니다.

$$ \text{Var}[g(T_n)] \approx [\text{미분값의 제곱}] \times \text{Var}(T_n) $$

*   **의미**: 새로운 함수의 분산은, **원래 분산**에 함수를 미분하여 얻은 **기울기의 제곱**을 곱한 것과 거의 같습니다.
*   **직관적 해석 (그림 3.1)**:
    *   만약 기울기 $g'(\theta)$의 절댓값이 1보다 크면 (예: 2), 함수는 $T_n$의 작은 변화를 $g(T_n)$의 큰 변화로 증폭시킵니다. 따라서 분산도 커집니다.
    *   만약 기울기 $g'(\theta)$의 절댓값이 1보다 작으면 (예: 0.5), 함수는 $T_n$의 변화를 $g(T_n)$의 작은 변화로 축소시킵니다. 따라서 분산도 작아집니다. (본문에서 "폭이 절반"이 된다고 설명한 부분)

#### **실제 적용**

실제로는 모수 $\theta$와 그 함수 $g'(\theta)$, 그리고 $\text{Var}(T_n)$에 포함된 $\theta$를 알지 못합니다. 따라서 우리는 이 값들을 데이터로부터 얻은 추정치로 대체합니다.

1.  $\theta$ 대신 통계량 $T_n$을 대입합니다.
2.  기울기 $g'(\theta)$ 대신 $g'(T_n)$을 사용합니다.
3.  $\text{Var}(T_n)$ 대신 그것의 추정치 $\widehat{\text{Var}}(T_n)$을 사용합니다.

최종적으로, $g(T_n)$의 **추정된 분산**은 다음과 같습니다.

$$ \widehat{\text{Var}}[g(T_n)] \approx [g'(T_n)]^2 \widehat{\text{Var}}(T_n) $$

여기에 제곱근을 취하면 $g(T_n)$의 **표준오차(SE)**를 얻을 수 있습니다.

**요약**: 델타 방법은 "미분을 통한 선형 근사"라는 수학적 도구를 이용하여, 복잡한 함수의 분산을 간단하게 근사하는 매우 실용적인 기법입니다. 통계학에서 오즈비, 상대위험도, 상관계수 등 다양한 척도의 표준오차를 유도하는 데 필수적으로 사용됩니다.
