### **정리 5.2.1.**

$X_n$은 전이 확률(transition probability) $p$를 갖는 마르코프 연쇄이다 (단, $\mathcal{F}_n = \sigma(X_0, X_1, \dots, X_n)$에 관하여). 즉,

$$ P_\mu(X_{n+1} \in B | \mathcal{F}_n) = p(X_n, B) $$


**증명.**
이를 증명하기 위해, $A = \{X_0 \in B_0, X_1 \in B_1, \dots, X_n \in B_n\}$이라 하고, $B_{n+1} = B$라고 하자. 그리고 적분의 정의, $A$의 정의, 그리고 $P_\mu$의 정의를 사용하여 다음을 관찰하자.

$$ \begin{aligned} \int_A 1_{\{X_{n+1} \in B\}} dP_\mu &= P_\mu(A, X_{n+1} \in B) \\ &= P_\mu(X_0 \in B_0, X_1 \in B_1, \dots, X_n \in B_n, X_{n+1} \in B) \\ &= \int_{B_0} \mu(dx_0) \int_{B_1} p(x_0, dx_1) \cdots \int_{B_n} p(x_{n-1}, dx_n) p(x_n, B_{n+1}) \end{aligned} $$

우리는 마지막 표현식이 다음과 같다고 주장하고 싶다.

$$ = \int_A p(X_n, B) dP_\mu $$

이를 위해, 임의의 $C \in \mathcal{S}$에 대해 다음을 주목하는 것으로 시작한다.

$$ \int_{B_0} \mu(dx_0) \int_{B_1} p(x_0, dx_1) \cdots \int_{B_n} p(x_{n-1}, dx_n) 1_C(x_n) = \int_A 1_C(X_n) dP_\mu $$

선형성은 단순 함수(simple functions)에 대해 다음을 암시한다.

$$ \int_{B_0} \mu(dx_0) \int_{B_1} p(x_0, dx_1) \cdots \int_{B_n} p(x_{n-1}, dx_n) f(x_n) = \int_A f(X_n) dP_\mu $$

그리고 유계 수렴 정리(bounded convergence theorem)는 이것이 유계 가측 함수 $f$, 예를 들어 $f(x) = p(x, B_{n+1})$에 대해 유효함을 암시한다.

다음 등식이 성립하는 집합들의 모임은,

$$ \int_A 1_{\{X_{n+1} \in B\}} dP_\mu = \int_A p(X_n, B) dP_\mu $$

$\lambda$-시스템이며, 이것이 성립한다고 증명된 집합들의 모임은 $\pi$-시스템이므로, $\pi-\lambda$ 정리, 즉 정리 2.1.6으로부터 이 등식이 모든 $A \in \mathcal{F}_n$에 대해 참이라는 것이 따라나온다. 이것은 다음을 보여준다.

$$ P(X_{n+1} \in B | \mathcal{F}_n) = p(X_n, B) $$

그리고 증명을 마친다. ◻

**[해설 및 추가 설명]**

#### **1. 정리 5.2.1의 의미: 마르코프 성질의 공식화**

이 정리는 우리가 직관적으로 이해하고 있던 마르코프 성질, 즉 "미래는 현재를 통해서만 과거와 관련된다"는 것을 조건부 기댓값이라는 엄밀한 수학적 언어로 공식화하는 과정입니다.

*   **$P_\mu(X_{n+1} \in B | \mathcal{F}_n)$**: 좌변의 의미는 시간 $n$까지의 모든 정보(즉, $X_0, X_1, \dots, X_n$의 전체 경로)가 주어졌을 때, 다음 상태 $X_{n+1}$이 집합 $B$에 속할 조건부 확률을 의미합니다.
*   **$p(X_n, B)$**: 우변은 단지 현재 상태 $X_n$에서 다음 상태가 집합 $B$로 전이할 확률을 의미합니다. 과거의 정보 $X_0, \dots, X_{n-1}$은 전혀 사용되지 않습니다.

따라서 이 등식은 **"시간 $n$까지의 모든 과거 경로($\mathcal{F}_n$)를 아는 것은, 단순히 현재 상태($X_n$)만 아는 것과 미래($X_{n+1}$)를 예측하는 데 있어 아무런 차이가 없다"**는 마르코프 성질을 정확하게 표현합니다. 이는 우리가 이전에 "간단한" 정의 $P(X_{n+1}=j | X_n=i, X_{n-1}=i_{n-1}, \dots) = P(X_{n+1}=j | X_n=i)$로 알고 있던 것의 일반화된 측도론적 표현입니다.

#### **2. 증명의 핵심 전략: 몬테카를로, 아니 $\pi-\lambda$ 정리**

증명은 매우 기술적으로 보이지만, 그 구조는 측도론에서 매우 흔하게 사용되는 강력한 패턴을 따릅니다.

1.  **가장 간단한 경우에서 시작**: 증명은 가장 다루기 쉬운 형태의 사건 $A$에서 시작합니다. 여기서 $A$는 $X_0$부터 $X_n$까지의 경로가 특정 "직사각형" $B_0 \times \dots \times B_n$에 속하는 사건입니다. 이러한 형태의 집합들은 $\mathcal{F}_n$의 기본 구성 요소입니다.
2.  **직접 계산**: 이 간단한 사건 $A$에 대해서는, 우리가 콜모고로프 확장 정리를 통해 마르코프 연쇄의 확률 측도 $P_\mu$를 구성한 방식(5.2.1 식)을 사용하여 적분을 직접 계산할 수 있습니다. 계산 결과, 원하는 등식이 이 특별한 형태의 $A$에 대해서는 성립함을 보입니다.
3.  **일반화 단계 (함수 클래스 확장)**:
    *   먼저 $1_C(X_n)$ 형태의 함수에 대해 등식이 성립함을 보입니다.
    *   선형성을 이용하여, 이 등식이 유한 개의 값을 갖는 **단순 함수** $f(X_n)$에 대해서도 성립함을 보입니다.
    *   **단조 클래스 정리(Monotone Class Theorem)** (또는 여기서는 유계 수렴 정리)를 이용하여, 이 등식이 모든 **유계 가측 함수** $f(X_n)$에 대해서도 성립함을 보입니다.
    *   우리가 보이고 싶은 $p(X_n, B)$는 $X_n$의 유계 가측 함수이므로($p(x,B)$가 $x$에 대해 가측 함수라는 전이 확률의 조건 때문에), 이 단계가 완료됩니다.
4.  **최종 확장 ($\pi-\lambda$ 정리)**:
    *   우리가 증명한 것은 "직사각형" 형태의 집합들 위에서 등식이 성립한다는 것입니다. 이러한 직사각형들의 모임은 교집합에 대해 닫혀 있으므로 **$\pi$-시스템**을 형성합니다.
    *   한편, 등식이 성립하는 모든 사건 $A \in \mathcal{F}_n$들의 모임 $\mathcal{L}$은 **$\lambda$-시스템**의 세 가지 조건을 만족함을 보일 수 있습니다 (증명에서는 이 부분을 간략히 언급합니다).
    *   **$\pi-\lambda$ 정리**에 따르면, $\pi$-시스템을 포함하는 $\lambda$-시스템은 그 $\pi$-시스템이 생성하는 전체 $\sigma$-필드를 포함해야 합니다.
    *   따라서, $\mathcal{L}$은 직사각형들이 생성하는 $\sigma$-필드, 즉 $\mathcal{F}_n$ 전체를 포함하게 됩니다.
    *   결론적으로, 등식은 모든 $A \in \mathcal{F}_n$에 대해 성립하며, 이는 조건부 기댓값의 정의와 정확히 일치합니다.

이 증명은 우리가 처음에 확률 측도 $P_\mu$를 어떻게 구성했는지(즉, 전이 확률의 연쇄 곱)가 자연스럽게 마르코프 성질을 보장한다는 것을 보여주는 과정입니다. 즉, "그렇게 만들었으니, 그렇게 동작한다"는 것을 엄밀하게 확인하는 절차입니다.
