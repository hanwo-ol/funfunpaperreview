### **마팅게일 정의 복습**

수열 $X _n$이 여과(filtration) $\mathcal{F} _n$에 대한 마팅게일이라는 것은 다음 세 가지를 만족하는 것입니다.
1.  **적분 가능성**: 모든 $n$에 대해 $E|X _n| < \infty$.
2.  **적응성(Adaptedness)**: 모든 $n$에 대해 $X _n$은 $\mathcal{F} _n$-가측이다. ($X _n$의 값은 시간 $n$까지의 정보로 알 수 있다.)
3.  **마팅게일 속성**: 모든 $n$에 대해 $E(X _{n+1} | \mathcal{F} _n) = X _n$. (시간 $n$까지의 정보를 알고 있을 때, 다음 시점의 값에 대한 최선의 예측은 현재 값이다.)

---

### **1. 예제 4.2.1: 확률 보행 (Random Walk)**

*   **설정**: $S _n = \xi _1 + \dots + \xi _n$ 이고, $\xi _i$는 i.i.d.(독립적이고 동일한 분포)이며 평균 $E\xi _i = \mu = 0$입니다. $\mathcal{F} _n = \sigma(\xi _1, \dots, \xi _n)$는 시간 $n$까지의 모든 이동 단계를 아는 정보입니다.
*   **$X _n = S _n$ 으로 둡니다.**

이것이 어떻게 $E(X _{n+1} | \mathcal{F} _n) = X _n$ 을 만족하는지 보겠습니다.

$$ E(S _{n+1} | \mathcal{F} _n) = E(S _n + \xi _{n+1} | \mathcal{F} _n) $$

이제 조건부 기댓값의 **선형성**(정리 4.1.9(a))을 사용합니다.

$$ = E(S _n | \mathcal{F} _n) + E(\xi _{n+1} | \mathcal{F} _n) $$

1.  **$E(S _n | \mathcal{F} _n)$**: $S _n$은 시간 $n$까지의 합이므로, $\mathcal{F} _n$이 주어졌을 때 그 값은 이미 알려진 상수와 같습니다. 따라서 $E(S _n | \mathcal{F} _n) = S _n$ 입니다 (예제 4.1.3).
2.  **$E(\xi _{n+1} | \mathcal{F} _n)$**: $\xi _{n+1}$은 $\xi _1, \dots, \xi _n$과 독립입니다. 따라서 $\xi _{n+1}$은 정보 $\mathcal{F} _n$과 독립입니다. 정보가 없을 때의 최선의 추정은 평균이므로, $E(\xi _{n+1} | \mathcal{F} _n) = E(\xi _{n+1}) = \mu = 0$ 입니다 (예제 4.1.4).

이 두 가지를 결합하면,

$$ E(S _{n+1} | \mathcal{F} _n) = S _n + 0 = S _n $$

따라서 평균이 0인 확률 보행 $S _n$은 마팅게일 정의를 완벽하게 만족합니다.

*   **직관적 의미**: "공정한 게임"의 전형입니다. 현재 위치가 $S _n$일 때, 다음 단계의 기대 이동 거리가 0이므로, 다음 위치의 기대값은 현재 위치와 같습니다.

---

### **2. 예제 4.3.2: 폴리아의 항아리 (Polya's Urn)**

*   **설정**: 항아리에 $g$개의 녹색 공과 $r$개의 붉은 공이 있습니다. 공을 하나 뽑고, 색을 확인한 뒤, 다시 넣고 **그와 같은 색의 공 $c$개를 추가**합니다.
*   **$X _n$을 $n$번째 시행 후 항아리에 있는 녹색 공의 비율**로 둡니다.
*   $\mathcal{F} _n$은 첫 $n$번의 뽑기 결과를 아는 정보입니다.

이것이 어떻게 $E(X _{n+1} | \mathcal{F} _n) = X _n$ 을 만족하는지 보겠습니다.

시간 $n$에 항아리에 $j$개의 녹색 공과 $i$개의 붉은 공이 있다고 가정합시다. 이 정보는 $\mathcal{F} _n$에 포함되어 있습니다. 그러면 현재 녹색 공의 비율은 $X _n = \frac{j}{i+j}$ 입니다.

다음 $(n+1)$번째 시행에서 일어날 수 있는 일은 두 가지입니다.
1.  **녹색 공을 뽑을 경우**: 이 사건의 확률은 $\frac{j}{i+j}$ 입니다. 이 경우, 항아리는 $j+c$개의 녹색 공과 $i$개의 붉은 공을 갖게 됩니다. 따라서 다음 상태의 녹색 공 비율은 $X _{n+1} = \frac{j+c}{i+j+c}$가 됩니다.
2.  **붉은 공을 뽑을 경우**: 이 사건의 확률은 $\frac{i}{i+j}$ 입니다. 이 경우, 항아리는 $j$개의 녹색 공과 $i+c$개의 붉은 공을 갖게 됩니다. 따라서 다음 상태의 녹색 공 비율은 $X _{n+1} = \frac{j}{i+j+c}$가 됩니다.

이제 $\mathcal{F} _n$이 주어졌을 때 $X _{n+1}$의 조건부 기댓값을 계산해 봅시다. 이는 단순히 가능한 다음 상태의 값들에 각각의 확률을 곱하여 더하는 것입니다.

$$ \begin{aligned} E(X _{n+1} | \mathcal{F} _n) &= \left( \frac{j+c}{i+j+c} \right) \cdot P(\text{녹색 뽑음} | \mathcal{F} _n) + \left( \frac{j}{i+j+c} \right) \cdot P(\text{붉은색 뽑음} | \mathcal{F} _n) \\ 
&= \left( \frac{j+c}{i+j+c} \right) \cdot \left( \frac{j}{i+j} \right) + \left( \frac{j}{i+j+c} \right) \cdot \left( \frac{i}{i+j} \right) \\ 
&= \frac{(j+c)j + ji}{(i+j+c)(i+j)} \\ 
&= \frac{j^2 + cj + ji}{(i+j+c)(i+j)} \\ 
&= \frac{j(j+c+i)}{(i+j+c)(i+j)} \\ 
&= \frac{j}{i+j} \end{aligned} $$

그런데 $\frac{j}{i+j}$는 바로 현재 상태 $X _n$입니다! 따라서,

$$ E(X _{n+1} | \mathcal{F} _n) = X _n $$

*   **직관적 의미**: 놀랍게도, 이 과정은 "자기 강화(self-reinforcing)" 매커니즘을 가지고 있음에도 불구하고 (녹색 공을 뽑으면 다음에도 녹색 공을 뽑을 확률이 높아짐), 녹색 공의 '비율'에 대한 우리의 기대는 변하지 않습니다. 현재 녹색 공의 비율이 60%라면, 다음 시행 후에 녹색 공의 비율이 얼마가 될지에 대한 최선의 예측은 여전히 60%라는 것입니다.

---

### **3. 예제 4.3.3: 라돈-니코딤 도함수 (Radon-Nikodym Derivatives)**

*   **설정**: 두 개의 측도 $\mu, \nu$가 있고, $\mathcal{F} _n$은 점점 커지는 $\sigma$-필드열($\mathcal{F} _n \uparrow \mathcal{F}$)입니다. $\mu _n, \nu _n$은 각 측도를 $\mathcal{F} _n$에 제한한 것입니다. $\mu _n \ll \nu _n$ (절대적으로 연속)이라고 가정합니다.
*   **$X _n = d\mu _n / d\nu _n$** (라돈-니코딤 도함수)로 둡니다.

이것이 어떻게 $E _\nu(X _{n+1} | \mathcal{F} _n) = X _n$ 을 만족하는지 보겠습니다. (주의: 여기서 기댓값은 측도 $\nu$에 대해 취해집니다.)

마팅게일 속성을 확인하려면, 정의에 따라 모든 $A \in \mathcal{F} _n$에 대해 다음을 보여야 합니다.

$$ \int _A X _{n+1} d\nu = \int _A X _n d\nu $$

1.  **우변 계산**: $X _n = d\mu _n/d\nu _n$의 정의에 의해, $\int _A X _n d\nu _n = \mu _n(A)$ 입니다. $A \in \mathcal{F} _n$이고 $\nu _n$은 $\nu$를 $\mathcal{F} _n$에 제한한 것이므로,

$$ \int _A X _n d\nu = \int _A X _n d\nu _n = \mu _n(A) $$

2.  **좌변 계산**: $X _{n+1} = d\mu _{n+1}/d\nu _{n+1}$ 입니다. $A \in \mathcal{F} _n$이고 $\mathcal{F} _n \subset \mathcal{F} _{n+1}$ 이므로,

$$ \int _A X _{n+1} d\nu = \int _A X _{n+1} d\nu _{n+1} = \mu _{n+1}(A) $$

3.  **두 측도의 제한**: $\mu _n$과 $\mu _{n+1}$은 모두 원래 측도 $\mu$를 각각 $\mathcal{F} _n$과 $\mathcal{F} _{n+1}$에 제한한 것입니다. $A \in \mathcal{F} _n$이므로, $A$에 대한 두 측도의 값은 같습니다: $\mu _n(A) = \mu(A)$ 이고 $\mu _{n+1}(A) = \mu(A)$. 따라서 $\mu _n(A) = \mu _{n+1}(A)$ 입니다.

이 세 단계를 결합하면, 모든 $A \in \mathcal{F} _n$에 대해,

$$ \int _A X _{n+1} d\nu = \mu _{n+1}(A) = \mu _n(A) = \int _A X _n d\nu $$

이것이 바로 $E _\nu(X _{n+1} | \mathcal{F} _n) = X _n$의 정의입니다.

*   **직관적 의미**: $X _n$은 정보 $\mathcal{F} _n$을 바탕으로 한 두 측도 $\mu$와 $\nu$의 상대적인 밀도(비율)에 대한 "최선의 추정치"입니다. 정보가 더 많아져도($\mathcal{F} _{n+1}$), 이 상대적 밀도에 대한 우리의 기대는 변하지 않는다는 것을 의미합니다. 이는 통계적 추론에서 베이즈 정리와 가능도 비(likelihood ratio)의 점근적 행동을 이해하는 데 매우 중요한 역할을 합니다.

### **결론**

질문하신 대로, 전혀 다른 맥락에서 나타나는 이 세 가지 과정은 모두 **"미래에 대한 최선의 예측은 현재 상태"**라는 공통된 수학적 구조, 즉 **마팅게일 속성**을 공유하고 있습니다.

*   **확률 보행**: 공간에서의 위치가 마팅게일.
*   **폴리아의 항아리**: 특정 색 공의 비율이 마팅게일.
*   **라돈-니코딤 도함수**: 정보가 증가함에 따른 측도의 상대적 밀도가 마팅게일.

이 추상적인 공통 구조를 포착함으로써, 마팅게일 이론은 이 모든 다양한 과정들에 대해 일관되고 강력한 결과들(예: 수렴 정리, 멈춤 시간 정리)을 제공할 수 있습니다. 이것이 바로 현대 확률론에서 마팅게일이 중심적인 위치를 차지하는 이유입니다.
